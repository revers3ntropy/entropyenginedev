<!doctype html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,user-scalable=no,initial-scale=1,maximum-scale=1,minimum-scale=1"><title>Entropy Engine</title><script src="https://code.jquery.com/jquery-1.10.2.js"></script></head><body><div style="margin: 5px"><div id="top-bar"><div><a class="item" href="https://entropyengine.dev/"><img src="../../logo.png" alt="logo" style="height: 35px; width: 35px"></a></div><div><a class="item" href="https://entropyengine.dev/accounts/my-projects">My Projects </a><a class="item" href="https://entropyengine.dev/accounts">My Account </a><a class="item" href="https://entropyengine.dev/docs">Docs</a></div><div>ping: <span id="ping"></span>ms</div></div></div><main><section id="game-container"><div id="game"><canvas id="myCanvas"></canvas></div></section><section id="info-container"><div id="info"><div>By <span id="project-owner" style="margin-right: 10px"></span> <a href="../contributors/?p=" id="contributors-link">See all contributors</a></div><div id="views"></div></div></section><section id="comments-container"><div style="margin: 10px 0 50px 100px; font-size: 20px"><span id="num-comments"></span> Comments</div><div id="add-comment-container"><label><input id="add-comment" placeholder="Add a public comment..." maxlength="500"></label></div><div id="comments"></div><footer style="height: 100px"></footer></section></main><style>html {
  height: calc(100% - 31px);
}
body {
  height: 100%;
}
#game-container {
  display: flex;
  justify-content: center;
  align-items: center;
  height: 80%;
  margin-top: 25px;
}
#game {
  width: 80%;
  height: 100%;
  border: 1px solid vaR(--text-colour);
}
#info-container {
  display: flex;
  justify-content: center;
  align-items: center;
  margin: 0;
  height: 30px;
}
#info {
  border-radius: 1px 1px 10px 10px;
  height: 100%;
  display: flex;
  justify-content: space-evenly;
  align-items: center;
  padding: 0 4px;
  width: 80%;
}
#contributors-link {
  margin-left: 10px;
}
#comments-container {
  margin: 100px 20px 50px 20px;
}
#add-comment-container {
  text-align: center;
  margin: 0 0 20px 0;
}
#add-comment {
  border-bottom: 1px solid grey;
  margin: 20px;
  background-color: rgba(0, 0, 0, 0);
  width: 75%;
}</style><script>(()=>{"use strict";var n={257:(n,e,t)=>{t.d(e,{Z:()=>c});var r=t(81),o=t.n(r),a=t(645),i=t.n(a)()(o());i.push([n.id,"@font-face {\n  font-family: 'Nunito';\n  font-style: normal;\n  font-weight: 400;\n  src: url(https://fonts.gstatic.com/s/nunito/v22/XRXI3I6Li01BKofiOc5wtlZ2di8HDLshdTQ3ig.ttf) format('truetype');\n}\n:root {\n  --input-bg: #494949;\n  --input-hover-bg: #525252;\n  --input-opposite-bg: #5a5a5a;\n  --transparent: rgba(0, 0, 0, 0);\n  --bg: #363636;\n  --bg-dark: #1e1e1e;\n  --text-colour: #fafafa;\n  --text-hover-colour: #cbcbcb;\n  --warning: #ff6f6f;\n}\nbody {\n  color: vaR(--text-colour);\n  background-color: vaR(--bg);\n}\n/* width */\n::-webkit-scrollbar {\n  width: 8px;\n  height: 8px;\n}\n/* Track */\n::-webkit-scrollbar-track {\n  background: #1a1a1a;\n}\n/* Handle */\n::-webkit-scrollbar-thumb {\n  background: #888;\n  border-radius: 4px;\n}\n/* Handle on hover */\n::-webkit-scrollbar-thumb:hover {\n  background: #555;\n  border-radius: 2px;\n}\nhtml,\nbody {\n  font-family: 'Nunito', serif;\n  font-size: 13px;\n  height: 100%;\n  margin: 0;\n  border: none;\n  padding: 0;\n}\n.empty-button {\n  border: none;\n  border-radius: 0;\n  padding: 5px;\n  margin: 0;\n  width: 100%;\n  text-align: left;\n  outline: none;\n}\n.short-button {\n  border: none;\n  border-radius: 2px;\n  padding: 5px;\n  margin: 2px;\n  width: 50px;\n  text-align: center;\n  background-color: vaR(--input-bg);\n  outline: none;\n  color: vaR(--text-colour);\n}\n.empty-button:hover {\n  background-color: #d4d4d4;\n}\n.button {\n  border: none;\n  border-radius: 2px;\n  padding: 5px;\n  margin: 2px;\n  width: 80%;\n  text-align: center;\n  background-color: vaR(--input-bg);\n  outline: none;\n  color: vaR(--text-colour);\n  text-decoration: none;\n}\n.button:hover:enabled {\n  background-color: vaR(--input-hover-bg);\n}\n.short-button:hover:enabled {\n  background-color: vaR(--input-hover-bg);\n}\ninput,\na,\nbutton {\n  color: vaR(--text-colour);\n  background-color: vaR(--input-bg);\n  border: none;\n  outline: none;\n  padding: 4px;\n  text-decoration: none;\n}\ninput:hover,\na:hover,\nbutton:hover {\n  background-color: vaR(--input-hover-bg);\n}\n.blur {\n  background-color: rgba(255, 255, 255, 0.1);\n  backdrop-filter: blur(10px);\n}\nsvg {\n  fill: vaR(--text-colour);\n}\n@keyframes fadeIn {\n  from {\n    opacity: 0;\n  }\n  to {\n    opacity: 1;\n  }\n}\n#top-bar {\n  height: 40px;\n  display: flex;\n  justify-content: space-between;\n  align-items: center;\n  margin: 5px 0;\n  border-bottom: 1px solid vaR(--input-bg);\n}\n.item {\n  margin: 10px;\n  text-decoration: none;\n  background: none;\n  font-size: 15px;\n}\n.item:hover {\n  background: none;\n  color: vaR(--text-hover-colour);\n}\n",""]);const c=i},645:n=>{n.exports=function(n){var e=[];return e.toString=function(){return this.map((function(e){var t="",r=void 0!==e[5];return e[4]&&(t+="@supports (".concat(e[4],") {")),e[2]&&(t+="@media ".concat(e[2]," {")),r&&(t+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),t+=n(e),r&&(t+="}"),e[2]&&(t+="}"),e[4]&&(t+="}"),t})).join("")},e.i=function(n,t,r,o,a){"string"==typeof n&&(n=[[null,n,void 0]]);var i={};if(r)for(var c=0;c<this.length;c++){var u=this[c][0];null!=u&&(i[u]=!0)}for(var l=0;l<n.length;l++){var s=[].concat(n[l]);r&&i[s[0]]||(void 0!==a&&(void 0===s[5]||(s[1]="@layer".concat(s[5].length>0?" ".concat(s[5]):""," {").concat(s[1],"}")),s[5]=a),t&&(s[2]?(s[1]="@media ".concat(s[2]," {").concat(s[1],"}"),s[2]=t):s[2]=t),o&&(s[4]?(s[1]="@supports (".concat(s[4],") {").concat(s[1],"}"),s[4]=o):s[4]="".concat(o)),e.push(s))}},e}},81:n=>{n.exports=function(n){return n[1]}},379:n=>{var e=[];function t(n){for(var t=-1,r=0;r<e.length;r++)if(e[r].identifier===n){t=r;break}return t}function r(n,r){for(var a={},i=[],c=0;c<n.length;c++){var u=n[c],l=r.base?u[0]+r.base:u[0],s=a[l]||0,f="".concat(l," ").concat(s);a[l]=s+1;var d=t(f),p={css:u[1],media:u[2],sourceMap:u[3],supports:u[4],layer:u[5]};if(-1!==d)e[d].references++,e[d].updater(p);else{var h=o(p,r);r.byIndex=c,e.splice(c,0,{identifier:f,updater:h,references:1})}i.push(f)}return i}function o(n,e){var t=e.domAPI(e);return t.update(n),function(e){if(e){if(e.css===n.css&&e.media===n.media&&e.sourceMap===n.sourceMap&&e.supports===n.supports&&e.layer===n.layer)return;t.update(n=e)}else t.remove()}}n.exports=function(n,o){var a=r(n=n||[],o=o||{});return function(n){n=n||[];for(var i=0;i<a.length;i++){var c=t(a[i]);e[c].references--}for(var u=r(n,o),l=0;l<a.length;l++){var s=t(a[l]);0===e[s].references&&(e[s].updater(),e.splice(s,1))}a=u}}},569:n=>{var e={};n.exports=function(n,t){var r=function(n){if(void 0===e[n]){var t=document.querySelector(n);if(window.HTMLIFrameElement&&t instanceof window.HTMLIFrameElement)try{t=t.contentDocument.head}catch(n){t=null}e[n]=t}return e[n]}(n);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");r.appendChild(t)}},216:n=>{n.exports=function(n){var e=document.createElement("style");return n.setAttributes(e,n.attributes),n.insert(e,n.options),e}},565:(n,e,t)=>{n.exports=function(n){var e=t.nc;e&&n.setAttribute("nonce",e)}},795:n=>{n.exports=function(n){var e=n.insertStyleElement(n);return{update:function(t){!function(n,e,t){var r="";t.supports&&(r+="@supports (".concat(t.supports,") {")),t.media&&(r+="@media ".concat(t.media," {"));var o=void 0!==t.layer;o&&(r+="@layer".concat(t.layer.length>0?" ".concat(t.layer):""," {")),r+=t.css,o&&(r+="}"),t.media&&(r+="}"),t.supports&&(r+="}");var a=t.sourceMap;a&&"undefined"!=typeof btoa&&(r+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleTagTransform(r,n,e.options)}(e,n,t)},remove:function(){!function(n){if(null===n.parentNode)return!1;n.parentNode.removeChild(n)}(e)}}}},589:n=>{n.exports=function(n,e){if(e.styleSheet)e.styleSheet.cssText=n;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(n))}}},480:function(){var n=this&&this.__assign||function(){return n=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var o in e=arguments[t])Object.prototype.hasOwnProperty.call(e,o)&&(n[o]=e[o]);return n},n.apply(this,arguments)},e=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))((function(o,a){function i(n){try{u(r.next(n))}catch(n){a(n)}}function c(n){try{u(r.throw(n))}catch(n){a(n)}}function u(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(i,c)}u((r=r.apply(n,e||[])).next())}))},t=this&&this.__generator||function(n,e){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(n,i)}catch(n){a=[6,n],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};function r(){var n=window.location.href;window.location.href="https://entropyengine.dev/accounts/error?type=serverPingFailed&cb="+encodeURIComponent(n)}var o="https://entropyengine.dev:".concat("50001");request=function(a,i,c){return void 0===i&&(i={user:-1,project:-1}),void 0===c&&(c={}),e(void 0,void 0,void 0,(function(){var e;return t(this,(function(t){switch(t.label){case 0:return i.user||(i.user=localStorage.id),i.project&&i.user?[4,fetch("".concat(o,"/").concat(a),{method:"POST",body:JSON.stringify(n(n({},c),{token:i}))}).catch(r)]:(console.error("Bad API token: ",i),[2,{}]);case 1:return(e=t.sent())?[4,e.json()]:[2,{error:"no response"}];case 2:return[2,t.sent()]}}))}))};try{request("ping").then((function(n){n.ok||r()})).catch((function(){r()}))}catch(n){r()}},316:function(){var n=this&&this.__awaiter||function(n,e,t,r){return new(t||(t=Promise))((function(o,a){function i(n){try{u(r.next(n))}catch(n){a(n)}}function c(n){try{u(r.throw(n))}catch(n){a(n)}}function u(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(i,c)}u((r=r.apply(n,e||[])).next())}))},e=this&&this.__generator||function(n,e){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(n,i)}catch(n){a=[6,n],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}};signOut=function(){localStorage.id=void 0},forceSignOut=function(n){signOut(),window.location.href="https://entropyengine.dev/accounts/error?type="+n},validID=function(t){return n(void 0,void 0,void 0,(function(){var n;return e(this,(function(e){switch(e.label){case 0:return(n=![void 0,0,"0",null,""," ",[],"undefined","null","none"].includes(t))?[4,request("user-exists",{user:t})]:[3,2];case 1:n=!!e.sent().exists,e.label=2;case 2:return[2,n]}}))}))},mustBeSignedIn=function(t,r){return n(void 0,void 0,void 0,(function(){return e(this,(function(n){switch(n.label){case 0:return[4,validID(localStorage.id)];case 1:return n.sent()?(t(),[2]):(forceSignOut("notSignedIn"),r&&r(),[2])}}))}))};var t=window.location.search,r=new URLSearchParams(t);urlParam=function(n){return r.get(n)},sleep=function(n){return new Promise((function(e){return setTimeout(e,n)}))},genCacheBust=function(){return Math.ceil(1e4*Math.random())},secondsToReadable=function(n){var e=n,t=n/60,r=t/60,o=r/24,a=o/365,i="";return a>=1&&(i+="".concat(Math.floor(a)," years "),o%=365),o>=1&&e<3154e4&&(i+="".concat(Math.floor(o)," days "),r%=24),r>=1&&e<86400&&(i+="".concat(Math.floor(r)," hours "),t%=60),t>=1&&e<2600&&(i+="".concat(Math.floor(t)," minutes "),n%=60),e<60&&(i+="".concat(n," seconds")),i},unixTimeAgo=function(n){return secondsToReadable(Math.round((new Date).getTime()/1e3)-n)},nameFromScriptURL=function(n){var e=n.substring(n.lastIndexOf("/")+1);return e.substring(0,e.length-3)},copyToClipboard=function(n){var e=document.createElement("input");e.style.position="absolute",e.style.position="-10000px",e.value=n,e.select(),e.setSelectionRange(0,99999),document.execCommand("copy"),e.innerText="",document.removeChild(e)}}},e={};function t(r){var o=e[r];if(void 0!==o)return o.exports;var a=e[r]={id:r,exports:{}};return n[r].call(a.exports,a,a.exports,t),a.exports}t.n=n=>{var e=n&&n.__esModule?()=>n.default:()=>n;return t.d(e,{a:e}),e},t.d=(n,e)=>{for(var r in e)t.o(e,r)&&!t.o(n,r)&&Object.defineProperty(n,r,{enumerable:!0,get:e[r]})},t.o=(n,e)=>Object.prototype.hasOwnProperty.call(n,e),(()=>{var n=t(379),e=t.n(n),r=t(795),o=t.n(r),a=t(569),i=t.n(a),c=t(565),u=t.n(c),l=t(216),s=t.n(l),f=t(589),d=t.n(f),p=t(257),h={};h.styleTagTransform=d(),h.setAttributes=u(),h.insert=i().bind(null,"head"),h.domAPI=o(),h.insertStyleElement=s(),e()(p.Z,h),p.Z&&p.Z.locals&&p.Z.locals,t(316),t(480);apiToken={user:localStorage.id};var b=function(){return n=void 0,e=void 0,r=function(){var n,e;return function(n,e){var t,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(a){return function(c){return function(a){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(o=2&a[0]?r.return:a[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,a[1])).done)return o;switch(r=0,o&&(a=[2&a[0],o.value]),a[0]){case 0:case 1:o=a;break;case 4:return i.label++,{value:a[1],done:!1};case 5:i.label++,r=a[1],a=[0];continue;case 7:a=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==a[0]&&2!==a[0])){i=0;continue}if(3===a[0]&&(!o||a[1]>o[0]&&a[1]<o[3])){i.label=a[1];break}if(6===a[0]&&i.label<o[1]){i.label=o[1],o=a;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(a);break}o[2]&&i.ops.pop(),i.trys.pop();continue}a=e.call(n,i)}catch(n){a=[6,n],r=0}finally{t=o=0}if(5&a[0])throw a[1];return{value:a[0]?a[1]:void 0,done:!0}}([a,c])}}}(this,(function(t){switch(t.label){case 0:return n=performance.now(),[4,fetch("https://entropyengine.dev:50001/ping",{method:"POST",body:JSON.stringify({})})];case 1:return[4,t.sent().json()];case 2:return t.sent().ok?(e=performance.now()-n,$("#ping").html(Math.floor(e).toFixed(3)),[2]):(console.error("Server ping failed"),[2])}}))},new((t=void 0)||(t=Promise))((function(o,a){function i(n){try{u(r.next(n))}catch(n){a(n)}}function c(n){try{u(r.throw(n))}catch(n){a(n)}}function u(n){var e;n.done?o(n.value):(e=n.value,e instanceof t?e:new t((function(n){n(e)}))).then(i,c)}u((r=r.apply(n,e||[])).next())}));var n,e,t,r};setInterval(b,5e3),b()})()})();</script><script defer="defer">/*! For license information please see bundle.js.LICENSE.txt */
(()=>{var e={842:function(e,t,n){var r;r=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=21)}([function(e,t){var r={};e.exports=r,function(){r._nextId=0,r._seed=0,r._nowStartTime=+new Date,r._warnedOnce={},r._decomp=null,r.extend=function(e,t){var n,o;"boolean"==typeof t?(n=2,o=t):(n=1,o=!0);for(var i=n;i<arguments.length;i++){var a=arguments[i];if(a)for(var s in a)o&&a[s]&&a[s].constructor===Object?e[s]&&e[s].constructor!==Object?e[s]=a[s]:(e[s]=e[s]||{},r.extend(e[s],o,a[s])):e[s]=a[s]}return e},r.clone=function(e,t){return r.extend({},t,e)},r.keys=function(e){if(Object.keys)return Object.keys(e);var t=[];for(var n in e)t.push(n);return t},r.values=function(e){var t=[];if(Object.keys){for(var n=Object.keys(e),r=0;r<n.length;r++)t.push(e[n[r]]);return t}for(var o in e)t.push(e[o]);return t},r.get=function(e,t,n,r){t=t.split(".").slice(n,r);for(var o=0;o<t.length;o+=1)e=e[t[o]];return e},r.set=function(e,t,n,o,i){var a=t.split(".").slice(o,i);return r.get(e,t,0,-1)[a[a.length-1]]=n,n},r.shuffle=function(e){for(var t=e.length-1;t>0;t--){var n=Math.floor(r.random()*(t+1)),o=e[t];e[t]=e[n],e[n]=o}return e},r.choose=function(e){return e[Math.floor(r.random()*e.length)]},r.isElement=function(e){return"undefined"!=typeof HTMLElement?e instanceof HTMLElement:!!(e&&e.nodeType&&e.nodeName)},r.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},r.isFunction=function(e){return"function"==typeof e},r.isPlainObject=function(e){return"object"==typeof e&&e.constructor===Object},r.isString=function(e){return"[object String]"===toString.call(e)},r.clamp=function(e,t,n){return e<t?t:e>n?n:e},r.sign=function(e){return e<0?-1:1},r.now=function(){if("undefined"!=typeof window&&window.performance){if(window.performance.now)return window.performance.now();if(window.performance.webkitNow)return window.performance.webkitNow()}return Date.now?Date.now():new Date-r._nowStartTime},r.random=function(t,n){return n=void 0!==n?n:1,(t=void 0!==t?t:0)+e()*(n-t)};var e=function(){return r._seed=(9301*r._seed+49297)%233280,r._seed/233280};r.colorToNumber=function(e){return 3==(e=e.replace("#","")).length&&(e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)),parseInt(e,16)},r.logLevel=1,r.log=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.log.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.info=function(){console&&r.logLevel>0&&r.logLevel<=2&&console.info.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warn=function(){console&&r.logLevel>0&&r.logLevel<=3&&console.warn.apply(console,["matter-js:"].concat(Array.prototype.slice.call(arguments)))},r.warnOnce=function(){var e=Array.prototype.slice.call(arguments).join(" ");r._warnedOnce[e]||(r.warn(e),r._warnedOnce[e]=!0)},r.deprecated=function(e,t,n){e[t]=r.chain((function(){r.warnOnce("ðŸ”… deprecated ðŸ”…",n)}),e[t])},r.nextId=function(){return r._nextId++},r.indexOf=function(e,t){if(e.indexOf)return e.indexOf(t);for(var n=0;n<e.length;n++)if(e[n]===t)return n;return-1},r.map=function(e,t){if(e.map)return e.map(t);for(var n=[],r=0;r<e.length;r+=1)n.push(t(e[r]));return n},r.topologicalSort=function(e){var t=[],n=[],o=[];for(var i in e)n[i]||o[i]||r._topologicalSort(i,n,o,e,t);return t},r._topologicalSort=function(e,t,n,o,i){var a=o[e]||[];n[e]=!0;for(var s=0;s<a.length;s+=1){var c=a[s];n[c]||t[c]||r._topologicalSort(c,t,n,o,i)}n[e]=!1,t[e]=!0,i.push(e)},r.chain=function(){for(var e=[],t=0;t<arguments.length;t+=1){var n=arguments[t];n._chained?e.push.apply(e,n._chained):e.push(n)}var r=function(){for(var t,n=new Array(arguments.length),r=0,o=arguments.length;r<o;r++)n[r]=arguments[r];for(r=0;r<e.length;r+=1){var i=e[r].apply(t,n);void 0!==i&&(t=i)}return t};return r._chained=e,r},r.chainPathBefore=function(e,t,n){return r.set(e,t,r.chain(n,r.get(e,t)))},r.chainPathAfter=function(e,t,n){return r.set(e,t,r.chain(r.get(e,t),n))},r.setDecomp=function(e){r._decomp=e},r.getDecomp=function(){var e=r._decomp;try{e||"undefined"==typeof window||(e=window.decomp),e||void 0===n.g||(e=n.g.decomp)}catch(t){e=null}return e}}()},function(e,t){var n={};e.exports=n,n.create=function(e){var t={min:{x:0,y:0},max:{x:0,y:0}};return e&&n.update(t,e),t},n.update=function(e,t,n){e.min.x=1/0,e.max.x=-1/0,e.min.y=1/0,e.max.y=-1/0;for(var r=0;r<t.length;r++){var o=t[r];o.x>e.max.x&&(e.max.x=o.x),o.x<e.min.x&&(e.min.x=o.x),o.y>e.max.y&&(e.max.y=o.y),o.y<e.min.y&&(e.min.y=o.y)}n&&(n.x>0?e.max.x+=n.x:e.min.x+=n.x,n.y>0?e.max.y+=n.y:e.min.y+=n.y)},n.contains=function(e,t){return t.x>=e.min.x&&t.x<=e.max.x&&t.y>=e.min.y&&t.y<=e.max.y},n.overlaps=function(e,t){return e.min.x<=t.max.x&&e.max.x>=t.min.x&&e.max.y>=t.min.y&&e.min.y<=t.max.y},n.translate=function(e,t){e.min.x+=t.x,e.max.x+=t.x,e.min.y+=t.y,e.max.y+=t.y},n.shift=function(e,t){var n=e.max.x-e.min.x,r=e.max.y-e.min.y;e.min.x=t.x,e.max.x=t.x+n,e.min.y=t.y,e.max.y=t.y+r}},function(e,t){var n={};e.exports=n,n.create=function(e,t){return{x:e||0,y:t||0}},n.clone=function(e){return{x:e.x,y:e.y}},n.magnitude=function(e){return Math.sqrt(e.x*e.x+e.y*e.y)},n.magnitudeSquared=function(e){return e.x*e.x+e.y*e.y},n.rotate=function(e,t,n){var r=Math.cos(t),o=Math.sin(t);n||(n={});var i=e.x*r-e.y*o;return n.y=e.x*o+e.y*r,n.x=i,n},n.rotateAbout=function(e,t,n,r){var o=Math.cos(t),i=Math.sin(t);r||(r={});var a=n.x+((e.x-n.x)*o-(e.y-n.y)*i);return r.y=n.y+((e.x-n.x)*i+(e.y-n.y)*o),r.x=a,r},n.normalise=function(e){var t=n.magnitude(e);return 0===t?{x:0,y:0}:{x:e.x/t,y:e.y/t}},n.dot=function(e,t){return e.x*t.x+e.y*t.y},n.cross=function(e,t){return e.x*t.y-e.y*t.x},n.cross3=function(e,t,n){return(t.x-e.x)*(n.y-e.y)-(t.y-e.y)*(n.x-e.x)},n.add=function(e,t,n){return n||(n={}),n.x=e.x+t.x,n.y=e.y+t.y,n},n.sub=function(e,t,n){return n||(n={}),n.x=e.x-t.x,n.y=e.y-t.y,n},n.mult=function(e,t){return{x:e.x*t,y:e.y*t}},n.div=function(e,t){return{x:e.x/t,y:e.y/t}},n.perp=function(e,t){return{x:(t=!0===t?-1:1)*-e.y,y:t*e.x}},n.neg=function(e){return{x:-e.x,y:-e.y}},n.angle=function(e,t){return Math.atan2(t.y-e.y,t.x-e.x)},n._temp=[n.create(),n.create(),n.create(),n.create(),n.create(),n.create()]},function(e,t,n){var r={};e.exports=r;var o=n(2),i=n(0);r.create=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r],i={x:o.x,y:o.y,index:r,body:t,isInternal:!1};n.push(i)}return n},r.fromPath=function(e,t){var n=[];return e.replace(/L?\s*([-\d.e]+)[\s,]*([-\d.e]+)*/gi,(function(e,t,r){n.push({x:parseFloat(t),y:parseFloat(r)})})),r.create(n,t)},r.centre=function(e){for(var t,n,i,a=r.area(e,!0),s={x:0,y:0},c=0;c<e.length;c++)i=(c+1)%e.length,t=o.cross(e[c],e[i]),n=o.mult(o.add(e[c],e[i]),t),s=o.add(s,n);return o.div(s,6*a)},r.mean=function(e){for(var t={x:0,y:0},n=0;n<e.length;n++)t.x+=e[n].x,t.y+=e[n].y;return o.div(t,e.length)},r.area=function(e,t){for(var n=0,r=e.length-1,o=0;o<e.length;o++)n+=(e[r].x-e[o].x)*(e[r].y+e[o].y),r=o;return t?n/2:Math.abs(n)/2},r.inertia=function(e,t){for(var n,r,i=0,a=0,s=e,c=0;c<s.length;c++)r=(c+1)%s.length,i+=(n=Math.abs(o.cross(s[r],s[c])))*(o.dot(s[r],s[r])+o.dot(s[r],s[c])+o.dot(s[c],s[c])),a+=n;return t/6*(i/a)},r.translate=function(e,t,n){n=void 0!==n?n:1;var r,o=e.length,i=t.x*n,a=t.y*n;for(r=0;r<o;r++)e[r].x+=i,e[r].y+=a;return e},r.rotate=function(e,t,n){if(0!==t){var r,o,i,a,s=Math.cos(t),c=Math.sin(t),u=n.x,l=n.y,f=e.length;for(a=0;a<f;a++)o=(r=e[a]).x-u,i=r.y-l,r.x=u+(o*s-i*c),r.y=l+(o*c+i*s);return e}},r.contains=function(e,t){for(var n,r=t.x,o=t.y,i=e.length,a=e[i-1],s=0;s<i;s++){if(n=e[s],(r-a.x)*(n.y-a.y)+(o-a.y)*(a.x-n.x)>0)return!1;a=n}return!0},r.scale=function(e,t,n,i){if(1===t&&1===n)return e;var a,s;i=i||r.centre(e);for(var c=0;c<e.length;c++)a=e[c],s=o.sub(a,i),e[c].x=i.x+s.x*t,e[c].y=i.y+s.y*n;return e},r.chamfer=function(e,t,n,r,a){t="number"==typeof t?[t]:t||[8],n=void 0!==n?n:-1,r=r||2,a=a||14;for(var s=[],c=0;c<e.length;c++){var u=e[c-1>=0?c-1:e.length-1],l=e[c],f=e[(c+1)%e.length],p=t[c<t.length?c:t.length-1];if(0!==p){var d=o.normalise({x:l.y-u.y,y:u.x-l.x}),y=o.normalise({x:f.y-l.y,y:l.x-f.x}),h=Math.sqrt(2*Math.pow(p,2)),v=o.mult(i.clone(d),p),m=o.normalise(o.mult(o.add(d,y),.5)),b=o.sub(l,o.mult(m,h)),g=n;-1===n&&(g=1.75*Math.pow(p,.32)),(g=i.clamp(g,r,a))%2==1&&(g+=1);for(var w=Math.acos(o.dot(d,y))/g,x=0;x<g;x++)s.push(o.add(o.rotate(v,w*x),b))}else s.push(l)}return s},r.clockwiseSort=function(e){var t=r.mean(e);return e.sort((function(e,n){return o.angle(t,e)-o.angle(t,n)})),e},r.isConvex=function(e){var t,n,r,o,i=0,a=e.length;if(a<3)return null;for(t=0;t<a;t++)if(r=(t+2)%a,o=(e[n=(t+1)%a].x-e[t].x)*(e[r].y-e[n].y),(o-=(e[n].y-e[t].y)*(e[r].x-e[n].x))<0?i|=1:o>0&&(i|=2),3===i)return!1;return 0!==i||null},r.hull=function(e){var t,n,r=[],i=[];for((e=e.slice(0)).sort((function(e,t){var n=e.x-t.x;return 0!==n?n:e.y-t.y})),n=0;n<e.length;n+=1){for(t=e[n];i.length>=2&&o.cross3(i[i.length-2],i[i.length-1],t)<=0;)i.pop();i.push(t)}for(n=e.length-1;n>=0;n-=1){for(t=e[n];r.length>=2&&o.cross3(r[r.length-2],r[r.length-1],t)<=0;)r.pop();r.push(t)}return r.pop(),i.pop(),r.concat(i)}},function(e,t,n){var r={};e.exports=r;var o=n(0);r.on=function(e,t,n){for(var r,o=t.split(" "),i=0;i<o.length;i++)r=o[i],e.events=e.events||{},e.events[r]=e.events[r]||[],e.events[r].push(n);return n},r.off=function(e,t,n){if(t){"function"==typeof t&&(n=t,t=o.keys(e.events).join(" "));for(var r=t.split(" "),i=0;i<r.length;i++){var a=e.events[r[i]],s=[];if(n&&a)for(var c=0;c<a.length;c++)a[c]!==n&&s.push(a[c]);e.events[r[i]]=s}}else e.events={}},r.trigger=function(e,t,n){var r,i,a,s,c=e.events;if(c&&o.keys(c).length>0){n||(n={}),r=t.split(" ");for(var u=0;u<r.length;u++)if(a=c[i=r[u]]){(s=o.clone(n,!1)).name=i,s.source=e;for(var l=0;l<a.length;l++)a[l].apply(e,[s])}}}},function(e,t,n){var r={};e.exports=r;var o=n(4),i=n(0),a=n(1),s=n(6);r.create=function(e){return i.extend({id:i.nextId(),type:"composite",parent:null,isModified:!1,bodies:[],constraints:[],composites:[],label:"Composite",plugin:{},cache:{allBodies:null,allConstraints:null,allComposites:null}},e)},r.setModified=function(e,t,n,o){if(e.isModified=t,t&&e.cache&&(e.cache.allBodies=null,e.cache.allConstraints=null,e.cache.allComposites=null),n&&e.parent&&r.setModified(e.parent,t,n,o),o)for(var i=0;i<e.composites.length;i++){var a=e.composites[i];r.setModified(a,t,n,o)}},r.add=function(e,t){var n=[].concat(t);o.trigger(e,"beforeAdd",{object:t});for(var a=0;a<n.length;a++){var s=n[a];switch(s.type){case"body":if(s.parent!==s){i.warn("Composite.add: skipped adding a compound body part (you must add its parent instead)");break}r.addBody(e,s);break;case"constraint":r.addConstraint(e,s);break;case"composite":r.addComposite(e,s);break;case"mouseConstraint":r.addConstraint(e,s.constraint)}}return o.trigger(e,"afterAdd",{object:t}),e},r.remove=function(e,t,n){var i=[].concat(t);o.trigger(e,"beforeRemove",{object:t});for(var a=0;a<i.length;a++){var s=i[a];switch(s.type){case"body":r.removeBody(e,s,n);break;case"constraint":r.removeConstraint(e,s,n);break;case"composite":r.removeComposite(e,s,n);break;case"mouseConstraint":r.removeConstraint(e,s.constraint)}}return o.trigger(e,"afterRemove",{object:t}),e},r.addComposite=function(e,t){return e.composites.push(t),t.parent=e,r.setModified(e,!0,!0,!1),e},r.removeComposite=function(e,t,n){var o=i.indexOf(e.composites,t);if(-1!==o&&r.removeCompositeAt(e,o),n)for(var a=0;a<e.composites.length;a++)r.removeComposite(e.composites[a],t,!0);return e},r.removeCompositeAt=function(e,t){return e.composites.splice(t,1),r.setModified(e,!0,!0,!1),e},r.addBody=function(e,t){return e.bodies.push(t),r.setModified(e,!0,!0,!1),e},r.removeBody=function(e,t,n){var o=i.indexOf(e.bodies,t);if(-1!==o&&r.removeBodyAt(e,o),n)for(var a=0;a<e.composites.length;a++)r.removeBody(e.composites[a],t,!0);return e},r.removeBodyAt=function(e,t){return e.bodies.splice(t,1),r.setModified(e,!0,!0,!1),e},r.addConstraint=function(e,t){return e.constraints.push(t),r.setModified(e,!0,!0,!1),e},r.removeConstraint=function(e,t,n){var o=i.indexOf(e.constraints,t);if(-1!==o&&r.removeConstraintAt(e,o),n)for(var a=0;a<e.composites.length;a++)r.removeConstraint(e.composites[a],t,!0);return e},r.removeConstraintAt=function(e,t){return e.constraints.splice(t,1),r.setModified(e,!0,!0,!1),e},r.clear=function(e,t,n){if(n)for(var o=0;o<e.composites.length;o++)r.clear(e.composites[o],t,!0);return t?e.bodies=e.bodies.filter((function(e){return e.isStatic})):e.bodies.length=0,e.constraints.length=0,e.composites.length=0,r.setModified(e,!0,!0,!1),e},r.allBodies=function(e){if(e.cache&&e.cache.allBodies)return e.cache.allBodies;for(var t=[].concat(e.bodies),n=0;n<e.composites.length;n++)t=t.concat(r.allBodies(e.composites[n]));return e.cache&&(e.cache.allBodies=t),t},r.allConstraints=function(e){if(e.cache&&e.cache.allConstraints)return e.cache.allConstraints;for(var t=[].concat(e.constraints),n=0;n<e.composites.length;n++)t=t.concat(r.allConstraints(e.composites[n]));return e.cache&&(e.cache.allConstraints=t),t},r.allComposites=function(e){if(e.cache&&e.cache.allComposites)return e.cache.allComposites;for(var t=[].concat(e.composites),n=0;n<e.composites.length;n++)t=t.concat(r.allComposites(e.composites[n]));return e.cache&&(e.cache.allComposites=t),t},r.get=function(e,t,n){var o,i;switch(n){case"body":o=r.allBodies(e);break;case"constraint":o=r.allConstraints(e);break;case"composite":o=r.allComposites(e).concat(e)}return o?0===(i=o.filter((function(e){return e.id.toString()===t.toString()}))).length?null:i[0]:null},r.move=function(e,t,n){return r.remove(e,t),r.add(n,t),e},r.rebase=function(e){for(var t=r.allBodies(e).concat(r.allConstraints(e)).concat(r.allComposites(e)),n=0;n<t.length;n++)t[n].id=i.nextId();return e},r.translate=function(e,t,n){for(var o=n?r.allBodies(e):e.bodies,i=0;i<o.length;i++)s.translate(o[i],t);return e},r.rotate=function(e,t,n,o){for(var i=Math.cos(t),a=Math.sin(t),c=o?r.allBodies(e):e.bodies,u=0;u<c.length;u++){var l=c[u],f=l.position.x-n.x,p=l.position.y-n.y;s.setPosition(l,{x:n.x+(f*i-p*a),y:n.y+(f*a+p*i)}),s.rotate(l,t)}return e},r.scale=function(e,t,n,o,i){for(var a=i?r.allBodies(e):e.bodies,c=0;c<a.length;c++){var u=a[c],l=u.position.x-o.x,f=u.position.y-o.y;s.setPosition(u,{x:o.x+l*t,y:o.y+f*n}),s.scale(u,t,n)}return e},r.bounds=function(e){for(var t=r.allBodies(e),n=[],o=0;o<t.length;o+=1){var i=t[o];n.push(i.bounds.min,i.bounds.max)}return a.create(n)}},function(e,t,n){var r={};e.exports=r;var o=n(3),i=n(2),a=n(7),s=(n(16),n(0)),c=n(1),u=n(11);!function(){r._inertiaScale=4,r._nextCollidingGroupId=1,r._nextNonCollidingGroupId=-1,r._nextCategory=1,r.create=function(t){var n={id:s.nextId(),type:"body",label:"Body",parts:[],plugin:{},angle:0,vertices:o.fromPath("L 0 0 L 40 0 L 40 40 L 0 40"),position:{x:0,y:0},force:{x:0,y:0},torque:0,positionImpulse:{x:0,y:0},constraintImpulse:{x:0,y:0,angle:0},totalContacts:0,speed:0,angularSpeed:0,velocity:{x:0,y:0},angularVelocity:0,isSensor:!1,isStatic:!1,isSleeping:!1,motion:0,sleepThreshold:60,density:.001,restitution:0,friction:.1,frictionStatic:.5,frictionAir:.01,collisionFilter:{category:1,mask:4294967295,group:0},slop:.05,timeScale:1,render:{visible:!0,opacity:1,strokeStyle:null,fillStyle:null,lineWidth:null,sprite:{xScale:1,yScale:1,xOffset:0,yOffset:0}},events:null,bounds:null,chamfer:null,circleRadius:0,positionPrev:null,anglePrev:0,parent:null,axes:null,area:0,mass:0,inertia:0,_original:null},r=s.extend(n,t);return e(r,t),r},r.nextGroup=function(e){return e?r._nextNonCollidingGroupId--:r._nextCollidingGroupId++},r.nextCategory=function(){return r._nextCategory=r._nextCategory<<1,r._nextCategory};var e=function(e,t){t=t||{},r.set(e,{bounds:e.bounds||c.create(e.vertices),positionPrev:e.positionPrev||i.clone(e.position),anglePrev:e.anglePrev||e.angle,vertices:e.vertices,parts:e.parts||[e],isStatic:e.isStatic,isSleeping:e.isSleeping,parent:e.parent||e}),o.rotate(e.vertices,e.angle,e.position),u.rotate(e.axes,e.angle),c.update(e.bounds,e.vertices,e.velocity),r.set(e,{axes:t.axes||e.axes,area:t.area||e.area,mass:t.mass||e.mass,inertia:t.inertia||e.inertia});var n=e.isStatic?"#14151f":s.choose(["#f19648","#f5d259","#f55a3c","#063e7b","#ececd1"]),a=e.isStatic?"#555":"#ccc",l=e.isStatic&&null===e.render.fillStyle?1:0;e.render.fillStyle=e.render.fillStyle||n,e.render.strokeStyle=e.render.strokeStyle||a,e.render.lineWidth=e.render.lineWidth||l,e.render.sprite.xOffset+=-(e.bounds.min.x-e.position.x)/(e.bounds.max.x-e.bounds.min.x),e.render.sprite.yOffset+=-(e.bounds.min.y-e.position.y)/(e.bounds.max.y-e.bounds.min.y)};r.set=function(e,t,n){var o;for(o in"string"==typeof t&&(o=t,(t={})[o]=n),t)if(Object.prototype.hasOwnProperty.call(t,o))switch(n=t[o],o){case"isStatic":r.setStatic(e,n);break;case"isSleeping":a.set(e,n);break;case"mass":r.setMass(e,n);break;case"density":r.setDensity(e,n);break;case"inertia":r.setInertia(e,n);break;case"vertices":r.setVertices(e,n);break;case"position":r.setPosition(e,n);break;case"angle":r.setAngle(e,n);break;case"velocity":r.setVelocity(e,n);break;case"angularVelocity":r.setAngularVelocity(e,n);break;case"parts":r.setParts(e,n);break;case"centre":r.setCentre(e,n);break;default:e[o]=n}},r.setStatic=function(e,t){for(var n=0;n<e.parts.length;n++){var r=e.parts[n];r.isStatic=t,t?(r._original={restitution:r.restitution,friction:r.friction,mass:r.mass,inertia:r.inertia,density:r.density,inverseMass:r.inverseMass,inverseInertia:r.inverseInertia},r.restitution=0,r.friction=1,r.mass=r.inertia=r.density=1/0,r.inverseMass=r.inverseInertia=0,r.positionPrev.x=r.position.x,r.positionPrev.y=r.position.y,r.anglePrev=r.angle,r.angularVelocity=0,r.speed=0,r.angularSpeed=0,r.motion=0):r._original&&(r.restitution=r._original.restitution,r.friction=r._original.friction,r.mass=r._original.mass,r.inertia=r._original.inertia,r.density=r._original.density,r.inverseMass=r._original.inverseMass,r.inverseInertia=r._original.inverseInertia,r._original=null)}},r.setMass=function(e,t){var n=e.inertia/(e.mass/6);e.inertia=n*(t/6),e.inverseInertia=1/e.inertia,e.mass=t,e.inverseMass=1/e.mass,e.density=e.mass/e.area},r.setDensity=function(e,t){r.setMass(e,t*e.area),e.density=t},r.setInertia=function(e,t){e.inertia=t,e.inverseInertia=1/e.inertia},r.setVertices=function(e,t){t[0].body===e?e.vertices=t:e.vertices=o.create(t,e),e.axes=u.fromVertices(e.vertices),e.area=o.area(e.vertices),r.setMass(e,e.density*e.area);var n=o.centre(e.vertices);o.translate(e.vertices,n,-1),r.setInertia(e,r._inertiaScale*o.inertia(e.vertices,e.mass)),o.translate(e.vertices,e.position),c.update(e.bounds,e.vertices,e.velocity)},r.setParts=function(e,t,n){var i;for(t=t.slice(0),e.parts.length=0,e.parts.push(e),e.parent=e,i=0;i<t.length;i++){var a=t[i];a!==e&&(a.parent=e,e.parts.push(a))}if(1!==e.parts.length){if(n=void 0===n||n){var s=[];for(i=0;i<t.length;i++)s=s.concat(t[i].vertices);o.clockwiseSort(s);var c=o.hull(s),u=o.centre(c);r.setVertices(e,c),o.translate(e.vertices,u)}var l=r._totalProperties(e);e.area=l.area,e.parent=e,e.position.x=l.centre.x,e.position.y=l.centre.y,e.positionPrev.x=l.centre.x,e.positionPrev.y=l.centre.y,r.setMass(e,l.mass),r.setInertia(e,l.inertia),r.setPosition(e,l.centre)}},r.setCentre=function(e,t,n){n?(e.positionPrev.x+=t.x,e.positionPrev.y+=t.y,e.position.x+=t.x,e.position.y+=t.y):(e.positionPrev.x=t.x-(e.position.x-e.positionPrev.x),e.positionPrev.y=t.y-(e.position.y-e.positionPrev.y),e.position.x=t.x,e.position.y=t.y)},r.setPosition=function(e,t){var n=i.sub(t,e.position);e.positionPrev.x+=n.x,e.positionPrev.y+=n.y;for(var r=0;r<e.parts.length;r++){var a=e.parts[r];a.position.x+=n.x,a.position.y+=n.y,o.translate(a.vertices,n),c.update(a.bounds,a.vertices,e.velocity)}},r.setAngle=function(e,t){var n=t-e.angle;e.anglePrev+=n;for(var r=0;r<e.parts.length;r++){var a=e.parts[r];a.angle+=n,o.rotate(a.vertices,n,e.position),u.rotate(a.axes,n),c.update(a.bounds,a.vertices,e.velocity),r>0&&i.rotateAbout(a.position,n,e.position,a.position)}},r.setVelocity=function(e,t){e.positionPrev.x=e.position.x-t.x,e.positionPrev.y=e.position.y-t.y,e.velocity.x=t.x,e.velocity.y=t.y,e.speed=i.magnitude(e.velocity)},r.setAngularVelocity=function(e,t){e.anglePrev=e.angle-t,e.angularVelocity=t,e.angularSpeed=Math.abs(e.angularVelocity)},r.translate=function(e,t){r.setPosition(e,i.add(e.position,t))},r.rotate=function(e,t,n){if(n){var o=Math.cos(t),i=Math.sin(t),a=e.position.x-n.x,s=e.position.y-n.y;r.setPosition(e,{x:n.x+(a*o-s*i),y:n.y+(a*i+s*o)}),r.setAngle(e,e.angle+t)}else r.setAngle(e,e.angle+t)},r.scale=function(e,t,n,i){var a=0,s=0;i=i||e.position;for(var l=0;l<e.parts.length;l++){var f=e.parts[l];o.scale(f.vertices,t,n,i),f.axes=u.fromVertices(f.vertices),f.area=o.area(f.vertices),r.setMass(f,e.density*f.area),o.translate(f.vertices,{x:-f.position.x,y:-f.position.y}),r.setInertia(f,r._inertiaScale*o.inertia(f.vertices,f.mass)),o.translate(f.vertices,{x:f.position.x,y:f.position.y}),l>0&&(a+=f.area,s+=f.inertia),f.position.x=i.x+(f.position.x-i.x)*t,f.position.y=i.y+(f.position.y-i.y)*n,c.update(f.bounds,f.vertices,e.velocity)}e.parts.length>1&&(e.area=a,e.isStatic||(r.setMass(e,e.density*a),r.setInertia(e,s))),e.circleRadius&&(t===n?e.circleRadius*=t:e.circleRadius=null)},r.update=function(e,t,n,r){var a=Math.pow(t*n*e.timeScale,2),s=1-e.frictionAir*n*e.timeScale,l=e.position.x-e.positionPrev.x,f=e.position.y-e.positionPrev.y;e.velocity.x=l*s*r+e.force.x/e.mass*a,e.velocity.y=f*s*r+e.force.y/e.mass*a,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.position.x+=e.velocity.x,e.position.y+=e.velocity.y,e.angularVelocity=(e.angle-e.anglePrev)*s*r+e.torque/e.inertia*a,e.anglePrev=e.angle,e.angle+=e.angularVelocity,e.speed=i.magnitude(e.velocity),e.angularSpeed=Math.abs(e.angularVelocity);for(var p=0;p<e.parts.length;p++){var d=e.parts[p];o.translate(d.vertices,e.velocity),p>0&&(d.position.x+=e.velocity.x,d.position.y+=e.velocity.y),0!==e.angularVelocity&&(o.rotate(d.vertices,e.angularVelocity,e.position),u.rotate(d.axes,e.angularVelocity),p>0&&i.rotateAbout(d.position,e.angularVelocity,e.position,d.position)),c.update(d.bounds,d.vertices,e.velocity)}},r.applyForce=function(e,t,n){e.force.x+=n.x,e.force.y+=n.y;var r=t.x-e.position.x,o=t.y-e.position.y;e.torque+=r*n.y-o*n.x},r._totalProperties=function(e){for(var t={mass:0,area:0,inertia:0,centre:{x:0,y:0}},n=1===e.parts.length?0:1;n<e.parts.length;n++){var r=e.parts[n],o=r.mass!==1/0?r.mass:1;t.mass+=o,t.area+=r.area,t.inertia+=r.inertia,t.centre=i.add(t.centre,i.mult(r.position,o))}return t.centre=i.div(t.centre,t.mass),t}}()},function(e,t,n){var r={};e.exports=r;var o=n(4);r._motionWakeThreshold=.18,r._motionSleepThreshold=.08,r._minBias=.9,r.update=function(e,t){for(var n=t*t*t,o=0;o<e.length;o++){var i=e[o],a=i.speed*i.speed+i.angularSpeed*i.angularSpeed;if(0===i.force.x&&0===i.force.y){var s=Math.min(i.motion,a),c=Math.max(i.motion,a);i.motion=r._minBias*s+(1-r._minBias)*c,i.sleepThreshold>0&&i.motion<r._motionSleepThreshold*n?(i.sleepCounter+=1,i.sleepCounter>=i.sleepThreshold&&r.set(i,!0)):i.sleepCounter>0&&(i.sleepCounter-=1)}else r.set(i,!1)}},r.afterCollisions=function(e,t){for(var n=t*t*t,o=0;o<e.length;o++){var i=e[o];if(i.isActive){var a=i.collision,s=a.bodyA.parent,c=a.bodyB.parent;if(!(s.isSleeping&&c.isSleeping||s.isStatic||c.isStatic)&&(s.isSleeping||c.isSleeping)){var u=s.isSleeping&&!s.isStatic?s:c,l=u===s?c:s;!u.isStatic&&l.motion>r._motionWakeThreshold*n&&r.set(u,!1)}}}},r.set=function(e,t){var n=e.isSleeping;t?(e.isSleeping=!0,e.sleepCounter=e.sleepThreshold,e.positionImpulse.x=0,e.positionImpulse.y=0,e.positionPrev.x=e.position.x,e.positionPrev.y=e.position.y,e.anglePrev=e.angle,e.speed=0,e.angularSpeed=0,e.motion=0,n||o.trigger(e,"sleepStart")):(e.isSleeping=!1,e.sleepCounter=0,n&&o.trigger(e,"sleepEnd"))}},function(e,t,n){var r={};e.exports=r;var o,i,a,s=n(3),c=n(9);o=[],i={overlap:0,axis:null},a={overlap:0,axis:null},r.create=function(e,t){return{pair:null,collided:!1,bodyA:e,bodyB:t,parentA:e.parent,parentB:t.parent,depth:0,normal:{x:0,y:0},tangent:{x:0,y:0},penetration:{x:0,y:0},supports:[]}},r.collides=function(e,t,n){if(r._overlapAxes(i,e.vertices,t.vertices,e.axes),i.overlap<=0)return null;if(r._overlapAxes(a,t.vertices,e.vertices,t.axes),a.overlap<=0)return null;var o,u,l=n&&n.table[c.id(e,t)];l?o=l.collision:((o=r.create(e,t)).collided=!0,o.bodyA=e.id<t.id?e:t,o.bodyB=e.id<t.id?t:e,o.parentA=o.bodyA.parent,o.parentB=o.bodyB.parent),e=o.bodyA,t=o.bodyB,u=i.overlap<a.overlap?i:a;var f=o.normal,p=o.supports,d=u.axis,y=d.x,h=d.y;y*(t.position.x-e.position.x)+h*(t.position.y-e.position.y)<0?(f.x=y,f.y=h):(f.x=-y,f.y=-h),o.tangent.x=-f.y,o.tangent.y=f.x,o.depth=u.overlap,o.penetration.x=f.x*o.depth,o.penetration.y=f.y*o.depth;var v=r._findSupports(e,t,f,1),m=0;if(s.contains(e.vertices,v[0])&&(p[m++]=v[0]),s.contains(e.vertices,v[1])&&(p[m++]=v[1]),m<2){var b=r._findSupports(t,e,f,-1);s.contains(t.vertices,b[0])&&(p[m++]=b[0]),m<2&&s.contains(t.vertices,b[1])&&(p[m++]=b[1])}return 0===m&&(p[m++]=v[0]),p.length=m,o},r._overlapAxes=function(e,t,n,r){var o,i,a,s,c,u,l=t.length,f=n.length,p=t[0].x,d=t[0].y,y=n[0].x,h=n[0].y,v=r.length,m=Number.MAX_VALUE,b=0;for(c=0;c<v;c++){var g=r[c],w=g.x,x=g.y,_=p*w+d*x,S=y*w+h*x,O=_,T=S;for(u=1;u<l;u+=1)(s=t[u].x*w+t[u].y*x)>O?O=s:s<_&&(_=s);for(u=1;u<f;u+=1)(s=n[u].x*w+n[u].y*x)>T?T=s:s<S&&(S=s);if((o=(i=O-S)<(a=T-_)?i:a)<m&&(m=o,b=c,o<=0))break}e.axis=r[b],e.overlap=m},r._projectToAxis=function(e,t,n){for(var r=t[0].x*n.x+t[0].y*n.y,o=r,i=1;i<t.length;i+=1){var a=t[i].x*n.x+t[i].y*n.y;a>o?o=a:a<r&&(r=a)}e.min=r,e.max=o},r._findSupports=function(e,t,n,r){var i,a,s,c,u,l=t.vertices,f=l.length,p=e.position.x,d=e.position.y,y=n.x*r,h=n.y*r,v=Number.MAX_VALUE;for(u=0;u<f;u+=1)(c=y*(p-(a=l[u]).x)+h*(d-a.y))<v&&(v=c,i=a);return v=y*(p-(s=l[(f+i.index-1)%f]).x)+h*(d-s.y),y*(p-(a=l[(i.index+1)%f]).x)+h*(d-a.y)<v?(o[0]=i,o[1]=a,o):(o[0]=i,o[1]=s,o)}},function(e,t,n){var r={};e.exports=r;var o=n(17);r.create=function(e,t){var n=e.bodyA,o=e.bodyB,i={id:r.id(n,o),bodyA:n,bodyB:o,collision:e,contacts:[],activeContacts:[],separation:0,isActive:!0,confirmedActive:!0,isSensor:n.isSensor||o.isSensor,timeCreated:t,timeUpdated:t,inverseMass:0,friction:0,frictionStatic:0,restitution:0,slop:0};return r.update(i,e,t),i},r.update=function(e,t,n){var r=e.contacts,i=t.supports,a=e.activeContacts,s=t.parentA,c=t.parentB,u=s.vertices.length;e.isActive=!0,e.timeUpdated=n,e.collision=t,e.separation=t.depth,e.inverseMass=s.inverseMass+c.inverseMass,e.friction=s.friction<c.friction?s.friction:c.friction,e.frictionStatic=s.frictionStatic>c.frictionStatic?s.frictionStatic:c.frictionStatic,e.restitution=s.restitution>c.restitution?s.restitution:c.restitution,e.slop=s.slop>c.slop?s.slop:c.slop,t.pair=e,a.length=0;for(var l=0;l<i.length;l++){var f=i[l],p=f.body===s?f.index:u+f.index,d=r[p];d?a.push(d):a.push(r[p]=o.create(f))}},r.setActive=function(e,t,n){t?(e.isActive=!0,e.timeUpdated=n):(e.isActive=!1,e.activeContacts.length=0)},r.id=function(e,t){return e.id<t.id?"A"+e.id+"B"+t.id:"A"+t.id+"B"+e.id}},function(e,t,n){var r={};e.exports=r;var o=n(3),i=n(2),a=n(7),s=n(1),c=n(11),u=n(0);r._warming=.4,r._torqueDampen=1,r._minLength=1e-6,r.create=function(e){var t=e;t.bodyA&&!t.pointA&&(t.pointA={x:0,y:0}),t.bodyB&&!t.pointB&&(t.pointB={x:0,y:0});var n=t.bodyA?i.add(t.bodyA.position,t.pointA):t.pointA,r=t.bodyB?i.add(t.bodyB.position,t.pointB):t.pointB,o=i.magnitude(i.sub(n,r));t.length=void 0!==t.length?t.length:o,t.id=t.id||u.nextId(),t.label=t.label||"Constraint",t.type="constraint",t.stiffness=t.stiffness||(t.length>0?1:.7),t.damping=t.damping||0,t.angularStiffness=t.angularStiffness||0,t.angleA=t.bodyA?t.bodyA.angle:t.angleA,t.angleB=t.bodyB?t.bodyB.angle:t.angleB,t.plugin={};var a={visible:!0,lineWidth:2,strokeStyle:"#ffffff",type:"line",anchors:!0};return 0===t.length&&t.stiffness>.1?(a.type="pin",a.anchors=!1):t.stiffness<.9&&(a.type="spring"),t.render=u.extend(a,t.render),t},r.preSolveAll=function(e){for(var t=0;t<e.length;t+=1){var n=e[t],r=n.constraintImpulse;n.isStatic||0===r.x&&0===r.y&&0===r.angle||(n.position.x+=r.x,n.position.y+=r.y,n.angle+=r.angle)}},r.solveAll=function(e,t){for(var n=0;n<e.length;n+=1){var o=e[n],i=!o.bodyA||o.bodyA&&o.bodyA.isStatic,a=!o.bodyB||o.bodyB&&o.bodyB.isStatic;(i||a)&&r.solve(e[n],t)}for(n=0;n<e.length;n+=1)i=!(o=e[n]).bodyA||o.bodyA&&o.bodyA.isStatic,a=!o.bodyB||o.bodyB&&o.bodyB.isStatic,i||a||r.solve(e[n],t)},r.solve=function(e,t){var n=e.bodyA,o=e.bodyB,a=e.pointA,s=e.pointB;if(n||o){n&&!n.isStatic&&(i.rotate(a,n.angle-e.angleA,a),e.angleA=n.angle),o&&!o.isStatic&&(i.rotate(s,o.angle-e.angleB,s),e.angleB=o.angle);var c=a,u=s;if(n&&(c=i.add(n.position,a)),o&&(u=i.add(o.position,s)),c&&u){var l=i.sub(c,u),f=i.magnitude(l);f<r._minLength&&(f=r._minLength);var p,d,y,h,v,m=(f-e.length)/f,b=e.stiffness<1?e.stiffness*t:e.stiffness,g=i.mult(l,m*b),w=(n?n.inverseMass:0)+(o?o.inverseMass:0),x=w+((n?n.inverseInertia:0)+(o?o.inverseInertia:0));if(e.damping){var _=i.create();y=i.div(l,f),v=i.sub(o&&i.sub(o.position,o.positionPrev)||_,n&&i.sub(n.position,n.positionPrev)||_),h=i.dot(y,v)}n&&!n.isStatic&&(d=n.inverseMass/w,n.constraintImpulse.x-=g.x*d,n.constraintImpulse.y-=g.y*d,n.position.x-=g.x*d,n.position.y-=g.y*d,e.damping&&(n.positionPrev.x-=e.damping*y.x*h*d,n.positionPrev.y-=e.damping*y.y*h*d),p=i.cross(a,g)/x*r._torqueDampen*n.inverseInertia*(1-e.angularStiffness),n.constraintImpulse.angle-=p,n.angle-=p),o&&!o.isStatic&&(d=o.inverseMass/w,o.constraintImpulse.x+=g.x*d,o.constraintImpulse.y+=g.y*d,o.position.x+=g.x*d,o.position.y+=g.y*d,e.damping&&(o.positionPrev.x+=e.damping*y.x*h*d,o.positionPrev.y+=e.damping*y.y*h*d),p=i.cross(s,g)/x*r._torqueDampen*o.inverseInertia*(1-e.angularStiffness),o.constraintImpulse.angle+=p,o.angle+=p)}}},r.postSolveAll=function(e){for(var t=0;t<e.length;t++){var n=e[t],u=n.constraintImpulse;if(!(n.isStatic||0===u.x&&0===u.y&&0===u.angle)){a.set(n,!1);for(var l=0;l<n.parts.length;l++){var f=n.parts[l];o.translate(f.vertices,u),l>0&&(f.position.x+=u.x,f.position.y+=u.y),0!==u.angle&&(o.rotate(f.vertices,u.angle,n.position),c.rotate(f.axes,u.angle),l>0&&i.rotateAbout(f.position,u.angle,n.position,f.position)),s.update(f.bounds,f.vertices,n.velocity)}u.angle*=r._warming,u.x*=r._warming,u.y*=r._warming}}},r.pointAWorld=function(e){return{x:(e.bodyA?e.bodyA.position.x:0)+e.pointA.x,y:(e.bodyA?e.bodyA.position.y:0)+e.pointA.y}},r.pointBWorld=function(e){return{x:(e.bodyB?e.bodyB.position.x:0)+e.pointB.x,y:(e.bodyB?e.bodyB.position.y:0)+e.pointB.y}}},function(e,t,n){var r={};e.exports=r;var o=n(2),i=n(0);r.fromVertices=function(e){for(var t={},n=0;n<e.length;n++){var r=(n+1)%e.length,a=o.normalise({x:e[r].y-e[n].y,y:e[n].x-e[r].x}),s=0===a.y?1/0:a.x/a.y;t[s=s.toFixed(3).toString()]=a}return i.values(t)},r.rotate=function(e,t){if(0!==t)for(var n=Math.cos(t),r=Math.sin(t),o=0;o<e.length;o++){var i,a=e[o];i=a.x*n-a.y*r,a.y=a.x*r+a.y*n,a.x=i}}},function(e,t,n){var r={};e.exports=r;var o=n(3),i=n(0),a=n(6),s=n(1),c=n(2);r.rectangle=function(e,t,n,r,s){s=s||{};var c={label:"Rectangle Body",position:{x:e,y:t},vertices:o.fromPath("L 0 0 L "+n+" 0 L "+n+" "+r+" L 0 "+r)};if(s.chamfer){var u=s.chamfer;c.vertices=o.chamfer(c.vertices,u.radius,u.quality,u.qualityMin,u.qualityMax),delete s.chamfer}return a.create(i.extend({},c,s))},r.trapezoid=function(e,t,n,r,s,c){c=c||{};var u,l=n*(s*=.5),f=l+(1-2*s)*n,p=f+l;u=s<.5?"L 0 0 L "+l+" "+-r+" L "+f+" "+-r+" L "+p+" 0":"L 0 0 L "+f+" "+-r+" L "+p+" 0";var d={label:"Trapezoid Body",position:{x:e,y:t},vertices:o.fromPath(u)};if(c.chamfer){var y=c.chamfer;d.vertices=o.chamfer(d.vertices,y.radius,y.quality,y.qualityMin,y.qualityMax),delete c.chamfer}return a.create(i.extend({},d,c))},r.circle=function(e,t,n,o,a){o=o||{};var s={label:"Circle Body",circleRadius:n};a=a||25;var c=Math.ceil(Math.max(10,Math.min(a,n)));return c%2==1&&(c+=1),r.polygon(e,t,c,n,i.extend({},s,o))},r.polygon=function(e,t,n,s,c){if(c=c||{},n<3)return r.circle(e,t,s,c);for(var u=2*Math.PI/n,l="",f=.5*u,p=0;p<n;p+=1){var d=f+p*u,y=Math.cos(d)*s,h=Math.sin(d)*s;l+="L "+y.toFixed(3)+" "+h.toFixed(3)+" "}var v={label:"Polygon Body",position:{x:e,y:t},vertices:o.fromPath(l)};if(c.chamfer){var m=c.chamfer;v.vertices=o.chamfer(v.vertices,m.radius,m.quality,m.qualityMin,m.qualityMax),delete c.chamfer}return a.create(i.extend({},v,c))},r.fromVertices=function(e,t,n,r,u,l,f,p){var d,y,h,v,m,b,g,w,x,_,S=i.getDecomp();for(d=Boolean(S&&S.quickDecomp),r=r||{},h=[],u=void 0!==u&&u,l=void 0!==l?l:.01,f=void 0!==f?f:10,p=void 0!==p?p:.01,i.isArray(n[0])||(n=[n]),x=0;x<n.length;x+=1)if(m=n[x],!(v=o.isConvex(m))&&!d&&i.warnOnce("Bodies.fromVertices: Install the 'poly-decomp' library and use Common.setDecomp or provide 'decomp' as a global to decompose concave vertices."),v||!d)m=v?o.clockwiseSort(m):o.hull(m),h.push({position:{x:e,y:t},vertices:m});else{var O=m.map((function(e){return[e.x,e.y]}));S.makeCCW(O),!1!==l&&S.removeCollinearPoints(O,l),!1!==p&&S.removeDuplicatePoints&&S.removeDuplicatePoints(O,p);var T=S.quickDecomp(O);for(b=0;b<T.length;b++){var k=T[b].map((function(e){return{x:e[0],y:e[1]}}));f>0&&o.area(k)<f||h.push({position:o.centre(k),vertices:k})}}for(b=0;b<h.length;b++)h[b]=a.create(i.extend(h[b],r));if(u)for(b=0;b<h.length;b++){var P=h[b];for(g=b+1;g<h.length;g++){var C=h[g];if(s.overlaps(P.bounds,C.bounds)){var E=P.vertices,A=C.vertices;for(w=0;w<P.vertices.length;w++)for(_=0;_<C.vertices.length;_++){var I=c.magnitudeSquared(c.sub(E[(w+1)%E.length],A[_])),j=c.magnitudeSquared(c.sub(E[w],A[(_+1)%A.length]));I<5&&j<5&&(E[w].isInternal=!0,A[_].isInternal=!0)}}}}return h.length>1?(y=a.create(i.extend({parts:h.slice(0)},r)),a.setPosition(y,{x:e,y:t}),y):h[0]}},function(e,t,n){var r={};e.exports=r;var o=n(0);r.create=function(e){var t={};return e||o.log("Mouse.create: element was undefined, defaulting to document.body","warn"),t.element=e||document.body,t.absolute={x:0,y:0},t.position={x:0,y:0},t.mousedownPosition={x:0,y:0},t.mouseupPosition={x:0,y:0},t.offset={x:0,y:0},t.scale={x:1,y:1},t.wheelDelta=0,t.button=-1,t.pixelRatio=parseInt(t.element.getAttribute("data-pixel-ratio"),10)||1,t.sourceEvents={mousemove:null,mousedown:null,mouseup:null,mousewheel:null},t.mousemove=function(e){var n=r._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&(t.button=0,e.preventDefault()),t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.sourceEvents.mousemove=e},t.mousedown=function(e){var n=r._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches?(t.button=0,e.preventDefault()):t.button=e.button,t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mousedownPosition.x=t.position.x,t.mousedownPosition.y=t.position.y,t.sourceEvents.mousedown=e},t.mouseup=function(e){var n=r._getRelativeMousePosition(e,t.element,t.pixelRatio);e.changedTouches&&e.preventDefault(),t.button=-1,t.absolute.x=n.x,t.absolute.y=n.y,t.position.x=t.absolute.x*t.scale.x+t.offset.x,t.position.y=t.absolute.y*t.scale.y+t.offset.y,t.mouseupPosition.x=t.position.x,t.mouseupPosition.y=t.position.y,t.sourceEvents.mouseup=e},t.mousewheel=function(e){t.wheelDelta=Math.max(-1,Math.min(1,e.wheelDelta||-e.detail)),e.preventDefault()},r.setElement(t,t.element),t},r.setElement=function(e,t){e.element=t,t.addEventListener("mousemove",e.mousemove),t.addEventListener("mousedown",e.mousedown),t.addEventListener("mouseup",e.mouseup),t.addEventListener("mousewheel",e.mousewheel),t.addEventListener("DOMMouseScroll",e.mousewheel),t.addEventListener("touchmove",e.mousemove),t.addEventListener("touchstart",e.mousedown),t.addEventListener("touchend",e.mouseup)},r.clearSourceEvents=function(e){e.sourceEvents.mousemove=null,e.sourceEvents.mousedown=null,e.sourceEvents.mouseup=null,e.sourceEvents.mousewheel=null,e.wheelDelta=0},r.setOffset=function(e,t){e.offset.x=t.x,e.offset.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},r.setScale=function(e,t){e.scale.x=t.x,e.scale.y=t.y,e.position.x=e.absolute.x*e.scale.x+e.offset.x,e.position.y=e.absolute.y*e.scale.y+e.offset.y},r._getRelativeMousePosition=function(e,t,n){var r,o,i=t.getBoundingClientRect(),a=document.documentElement||document.body.parentNode||document.body,s=void 0!==window.pageXOffset?window.pageXOffset:a.scrollLeft,c=void 0!==window.pageYOffset?window.pageYOffset:a.scrollTop,u=e.changedTouches;return u?(r=u[0].pageX-i.left-s,o=u[0].pageY-i.top-c):(r=e.pageX-i.left-s,o=e.pageY-i.top-c),{x:r/(t.clientWidth/(t.width||t.clientWidth)*n),y:o/(t.clientHeight/(t.height||t.clientHeight)*n)}}},function(e,t,n){var r={};e.exports=r;var o=n(0),i=n(8);r.create=function(e){return o.extend({bodies:[],pairs:null},e)},r.setBodies=function(e,t){e.bodies=t.slice(0)},r.clear=function(e){e.bodies=[]},r.collisions=function(e){var t,n,o=[],a=e.pairs,s=e.bodies,c=s.length,u=r.canCollide,l=i.collides;for(s.sort(r._compareBoundsX),t=0;t<c;t++){var f=s[t],p=f.bounds,d=f.bounds.max.x,y=f.bounds.max.y,h=f.bounds.min.y,v=f.isStatic||f.isSleeping,m=f.parts.length,b=1===m;for(n=t+1;n<c;n++){var g=s[n];if((P=g.bounds).min.x>d)break;if(!(y<P.min.y||h>P.max.y)&&(!v||!g.isStatic&&!g.isSleeping)&&u(f.collisionFilter,g.collisionFilter)){var w=g.parts.length;if(b&&1===w)(T=l(f,g,a))&&o.push(T);else for(var x=w>1?1:0,_=m>1?1:0;_<m;_++)for(var S=f.parts[_],O=(p=S.bounds,x);O<w;O++){var T,k=g.parts[O],P=k.bounds;p.min.x>P.max.x||p.max.x<P.min.x||p.max.y<P.min.y||p.min.y>P.max.y||(T=l(S,k,a))&&o.push(T)}}}}return o},r.canCollide=function(e,t){return e.group===t.group&&0!==e.group?e.group>0:0!=(e.mask&t.category)&&0!=(t.mask&e.category)},r._compareBoundsX=function(e,t){return e.bounds.min.x-t.bounds.min.x}},function(e,t,n){var r={};e.exports=r;var o=n(0);r._registry={},r.register=function(e){if(r.isPlugin(e)||o.warn("Plugin.register:",r.toString(e),"does not implement all required fields."),e.name in r._registry){var t=r._registry[e.name],n=r.versionParse(e.version).number,i=r.versionParse(t.version).number;n>i?(o.warn("Plugin.register:",r.toString(t),"was upgraded to",r.toString(e)),r._registry[e.name]=e):n<i?o.warn("Plugin.register:",r.toString(t),"can not be downgraded to",r.toString(e)):e!==t&&o.warn("Plugin.register:",r.toString(e),"is already registered to different plugin object")}else r._registry[e.name]=e;return e},r.resolve=function(e){return r._registry[r.dependencyParse(e).name]},r.toString=function(e){return"string"==typeof e?e:(e.name||"anonymous")+"@"+(e.version||e.range||"0.0.0")},r.isPlugin=function(e){return e&&e.name&&e.version&&e.install},r.isUsed=function(e,t){return e.used.indexOf(t)>-1},r.isFor=function(e,t){var n=e.for&&r.dependencyParse(e.for);return!e.for||t.name===n.name&&r.versionSatisfies(t.version,n.range)},r.use=function(e,t){if(e.uses=(e.uses||[]).concat(t||[]),0!==e.uses.length){for(var n=r.dependencies(e),i=o.topologicalSort(n),a=[],s=0;s<i.length;s+=1)if(i[s]!==e.name){var c=r.resolve(i[s]);c?r.isUsed(e,c.name)||(r.isFor(c,e)||(o.warn("Plugin.use:",r.toString(c),"is for",c.for,"but installed on",r.toString(e)+"."),c._warned=!0),c.install?c.install(e):(o.warn("Plugin.use:",r.toString(c),"does not specify an install function."),c._warned=!0),c._warned?(a.push("ðŸ”¶ "+r.toString(c)),delete c._warned):a.push("âœ… "+r.toString(c)),e.used.push(c.name)):a.push("âŒ "+i[s])}a.length>0&&o.info(a.join("  "))}else o.warn("Plugin.use:",r.toString(e),"does not specify any dependencies to install.")},r.dependencies=function(e,t){var n=r.dependencyParse(e),i=n.name;if(!(i in(t=t||{}))){e=r.resolve(e)||e,t[i]=o.map(e.uses||[],(function(t){r.isPlugin(t)&&r.register(t);var i=r.dependencyParse(t),a=r.resolve(t);return a&&!r.versionSatisfies(a.version,i.range)?(o.warn("Plugin.dependencies:",r.toString(a),"does not satisfy",r.toString(i),"used by",r.toString(n)+"."),a._warned=!0,e._warned=!0):a||(o.warn("Plugin.dependencies:",r.toString(t),"used by",r.toString(n),"could not be resolved."),e._warned=!0),i.name}));for(var a=0;a<t[i].length;a+=1)r.dependencies(t[i][a],t);return t}},r.dependencyParse=function(e){return o.isString(e)?(/^[\w-]+(@(\*|[\^~]?\d+\.\d+\.\d+(-[0-9A-Za-z-+]+)?))?$/.test(e)||o.warn("Plugin.dependencyParse:",e,"is not a valid dependency string."),{name:e.split("@")[0],range:e.split("@")[1]||"*"}):{name:e.name,range:e.range||e.version}},r.versionParse=function(e){var t=/^(\*)|(\^|~|>=|>)?\s*((\d+)\.(\d+)\.(\d+))(-[0-9A-Za-z-+]+)?$/;t.test(e)||o.warn("Plugin.versionParse:",e,"is not a valid version or range.");var n=t.exec(e),r=Number(n[4]),i=Number(n[5]),a=Number(n[6]);return{isRange:Boolean(n[1]||n[2]),version:n[3],range:e,operator:n[1]||n[2]||"",major:r,minor:i,patch:a,parts:[r,i,a],prerelease:n[7],number:1e8*r+1e4*i+a}},r.versionSatisfies=function(e,t){t=t||"*";var n=r.versionParse(t),o=r.versionParse(e);if(n.isRange){if("*"===n.operator||"*"===e)return!0;if(">"===n.operator)return o.number>n.number;if(">="===n.operator)return o.number>=n.number;if("~"===n.operator)return o.major===n.major&&o.minor===n.minor&&o.patch>=n.patch;if("^"===n.operator)return n.major>0?o.major===n.major&&o.number>=n.number:n.minor>0?o.minor===n.minor&&o.patch>=n.patch:o.patch===n.patch}return e===t||"*"===e}},function(e,t,n){var r={};e.exports=r;var o=n(0),i=n(5),a=n(1),s=n(4),c=n(2),u=n(13);!function(){var e,t;"undefined"!=typeof window&&(e=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout((function(){e(o.now())}),1e3/60)},t=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),r._goodFps=30,r._goodDelta=1e3/60,r.create=function(e){var t={controller:r,engine:null,element:null,canvas:null,mouse:null,frameRequestId:null,timing:{historySize:60,delta:0,deltaHistory:[],lastTime:0,lastTimestamp:0,lastElapsed:0,timestampElapsed:0,timestampElapsedHistory:[],engineDeltaHistory:[],engineElapsedHistory:[],elapsedHistory:[]},options:{width:800,height:600,pixelRatio:1,background:"#14151f",wireframeBackground:"#14151f",hasBounds:!!e.bounds,enabled:!0,wireframes:!0,showSleeping:!0,showDebug:!1,showStats:!1,showPerformance:!1,showBounds:!1,showVelocity:!1,showCollisions:!1,showSeparations:!1,showAxes:!1,showPositions:!1,showAngleIndicator:!1,showIds:!1,showVertexNumbers:!1,showConvexHulls:!1,showInternalEdges:!1,showMousePosition:!1}},n=o.extend(t,e);return n.canvas&&(n.canvas.width=n.options.width||n.canvas.width,n.canvas.height=n.options.height||n.canvas.height),n.mouse=e.mouse,n.engine=e.engine,n.canvas=n.canvas||f(n.options.width,n.options.height),n.context=n.canvas.getContext("2d"),n.textures={},n.bounds=n.bounds||{min:{x:0,y:0},max:{x:n.canvas.width,y:n.canvas.height}},n.options.showBroadphase=!1,1!==n.options.pixelRatio&&r.setPixelRatio(n,n.options.pixelRatio),o.isElement(n.element)?n.element.appendChild(n.canvas):n.canvas.parentNode||o.log("Render.create: options.element was undefined, render.canvas was created but not appended","warn"),n},r.run=function(t){!function o(i){t.frameRequestId=e(o),n(t,i),r.world(t,i),(t.options.showStats||t.options.showDebug)&&r.stats(t,t.context,i),(t.options.showPerformance||t.options.showDebug)&&r.performance(t,t.context,i)}()},r.stop=function(e){t(e.frameRequestId)},r.setPixelRatio=function(e,t){var n=e.options,r=e.canvas;"auto"===t&&(t=p(r)),n.pixelRatio=t,r.setAttribute("data-pixel-ratio",t),r.width=n.width*t,r.height=n.height*t,r.style.width=n.width+"px",r.style.height=n.height+"px"},r.lookAt=function(e,t,n,r){r=void 0===r||r,t=o.isArray(t)?t:[t],n=n||{x:0,y:0};for(var i={min:{x:1/0,y:1/0},max:{x:-1/0,y:-1/0}},a=0;a<t.length;a+=1){var s=t[a],c=s.bounds?s.bounds.min:s.min||s.position||s,l=s.bounds?s.bounds.max:s.max||s.position||s;c&&l&&(c.x<i.min.x&&(i.min.x=c.x),l.x>i.max.x&&(i.max.x=l.x),c.y<i.min.y&&(i.min.y=c.y),l.y>i.max.y&&(i.max.y=l.y))}var f=i.max.x-i.min.x+2*n.x,p=i.max.y-i.min.y+2*n.y,d=e.canvas.height,y=e.canvas.width/d,h=f/p,v=1,m=1;h>y?m=h/y:v=y/h,e.options.hasBounds=!0,e.bounds.min.x=i.min.x,e.bounds.max.x=i.min.x+f*v,e.bounds.min.y=i.min.y,e.bounds.max.y=i.min.y+p*m,r&&(e.bounds.min.x+=.5*f-f*v*.5,e.bounds.max.x+=.5*f-f*v*.5,e.bounds.min.y+=.5*p-p*m*.5,e.bounds.max.y+=.5*p-p*m*.5),e.bounds.min.x-=n.x,e.bounds.max.x-=n.x,e.bounds.min.y-=n.y,e.bounds.max.y-=n.y,e.mouse&&(u.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.canvas.width,y:(e.bounds.max.y-e.bounds.min.y)/e.canvas.height}),u.setOffset(e.mouse,e.bounds.min))},r.startViewTransform=function(e){var t=e.bounds.max.x-e.bounds.min.x,n=e.bounds.max.y-e.bounds.min.y,r=t/e.options.width,o=n/e.options.height;e.context.setTransform(e.options.pixelRatio/r,0,0,e.options.pixelRatio/o,0,0),e.context.translate(-e.bounds.min.x,-e.bounds.min.y)},r.endViewTransform=function(e){e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0)},r.world=function(e,t){var n,l=o.now(),f=e.engine,p=f.world,d=e.canvas,h=e.context,v=e.options,m=e.timing,b=i.allBodies(p),g=i.allConstraints(p),w=v.wireframes?v.wireframeBackground:v.background,x=[],_=[],S={timestamp:f.timing.timestamp};if(s.trigger(e,"beforeRender",S),e.currentBackground!==w&&y(e,w),h.globalCompositeOperation="source-in",h.fillStyle="transparent",h.fillRect(0,0,d.width,d.height),h.globalCompositeOperation="source-over",v.hasBounds){for(n=0;n<b.length;n++){var O=b[n];a.overlaps(O.bounds,e.bounds)&&x.push(O)}for(n=0;n<g.length;n++){var T=g[n],k=T.bodyA,P=T.bodyB,C=T.pointA,E=T.pointB;k&&(C=c.add(k.position,T.pointA)),P&&(E=c.add(P.position,T.pointB)),C&&E&&(a.contains(e.bounds,C)||a.contains(e.bounds,E))&&_.push(T)}r.startViewTransform(e),e.mouse&&(u.setScale(e.mouse,{x:(e.bounds.max.x-e.bounds.min.x)/e.options.width,y:(e.bounds.max.y-e.bounds.min.y)/e.options.height}),u.setOffset(e.mouse,e.bounds.min))}else _=g,x=b,1!==e.options.pixelRatio&&e.context.setTransform(e.options.pixelRatio,0,0,e.options.pixelRatio,0,0);!v.wireframes||f.enableSleeping&&v.showSleeping?r.bodies(e,x,h):(v.showConvexHulls&&r.bodyConvexHulls(e,x,h),r.bodyWireframes(e,x,h)),v.showBounds&&r.bodyBounds(e,x,h),(v.showAxes||v.showAngleIndicator)&&r.bodyAxes(e,x,h),v.showPositions&&r.bodyPositions(e,x,h),v.showVelocity&&r.bodyVelocity(e,x,h),v.showIds&&r.bodyIds(e,x,h),v.showSeparations&&r.separations(e,f.pairs.list,h),v.showCollisions&&r.collisions(e,f.pairs.list,h),v.showVertexNumbers&&r.vertexNumbers(e,x,h),v.showMousePosition&&r.mousePosition(e,e.mouse,h),r.constraints(_,h),v.hasBounds&&r.endViewTransform(e),s.trigger(e,"afterRender",S),m.lastElapsed=o.now()-l},r.stats=function(e,t,n){for(var r=e.engine,o=r.world,a=i.allBodies(o),s=0,c=0,u=0;u<a.length;u+=1)s+=a[u].parts.length;var l={Part:s,Body:a.length,Cons:i.allConstraints(o).length,Comp:i.allComposites(o).length,Pair:r.pairs.list.length};for(var f in t.fillStyle="#0e0f19",t.fillRect(c,0,302.5,44),t.font="12px Arial",t.textBaseline="top",t.textAlign="right",l){var p=l[f];t.fillStyle="#aaa",t.fillText(f,c+55,8),t.fillStyle="#eee",t.fillText(p,c+55,26),c+=55}},r.performance=function(e,t){var n=e.engine,o=e.timing,i=o.deltaHistory,a=o.elapsedHistory,s=o.timestampElapsedHistory,c=o.engineDeltaHistory,u=o.engineElapsedHistory,f=n.timing.lastDelta,p=l(i),d=l(a),y=l(c),h=l(u),v=l(s)/p||0,m=1e3/p||0;t.fillStyle="#0e0f19",t.fillRect(0,50,370,34),r.status(t,10,69,60,4,i.length,Math.round(m)+" fps",m/r._goodFps,(function(e){return i[e]/p-1})),r.status(t,82,69,60,4,c.length,f.toFixed(2)+" dt",r._goodDelta/f,(function(e){return c[e]/y-1})),r.status(t,154,69,60,4,u.length,h.toFixed(2)+" ut",1-h/r._goodFps,(function(e){return u[e]/h-1})),r.status(t,226,69,60,4,a.length,d.toFixed(2)+" rt",1-d/r._goodFps,(function(e){return a[e]/d-1})),r.status(t,298,69,60,4,s.length,v.toFixed(2)+" x",v*v*v,(function(e){return(s[e]/i[e]/v||0)-1}))},r.status=function(e,t,n,r,i,a,s,c,u){e.strokeStyle="#888",e.fillStyle="#444",e.lineWidth=1,e.fillRect(t,n+7,r,1),e.beginPath(),e.moveTo(t,n+7-i*o.clamp(.4*u(0),-2,2));for(var l=0;l<r;l+=1)e.lineTo(t+l,n+7-(l<a?i*o.clamp(.4*u(l),-2,2):0));e.stroke(),e.fillStyle="hsl("+o.clamp(25+95*c,0,120)+",100%,60%)",e.fillRect(t,n-7,4,4),e.font="12px Arial",e.textBaseline="middle",e.textAlign="right",e.fillStyle="#eee",e.fillText(s,t+r,n-5)},r.constraints=function(e,t){for(var n=t,r=0;r<e.length;r++){var i=e[r];if(i.render.visible&&i.pointA&&i.pointB){var a,s,u=i.bodyA,l=i.bodyB;if(a=u?c.add(u.position,i.pointA):i.pointA,"pin"===i.render.type)n.beginPath(),n.arc(a.x,a.y,3,0,2*Math.PI),n.closePath();else{if(s=l?c.add(l.position,i.pointB):i.pointB,n.beginPath(),n.moveTo(a.x,a.y),"spring"===i.render.type)for(var f,p=c.sub(s,a),d=c.perp(c.normalise(p)),y=Math.ceil(o.clamp(i.length/5,12,20)),h=1;h<y;h+=1)f=h%2==0?1:-1,n.lineTo(a.x+p.x*(h/y)+d.x*f*4,a.y+p.y*(h/y)+d.y*f*4);n.lineTo(s.x,s.y)}i.render.lineWidth&&(n.lineWidth=i.render.lineWidth,n.strokeStyle=i.render.strokeStyle,n.stroke()),i.render.anchors&&(n.fillStyle=i.render.strokeStyle,n.beginPath(),n.arc(a.x,a.y,3,0,2*Math.PI),n.arc(s.x,s.y,3,0,2*Math.PI),n.closePath(),n.fill())}}},r.bodies=function(e,t,n){var r,o,i,a,s=n,c=(e.engine,e.options),u=c.showInternalEdges||!c.wireframes;for(i=0;i<t.length;i++)if((r=t[i]).render.visible)for(a=r.parts.length>1?1:0;a<r.parts.length;a++)if((o=r.parts[a]).render.visible){if(c.showSleeping&&r.isSleeping?s.globalAlpha=.5*o.render.opacity:1!==o.render.opacity&&(s.globalAlpha=o.render.opacity),o.render.sprite&&o.render.sprite.texture&&!c.wireframes){var l=o.render.sprite,f=d(e,l.texture);s.translate(o.position.x,o.position.y),s.rotate(o.angle),s.drawImage(f,f.width*-l.xOffset*l.xScale,f.height*-l.yOffset*l.yScale,f.width*l.xScale,f.height*l.yScale),s.rotate(-o.angle),s.translate(-o.position.x,-o.position.y)}else{if(o.circleRadius)s.beginPath(),s.arc(o.position.x,o.position.y,o.circleRadius,0,2*Math.PI);else{s.beginPath(),s.moveTo(o.vertices[0].x,o.vertices[0].y);for(var p=1;p<o.vertices.length;p++)!o.vertices[p-1].isInternal||u?s.lineTo(o.vertices[p].x,o.vertices[p].y):s.moveTo(o.vertices[p].x,o.vertices[p].y),o.vertices[p].isInternal&&!u&&s.moveTo(o.vertices[(p+1)%o.vertices.length].x,o.vertices[(p+1)%o.vertices.length].y);s.lineTo(o.vertices[0].x,o.vertices[0].y),s.closePath()}c.wireframes?(s.lineWidth=1,s.strokeStyle="#bbb",s.stroke()):(s.fillStyle=o.render.fillStyle,o.render.lineWidth&&(s.lineWidth=o.render.lineWidth,s.strokeStyle=o.render.strokeStyle,s.stroke()),s.fill())}s.globalAlpha=1}},r.bodyWireframes=function(e,t,n){var r,o,i,a,s,c=n,u=e.options.showInternalEdges;for(c.beginPath(),i=0;i<t.length;i++)if((r=t[i]).render.visible)for(s=r.parts.length>1?1:0;s<r.parts.length;s++){for(o=r.parts[s],c.moveTo(o.vertices[0].x,o.vertices[0].y),a=1;a<o.vertices.length;a++)!o.vertices[a-1].isInternal||u?c.lineTo(o.vertices[a].x,o.vertices[a].y):c.moveTo(o.vertices[a].x,o.vertices[a].y),o.vertices[a].isInternal&&!u&&c.moveTo(o.vertices[(a+1)%o.vertices.length].x,o.vertices[(a+1)%o.vertices.length].y);c.lineTo(o.vertices[0].x,o.vertices[0].y)}c.lineWidth=1,c.strokeStyle="#bbb",c.stroke()},r.bodyConvexHulls=function(e,t,n){var r,o,i,a=n;for(a.beginPath(),o=0;o<t.length;o++)if((r=t[o]).render.visible&&1!==r.parts.length){for(a.moveTo(r.vertices[0].x,r.vertices[0].y),i=1;i<r.vertices.length;i++)a.lineTo(r.vertices[i].x,r.vertices[i].y);a.lineTo(r.vertices[0].x,r.vertices[0].y)}a.lineWidth=1,a.strokeStyle="rgba(255,255,255,0.2)",a.stroke()},r.vertexNumbers=function(e,t,n){var r,o,i,a=n;for(r=0;r<t.length;r++){var s=t[r].parts;for(i=s.length>1?1:0;i<s.length;i++){var c=s[i];for(o=0;o<c.vertices.length;o++)a.fillStyle="rgba(255,255,255,0.2)",a.fillText(r+"_"+o,c.position.x+.8*(c.vertices[o].x-c.position.x),c.position.y+.8*(c.vertices[o].y-c.position.y))}}},r.mousePosition=function(e,t,n){var r=n;r.fillStyle="rgba(255,255,255,0.8)",r.fillText(t.position.x+"  "+t.position.y,t.position.x+5,t.position.y-5)},r.bodyBounds=function(e,t,n){var r=n,o=(e.engine,e.options);r.beginPath();for(var i=0;i<t.length;i++)if(t[i].render.visible)for(var a=t[i].parts,s=a.length>1?1:0;s<a.length;s++){var c=a[s];r.rect(c.bounds.min.x,c.bounds.min.y,c.bounds.max.x-c.bounds.min.x,c.bounds.max.y-c.bounds.min.y)}o.wireframes?r.strokeStyle="rgba(255,255,255,0.08)":r.strokeStyle="rgba(0,0,0,0.1)",r.lineWidth=1,r.stroke()},r.bodyAxes=function(e,t,n){var r,o,i,a,s=n,c=(e.engine,e.options);for(s.beginPath(),o=0;o<t.length;o++){var u=t[o],l=u.parts;if(u.render.visible)if(c.showAxes)for(i=l.length>1?1:0;i<l.length;i++)for(r=l[i],a=0;a<r.axes.length;a++){var f=r.axes[a];s.moveTo(r.position.x,r.position.y),s.lineTo(r.position.x+20*f.x,r.position.y+20*f.y)}else for(i=l.length>1?1:0;i<l.length;i++)for(r=l[i],a=0;a<r.axes.length;a++)s.moveTo(r.position.x,r.position.y),s.lineTo((r.vertices[0].x+r.vertices[r.vertices.length-1].x)/2,(r.vertices[0].y+r.vertices[r.vertices.length-1].y)/2)}c.wireframes?(s.strokeStyle="indianred",s.lineWidth=1):(s.strokeStyle="rgba(255, 255, 255, 0.4)",s.globalCompositeOperation="overlay",s.lineWidth=2),s.stroke(),s.globalCompositeOperation="source-over"},r.bodyPositions=function(e,t,n){var r,o,i,a,s=n,c=(e.engine,e.options);for(s.beginPath(),i=0;i<t.length;i++)if((r=t[i]).render.visible)for(a=0;a<r.parts.length;a++)o=r.parts[a],s.arc(o.position.x,o.position.y,3,0,2*Math.PI,!1),s.closePath();for(c.wireframes?s.fillStyle="indianred":s.fillStyle="rgba(0,0,0,0.5)",s.fill(),s.beginPath(),i=0;i<t.length;i++)(r=t[i]).render.visible&&(s.arc(r.positionPrev.x,r.positionPrev.y,2,0,2*Math.PI,!1),s.closePath());s.fillStyle="rgba(255,165,0,0.8)",s.fill()},r.bodyVelocity=function(e,t,n){var r=n;r.beginPath();for(var o=0;o<t.length;o++){var i=t[o];i.render.visible&&(r.moveTo(i.position.x,i.position.y),r.lineTo(i.position.x+2*(i.position.x-i.positionPrev.x),i.position.y+2*(i.position.y-i.positionPrev.y)))}r.lineWidth=3,r.strokeStyle="cornflowerblue",r.stroke()},r.bodyIds=function(e,t,n){var r,o,i=n;for(r=0;r<t.length;r++)if(t[r].render.visible){var a=t[r].parts;for(o=a.length>1?1:0;o<a.length;o++){var s=a[o];i.font="12px Arial",i.fillStyle="rgba(255,255,255,0.5)",i.fillText(s.id,s.position.x+10,s.position.y-10)}}},r.collisions=function(e,t,n){var r,o,i,a,s=n,c=e.options;for(s.beginPath(),i=0;i<t.length;i++)if((r=t[i]).isActive)for(o=r.collision,a=0;a<r.activeContacts.length;a++){var u=r.activeContacts[a].vertex;s.rect(u.x-1.5,u.y-1.5,3.5,3.5)}for(c.wireframes?s.fillStyle="rgba(255,255,255,0.7)":s.fillStyle="orange",s.fill(),s.beginPath(),i=0;i<t.length;i++)if((r=t[i]).isActive&&(o=r.collision,r.activeContacts.length>0)){var l=r.activeContacts[0].vertex.x,f=r.activeContacts[0].vertex.y;2===r.activeContacts.length&&(l=(r.activeContacts[0].vertex.x+r.activeContacts[1].vertex.x)/2,f=(r.activeContacts[0].vertex.y+r.activeContacts[1].vertex.y)/2),o.bodyB===o.supports[0].body||!0===o.bodyA.isStatic?s.moveTo(l-8*o.normal.x,f-8*o.normal.y):s.moveTo(l+8*o.normal.x,f+8*o.normal.y),s.lineTo(l,f)}c.wireframes?s.strokeStyle="rgba(255,165,0,0.7)":s.strokeStyle="orange",s.lineWidth=1,s.stroke()},r.separations=function(e,t,n){var r,o,i,a,s,c=n,u=e.options;for(c.beginPath(),s=0;s<t.length;s++)if((r=t[s]).isActive){i=(o=r.collision).bodyA;var l=1;(a=o.bodyB).isStatic||i.isStatic||(l=.5),a.isStatic&&(l=0),c.moveTo(a.position.x,a.position.y),c.lineTo(a.position.x-o.penetration.x*l,a.position.y-o.penetration.y*l),l=1,a.isStatic||i.isStatic||(l=.5),i.isStatic&&(l=0),c.moveTo(i.position.x,i.position.y),c.lineTo(i.position.x+o.penetration.x*l,i.position.y+o.penetration.y*l)}u.wireframes?c.strokeStyle="rgba(255,165,0,0.5)":c.strokeStyle="orange",c.stroke()},r.inspector=function(e,t){e.engine;var n,r=e.selected,o=e.render,i=o.options;if(i.hasBounds){var a=o.bounds.max.x-o.bounds.min.x,s=o.bounds.max.y-o.bounds.min.y,c=a/o.options.width,u=s/o.options.height;t.scale(1/c,1/u),t.translate(-o.bounds.min.x,-o.bounds.min.y)}for(var l=0;l<r.length;l++){var f=r[l].data;switch(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.9)",t.setLineDash([1,2]),f.type){case"body":n=f.bounds,t.beginPath(),t.rect(Math.floor(n.min.x-3),Math.floor(n.min.y-3),Math.floor(n.max.x-n.min.x+6),Math.floor(n.max.y-n.min.y+6)),t.closePath(),t.stroke();break;case"constraint":var p=f.pointA;f.bodyA&&(p=f.pointB),t.beginPath(),t.arc(p.x,p.y,10,0,2*Math.PI),t.closePath(),t.stroke()}t.setLineDash([]),t.translate(-.5,-.5)}null!==e.selectStart&&(t.translate(.5,.5),t.lineWidth=1,t.strokeStyle="rgba(255,165,0,0.6)",t.fillStyle="rgba(255,165,0,0.1)",n=e.selectBounds,t.beginPath(),t.rect(Math.floor(n.min.x),Math.floor(n.min.y),Math.floor(n.max.x-n.min.x),Math.floor(n.max.y-n.min.y)),t.closePath(),t.stroke(),t.fill(),t.translate(-.5,-.5)),i.hasBounds&&t.setTransform(1,0,0,1,0,0)};var n=function(e,t){var n=e.engine,o=e.timing,i=o.historySize,a=n.timing.timestamp;o.delta=t-o.lastTime||r._goodDelta,o.lastTime=t,o.timestampElapsed=a-o.lastTimestamp||0,o.lastTimestamp=a,o.deltaHistory.unshift(o.delta),o.deltaHistory.length=Math.min(o.deltaHistory.length,i),o.engineDeltaHistory.unshift(n.timing.lastDelta),o.engineDeltaHistory.length=Math.min(o.engineDeltaHistory.length,i),o.timestampElapsedHistory.unshift(o.timestampElapsed),o.timestampElapsedHistory.length=Math.min(o.timestampElapsedHistory.length,i),o.engineElapsedHistory.unshift(n.timing.lastElapsed),o.engineElapsedHistory.length=Math.min(o.engineElapsedHistory.length,i),o.elapsedHistory.unshift(o.lastElapsed),o.elapsedHistory.length=Math.min(o.elapsedHistory.length,i)},l=function(e){for(var t=0,n=0;n<e.length;n+=1)t+=e[n];return t/e.length||0},f=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n.oncontextmenu=function(){return!1},n.onselectstart=function(){return!1},n},p=function(e){var t=e.getContext("2d");return(window.devicePixelRatio||1)/(t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1)},d=function(e,t){var n=e.textures[t];return n||((n=e.textures[t]=new Image).src=t,n)},y=function(e,t){var n=t;/(jpg|gif|png)$/.test(t)&&(n="url("+t+")"),e.canvas.style.background=n,e.canvas.style.backgroundSize="contain",e.currentBackground=t}}()},function(e,t){var n={};e.exports=n,n.create=function(e){return{vertex:e,normalImpulse:0,tangentImpulse:0}}},function(e,t,n){var r={};e.exports=r;var o=n(7),i=n(19),a=n(14),s=n(20),c=n(4),u=n(5),l=n(10),f=n(0),p=n(6);r.create=function(e){e=e||{};var t=f.extend({positionIterations:6,velocityIterations:4,constraintIterations:2,enableSleeping:!1,events:[],plugin:{},gravity:{x:0,y:1,scale:.001},timing:{timestamp:0,timeScale:1,lastDelta:0,lastElapsed:0}},e);return t.world=e.world||u.create({label:"World"}),t.pairs=e.pairs||s.create(),t.detector=e.detector||a.create(),t.grid={buckets:[]},t.world.gravity=t.gravity,t.broadphase=t.grid,t.metrics={},t},r.update=function(e,t,n){var p=f.now();t=t||1e3/60,n=n||1;var d,y=e.world,h=e.detector,v=e.pairs,m=e.timing,b=m.timestamp;m.timestamp+=t*m.timeScale,m.lastDelta=t*m.timeScale;var g={timestamp:m.timestamp};c.trigger(e,"beforeUpdate",g);var w=u.allBodies(y),x=u.allConstraints(y);for(y.isModified&&a.setBodies(h,w),y.isModified&&u.setModified(y,!1,!1,!0),e.enableSleeping&&o.update(w,m.timeScale),r._bodiesApplyGravity(w,e.gravity),r._bodiesUpdate(w,t,m.timeScale,n,y.bounds),l.preSolveAll(w),d=0;d<e.constraintIterations;d++)l.solveAll(x,m.timeScale);l.postSolveAll(w),h.pairs=e.pairs;var _=a.collisions(h);for(s.update(v,_,b),e.enableSleeping&&o.afterCollisions(v.list,m.timeScale),v.collisionStart.length>0&&c.trigger(e,"collisionStart",{pairs:v.collisionStart}),i.preSolvePosition(v.list),d=0;d<e.positionIterations;d++)i.solvePosition(v.list,m.timeScale);for(i.postSolvePosition(w),l.preSolveAll(w),d=0;d<e.constraintIterations;d++)l.solveAll(x,m.timeScale);for(l.postSolveAll(w),i.preSolveVelocity(v.list),d=0;d<e.velocityIterations;d++)i.solveVelocity(v.list,m.timeScale);return v.collisionActive.length>0&&c.trigger(e,"collisionActive",{pairs:v.collisionActive}),v.collisionEnd.length>0&&c.trigger(e,"collisionEnd",{pairs:v.collisionEnd}),r._bodiesClearForces(w),c.trigger(e,"afterUpdate",g),e.timing.lastElapsed=f.now()-p,e},r.merge=function(e,t){if(f.extend(e,t),t.world){e.world=t.world,r.clear(e);for(var n=u.allBodies(e.world),i=0;i<n.length;i++){var a=n[i];o.set(a,!1),a.id=f.nextId()}}},r.clear=function(e){s.clear(e.pairs),a.clear(e.detector)},r._bodiesClearForces=function(e){for(var t=0;t<e.length;t++){var n=e[t];n.force.x=0,n.force.y=0,n.torque=0}},r._bodiesApplyGravity=function(e,t){var n=void 0!==t.scale?t.scale:.001;if((0!==t.x||0!==t.y)&&0!==n)for(var r=0;r<e.length;r++){var o=e[r];o.isStatic||o.isSleeping||(o.force.y+=o.mass*t.y*n,o.force.x+=o.mass*t.x*n)}},r._bodiesUpdate=function(e,t,n,r,o){for(var i=0;i<e.length;i++){var a=e[i];a.isStatic||a.isSleeping||p.update(a,t,n,r)}}},function(e,t,n){var r={};e.exports=r;var o=n(3),i=n(1);r._restingThresh=4,r._restingThreshTangent=6,r._positionDampen=.9,r._positionWarming=.8,r._frictionNormalMultiplier=5,r.preSolvePosition=function(e){var t,n,r,o=e.length;for(t=0;t<o;t++)(n=e[t]).isActive&&(r=n.activeContacts.length,n.collision.parentA.totalContacts+=r,n.collision.parentB.totalContacts+=r)},r.solvePosition=function(e,t){var n,o,i,a,s,c,u,l,f=r._positionDampen,p=e.length;for(n=0;n<p;n++)(o=e[n]).isActive&&!o.isSensor&&(a=(i=o.collision).parentA,s=i.parentB,c=i.normal,o.separation=c.x*(s.positionImpulse.x+i.penetration.x-a.positionImpulse.x)+c.y*(s.positionImpulse.y+i.penetration.y-a.positionImpulse.y));for(n=0;n<p;n++)(o=e[n]).isActive&&!o.isSensor&&(a=(i=o.collision).parentA,s=i.parentB,c=i.normal,l=(o.separation-o.slop)*t,(a.isStatic||s.isStatic)&&(l*=2),a.isStatic||a.isSleeping||(u=f/a.totalContacts,a.positionImpulse.x+=c.x*l*u,a.positionImpulse.y+=c.y*l*u),s.isStatic||s.isSleeping||(u=f/s.totalContacts,s.positionImpulse.x-=c.x*l*u,s.positionImpulse.y-=c.y*l*u))},r.postSolvePosition=function(e){for(var t=r._positionWarming,n=e.length,a=o.translate,s=i.update,c=0;c<n;c++){var u=e[c],l=u.positionImpulse,f=l.x,p=l.y,d=u.velocity;if(u.totalContacts=0,0!==f||0!==p){for(var y=0;y<u.parts.length;y++){var h=u.parts[y];a(h.vertices,l),s(h.bounds,h.vertices,d),h.position.x+=f,h.position.y+=p}u.positionPrev.x+=f,u.positionPrev.y+=p,f*d.x+p*d.y<0?(l.x=0,l.y=0):(l.x*=t,l.y*=t)}}},r.preSolveVelocity=function(e){var t,n,r=e.length;for(t=0;t<r;t++){var o=e[t];if(o.isActive&&!o.isSensor){var i=o.activeContacts,a=i.length,s=o.collision,c=s.parentA,u=s.parentB,l=s.normal,f=s.tangent;for(n=0;n<a;n++){var p=i[n],d=p.vertex,y=p.normalImpulse,h=p.tangentImpulse;if(0!==y||0!==h){var v=l.x*y+f.x*h,m=l.y*y+f.y*h;c.isStatic||c.isSleeping||(c.positionPrev.x+=v*c.inverseMass,c.positionPrev.y+=m*c.inverseMass,c.anglePrev+=c.inverseInertia*((d.x-c.position.x)*m-(d.y-c.position.y)*v)),u.isStatic||u.isSleeping||(u.positionPrev.x-=v*u.inverseMass,u.positionPrev.y-=m*u.inverseMass,u.anglePrev-=u.inverseInertia*((d.x-u.position.x)*m-(d.y-u.position.y)*v))}}}}},r.solveVelocity=function(e,t){var n,o,i,a,s=t*t,c=r._restingThresh*s,u=r._frictionNormalMultiplier,l=r._restingThreshTangent*s,f=Number.MAX_VALUE,p=e.length;for(i=0;i<p;i++){var d=e[i];if(d.isActive&&!d.isSensor){var y=d.collision,h=y.parentA,v=y.parentB,m=h.velocity,b=v.velocity,g=y.normal.x,w=y.normal.y,x=y.tangent.x,_=y.tangent.y,S=d.activeContacts,O=S.length,T=1/O,k=h.inverseMass+v.inverseMass,P=d.friction*d.frictionStatic*u*s;for(m.x=h.position.x-h.positionPrev.x,m.y=h.position.y-h.positionPrev.y,b.x=v.position.x-v.positionPrev.x,b.y=v.position.y-v.positionPrev.y,h.angularVelocity=h.angle-h.anglePrev,v.angularVelocity=v.angle-v.anglePrev,a=0;a<O;a++){var C=S[a],E=C.vertex,A=E.x-h.position.x,I=E.y-h.position.y,j=E.x-v.position.x,R=E.y-v.position.y,B=m.x-I*h.angularVelocity,M=m.y+A*h.angularVelocity,N=B-(b.x-R*v.angularVelocity),D=M-(b.y+j*v.angularVelocity),L=g*N+w*D,U=x*N+_*D,G=d.separation+L,z=Math.min(G,1),F=(z=G<0?0:z)*P;U>F||-U>F?(o=U>0?U:-U,(n=d.friction*(U>0?1:-1)*s)<-o?n=-o:n>o&&(n=o)):(n=U,o=f);var W=A*w-I*g,V=j*w-R*g,q=T/(k+h.inverseInertia*W*W+v.inverseInertia*V*V),H=(1+d.restitution)*L*q;if(n*=q,L*L>c&&L<0)C.normalImpulse=0;else{var Y=C.normalImpulse;C.normalImpulse+=H,C.normalImpulse=Math.min(C.normalImpulse,0),H=C.normalImpulse-Y}if(U*U>l)C.tangentImpulse=0;else{var Q=C.tangentImpulse;C.tangentImpulse+=n,C.tangentImpulse<-o&&(C.tangentImpulse=-o),C.tangentImpulse>o&&(C.tangentImpulse=o),n=C.tangentImpulse-Q}var K=g*H+x*n,$=w*H+_*n;h.isStatic||h.isSleeping||(h.positionPrev.x+=K*h.inverseMass,h.positionPrev.y+=$*h.inverseMass,h.anglePrev+=(A*$-I*K)*h.inverseInertia),v.isStatic||v.isSleeping||(v.positionPrev.x-=K*v.inverseMass,v.positionPrev.y-=$*v.inverseMass,v.anglePrev-=(j*$-R*K)*v.inverseInertia)}}}}},function(e,t,n){var r={};e.exports=r;var o=n(9),i=n(0);r.create=function(e){return i.extend({table:{},list:[],collisionStart:[],collisionActive:[],collisionEnd:[]},e)},r.update=function(e,t,n){var r,i,a,s,c=e.list,u=c.length,l=e.table,f=t.length,p=e.collisionStart,d=e.collisionEnd,y=e.collisionActive;for(p.length=0,d.length=0,y.length=0,s=0;s<u;s++)c[s].confirmedActive=!1;for(s=0;s<f;s++)(a=(r=t[s]).pair)?(a.isActive?y.push(a):p.push(a),o.update(a,r,n),a.confirmedActive=!0):(l[(a=o.create(r,n)).id]=a,p.push(a),c.push(a));var h=[];for(u=c.length,s=0;s<u;s++)(a=c[s]).confirmedActive||(o.setActive(a,!1,n),d.push(a),a.collision.bodyA.isSleeping||a.collision.bodyB.isSleeping||h.push(s));for(s=0;s<h.length;s++)a=c[i=h[s]-s],c.splice(i,1),delete l[a.id]},r.clear=function(e){return e.table={},e.list.length=0,e.collisionStart.length=0,e.collisionActive.length=0,e.collisionEnd.length=0,e}},function(e,t,n){var r=e.exports=n(22);r.Axes=n(11),r.Bodies=n(12),r.Body=n(6),r.Bounds=n(1),r.Collision=n(8),r.Common=n(0),r.Composite=n(5),r.Composites=n(23),r.Constraint=n(10),r.Contact=n(17),r.Detector=n(14),r.Engine=n(18),r.Events=n(4),r.Grid=n(24),r.Mouse=n(13),r.MouseConstraint=n(25),r.Pair=n(9),r.Pairs=n(20),r.Plugin=n(15),r.Query=n(26),r.Render=n(16),r.Resolver=n(19),r.Runner=n(27),r.SAT=n(28),r.Sleeping=n(7),r.Svg=n(29),r.Vector=n(2),r.Vertices=n(3),r.World=n(30),r.Engine.run=r.Runner.run,r.Common.deprecated(r.Engine,"run","Engine.run âž¤ use Matter.Runner.run(engine) instead")},function(e,t,n){var r={};e.exports=r;var o=n(15),i=n(0);r.name="matter-js",r.version="0.18.0",r.uses=[],r.used=[],r.use=function(){o.use(r,Array.prototype.slice.call(arguments))},r.before=function(e,t){return e=e.replace(/^Matter./,""),i.chainPathBefore(r,e,t)},r.after=function(e,t){return e=e.replace(/^Matter./,""),i.chainPathAfter(r,e,t)}},function(e,t,n){var r={};e.exports=r;var o=n(5),i=n(10),a=n(0),s=n(6),c=n(12),u=a.deprecated;r.stack=function(e,t,n,r,i,a,c){for(var u,l=o.create({label:"Stack"}),f=e,p=t,d=0,y=0;y<r;y++){for(var h=0,v=0;v<n;v++){var m=c(f,p,v,y,u,d);if(m){var b=m.bounds.max.y-m.bounds.min.y,g=m.bounds.max.x-m.bounds.min.x;b>h&&(h=b),s.translate(m,{x:.5*g,y:.5*b}),f=m.bounds.max.x+i,o.addBody(l,m),u=m,d+=1}else f+=i}p+=h+a,f=e}return l},r.chain=function(e,t,n,r,s,c){for(var u=e.bodies,l=1;l<u.length;l++){var f=u[l-1],p=u[l],d=f.bounds.max.y-f.bounds.min.y,y=f.bounds.max.x-f.bounds.min.x,h=p.bounds.max.y-p.bounds.min.y,v={bodyA:f,pointA:{x:y*t,y:d*n},bodyB:p,pointB:{x:(p.bounds.max.x-p.bounds.min.x)*r,y:h*s}},m=a.extend(v,c);o.addConstraint(e,i.create(m))}return e.label+=" Chain",e},r.mesh=function(e,t,n,r,s){var c,u,l,f,p,d=e.bodies;for(c=0;c<n;c++){for(u=1;u<t;u++)l=d[u-1+c*t],f=d[u+c*t],o.addConstraint(e,i.create(a.extend({bodyA:l,bodyB:f},s)));if(c>0)for(u=0;u<t;u++)l=d[u+(c-1)*t],f=d[u+c*t],o.addConstraint(e,i.create(a.extend({bodyA:l,bodyB:f},s))),r&&u>0&&(p=d[u-1+(c-1)*t],o.addConstraint(e,i.create(a.extend({bodyA:p,bodyB:f},s)))),r&&u<t-1&&(p=d[u+1+(c-1)*t],o.addConstraint(e,i.create(a.extend({bodyA:p,bodyB:f},s))))}return e.label+=" Mesh",e},r.pyramid=function(e,t,n,o,i,a,c){return r.stack(e,t,n,o,i,a,(function(t,r,a,u,l,f){var p=Math.min(o,Math.ceil(n/2)),d=l?l.bounds.max.x-l.bounds.min.x:0;if(!(u>p||a<(u=p-u)||a>n-1-u))return 1===f&&s.translate(l,{x:(a+(n%2==1?1:-1))*d,y:0}),c(e+(l?a*d:0)+a*i,r,a,u,l,f)}))},r.newtonsCradle=function(e,t,n,r,a){for(var s=o.create({label:"Newtons Cradle"}),u=0;u<n;u++){var l=c.circle(e+u*(1.9*r),t+a,r,{inertia:1/0,restitution:1,friction:0,frictionAir:1e-4,slop:1}),f=i.create({pointA:{x:e+u*(1.9*r),y:t},bodyB:l});o.addBody(s,l),o.addConstraint(s,f)}return s},u(r,"newtonsCradle","Composites.newtonsCradle âž¤ moved to newtonsCradle example"),r.car=function(e,t,n,r,a){var u=s.nextGroup(!0),l=.5*-n+20,f=.5*n-20,p=o.create({label:"Car"}),d=c.rectangle(e,t,n,r,{collisionFilter:{group:u},chamfer:{radius:.5*r},density:2e-4}),y=c.circle(e+l,t+0,a,{collisionFilter:{group:u},friction:.8}),h=c.circle(e+f,t+0,a,{collisionFilter:{group:u},friction:.8}),v=i.create({bodyB:d,pointB:{x:l,y:0},bodyA:y,stiffness:1,length:0}),m=i.create({bodyB:d,pointB:{x:f,y:0},bodyA:h,stiffness:1,length:0});return o.addBody(p,d),o.addBody(p,y),o.addBody(p,h),o.addConstraint(p,v),o.addConstraint(p,m),p},u(r,"car","Composites.car âž¤ moved to car example"),r.softBody=function(e,t,n,o,i,s,u,l,f,p){f=a.extend({inertia:1/0},f),p=a.extend({stiffness:.2,render:{type:"line",anchors:!1}},p);var d=r.stack(e,t,n,o,i,s,(function(e,t){return c.circle(e,t,l,f)}));return r.mesh(d,n,o,u,p),d.label="Soft Body",d},u(r,"softBody","Composites.softBody âž¤ moved to softBody and cloth examples")},function(e,t,n){var r={};e.exports=r;var o=n(9),i=n(0),a=i.deprecated;r.create=function(e){return i.extend({buckets:{},pairs:{},pairsList:[],bucketWidth:48,bucketHeight:48},e)},r.update=function(e,t,n,o){var i,a,s,c,u,l=n.world,f=e.buckets,p=!1;for(i=0;i<t.length;i++){var d=t[i];if((!d.isSleeping||o)&&(!l.bounds||!(d.bounds.max.x<l.bounds.min.x||d.bounds.min.x>l.bounds.max.x||d.bounds.max.y<l.bounds.min.y||d.bounds.min.y>l.bounds.max.y))){var y=r._getRegion(e,d);if(!d.region||y.id!==d.region.id||o){d.region&&!o||(d.region=y);var h=r._regionUnion(y,d.region);for(a=h.startCol;a<=h.endCol;a++)for(s=h.startRow;s<=h.endRow;s++){c=f[u=r._getBucketId(a,s)];var v=a>=y.startCol&&a<=y.endCol&&s>=y.startRow&&s<=y.endRow,m=a>=d.region.startCol&&a<=d.region.endCol&&s>=d.region.startRow&&s<=d.region.endRow;!v&&m&&m&&c&&r._bucketRemoveBody(e,c,d),(d.region===y||v&&!m||o)&&(c||(c=r._createBucket(f,u)),r._bucketAddBody(e,c,d))}d.region=y,p=!0}}}p&&(e.pairsList=r._createActivePairsList(e))},a(r,"update","Grid.update âž¤ replaced by Matter.Detector"),r.clear=function(e){e.buckets={},e.pairs={},e.pairsList=[]},a(r,"clear","Grid.clear âž¤ replaced by Matter.Detector"),r._regionUnion=function(e,t){var n=Math.min(e.startCol,t.startCol),o=Math.max(e.endCol,t.endCol),i=Math.min(e.startRow,t.startRow),a=Math.max(e.endRow,t.endRow);return r._createRegion(n,o,i,a)},r._getRegion=function(e,t){var n=t.bounds,o=Math.floor(n.min.x/e.bucketWidth),i=Math.floor(n.max.x/e.bucketWidth),a=Math.floor(n.min.y/e.bucketHeight),s=Math.floor(n.max.y/e.bucketHeight);return r._createRegion(o,i,a,s)},r._createRegion=function(e,t,n,r){return{id:e+","+t+","+n+","+r,startCol:e,endCol:t,startRow:n,endRow:r}},r._getBucketId=function(e,t){return"C"+e+"R"+t},r._createBucket=function(e,t){return e[t]=[]},r._bucketAddBody=function(e,t,n){var r,i=e.pairs,a=o.id,s=t.length;for(r=0;r<s;r++){var c=t[r];if(!(n.id===c.id||n.isStatic&&c.isStatic)){var u=a(n,c),l=i[u];l?l[2]+=1:i[u]=[n,c,1]}}t.push(n)},r._bucketRemoveBody=function(e,t,n){var r,a=e.pairs,s=o.id;t.splice(i.indexOf(t,n),1);var c=t.length;for(r=0;r<c;r++){var u=a[s(n,t[r])];u&&(u[2]-=1)}},r._createActivePairsList=function(e){var t,n,r=e.pairs,o=i.keys(r),a=o.length,s=[];for(n=0;n<a;n++)(t=r[o[n]])[2]>0?s.push(t):delete r[o[n]];return s}},function(e,t,n){var r={};e.exports=r;var o=n(3),i=n(7),a=n(13),s=n(4),c=n(14),u=n(10),l=n(5),f=n(0),p=n(1);r.create=function(e,t){var n=(e?e.mouse:null)||(t?t.mouse:null);n||(e&&e.render&&e.render.canvas?n=a.create(e.render.canvas):t&&t.element?n=a.create(t.element):(n=a.create(),f.warn("MouseConstraint.create: options.mouse was undefined, options.element was undefined, may not function as expected")));var o={type:"mouseConstraint",mouse:n,element:null,body:null,constraint:u.create({label:"Mouse Constraint",pointA:n.position,pointB:{x:0,y:0},length:.01,stiffness:.1,angularStiffness:1,render:{strokeStyle:"#90EE90",lineWidth:3}}),collisionFilter:{category:1,mask:4294967295,group:0}},i=f.extend(o,t);return s.on(e,"beforeUpdate",(function(){var t=l.allBodies(e.world);r.update(i,t),r._triggerEvents(i)})),i},r.update=function(e,t){var n=e.mouse,r=e.constraint,a=e.body;if(0===n.button){if(r.bodyB)i.set(r.bodyB,!1),r.pointA=n.position;else for(var u=0;u<t.length;u++)if(a=t[u],p.contains(a.bounds,n.position)&&c.canCollide(a.collisionFilter,e.collisionFilter))for(var l=a.parts.length>1?1:0;l<a.parts.length;l++){var f=a.parts[l];if(o.contains(f.vertices,n.position)){r.pointA=n.position,r.bodyB=e.body=a,r.pointB={x:n.position.x-a.position.x,y:n.position.y-a.position.y},r.angleB=a.angle,i.set(a,!1),s.trigger(e,"startdrag",{mouse:n,body:a});break}}}else r.bodyB=e.body=null,r.pointB=null,a&&s.trigger(e,"enddrag",{mouse:n,body:a})},r._triggerEvents=function(e){var t=e.mouse,n=t.sourceEvents;n.mousemove&&s.trigger(e,"mousemove",{mouse:t}),n.mousedown&&s.trigger(e,"mousedown",{mouse:t}),n.mouseup&&s.trigger(e,"mouseup",{mouse:t}),a.clearSourceEvents(t)}},function(e,t,n){var r={};e.exports=r;var o=n(2),i=n(8),a=n(1),s=n(12),c=n(3);r.collides=function(e,t){for(var n=[],r=t.length,o=e.bounds,s=i.collides,c=a.overlaps,u=0;u<r;u++){var l=t[u],f=l.parts.length,p=1===f?0:1;if(c(l.bounds,o))for(var d=p;d<f;d++){var y=l.parts[d];if(c(y.bounds,o)){var h=s(y,e);if(h){n.push(h);break}}}}return n},r.ray=function(e,t,n,i){i=i||1e-100;for(var a=o.angle(t,n),c=o.magnitude(o.sub(t,n)),u=.5*(n.x+t.x),l=.5*(n.y+t.y),f=s.rectangle(u,l,c,i,{angle:a}),p=r.collides(f,e),d=0;d<p.length;d+=1){var y=p[d];y.body=y.bodyB=y.bodyA}return p},r.region=function(e,t,n){for(var r=[],o=0;o<e.length;o++){var i=e[o],s=a.overlaps(i.bounds,t);(s&&!n||!s&&n)&&r.push(i)}return r},r.point=function(e,t){for(var n=[],r=0;r<e.length;r++){var o=e[r];if(a.contains(o.bounds,t))for(var i=1===o.parts.length?0:1;i<o.parts.length;i++){var s=o.parts[i];if(a.contains(s.bounds,t)&&c.contains(s.vertices,t)){n.push(o);break}}}return n}},function(e,t,n){var r={};e.exports=r;var o,i,a,s=n(4),c=n(18),u=n(0);"undefined"!=typeof window&&(o=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,i=window.cancelAnimationFrame||window.mozCancelAnimationFrame||window.webkitCancelAnimationFrame||window.msCancelAnimationFrame),o||(o=function(e){a=setTimeout((function(){e(u.now())}),1e3/60)},i=function(){clearTimeout(a)}),r.create=function(e){var t=u.extend({fps:60,correction:1,deltaSampleSize:60,counterTimestamp:0,frameCounter:0,deltaHistory:[],timePrev:null,timeScalePrev:1,frameRequestId:null,isFixed:!1,enabled:!0},e);return t.delta=t.delta||1e3/t.fps,t.deltaMin=t.deltaMin||1e3/t.fps,t.deltaMax=t.deltaMax||1e3/(.5*t.fps),t.fps=1e3/t.delta,t},r.run=function(e,t){return void 0!==e.positionIterations&&(t=e,e=r.create()),function n(i){e.frameRequestId=o(n),i&&e.enabled&&r.tick(e,t,i)}(),e},r.tick=function(e,t,n){var r,o=t.timing,i=1,a={timestamp:o.timestamp};s.trigger(e,"beforeTick",a),e.isFixed?r=e.delta:(r=n-e.timePrev||e.delta,e.timePrev=n,e.deltaHistory.push(r),e.deltaHistory=e.deltaHistory.slice(-e.deltaSampleSize),i=(r=(r=(r=Math.min.apply(null,e.deltaHistory))<e.deltaMin?e.deltaMin:r)>e.deltaMax?e.deltaMax:r)/e.delta,e.delta=r),0!==e.timeScalePrev&&(i*=o.timeScale/e.timeScalePrev),0===o.timeScale&&(i=0),e.timeScalePrev=o.timeScale,e.correction=i,e.frameCounter+=1,n-e.counterTimestamp>=1e3&&(e.fps=e.frameCounter*((n-e.counterTimestamp)/1e3),e.counterTimestamp=n,e.frameCounter=0),s.trigger(e,"tick",a),s.trigger(e,"beforeUpdate",a),c.update(t,r,i),s.trigger(e,"afterUpdate",a),s.trigger(e,"afterTick",a)},r.stop=function(e){i(e.frameRequestId)},r.start=function(e,t){r.run(e,t)}},function(e,t,n){var r={};e.exports=r;var o=n(8),i=n(0).deprecated;r.collides=function(e,t){return o.collides(e,t)},i(r,"collides","SAT.collides âž¤ replaced by Collision.collides")},function(e,t,n){var r={};e.exports=r,n(1);var o=n(0);r.pathToVertices=function(e,t){"undefined"==typeof window||"SVGPathSeg"in window||o.warn("Svg.pathToVertices: SVGPathSeg not defined, a polyfill is required.");var n,i,a,s,c,u,l,f,p,d,y,h=[],v=0,m=0,b=0;t=t||15;var g=function(e,t,n){var r=n%2==1&&n>1;if(!p||e!=p.x||t!=p.y){p&&r?(d=p.x,y=p.y):(d=0,y=0);var o={x:d+e,y:y+t};!r&&p||(p=o),h.push(o),m=d+e,b=y+t}},w=function(e){var t=e.pathSegTypeAsLetter.toUpperCase();if("Z"!==t){switch(t){case"M":case"L":case"T":case"C":case"S":case"Q":m=e.x,b=e.y;break;case"H":m=e.x;break;case"V":b=e.y}g(m,b,e.pathSegType)}};for(r._svgPathToAbsolute(e),a=e.getTotalLength(),u=[],n=0;n<e.pathSegList.numberOfItems;n+=1)u.push(e.pathSegList.getItem(n));for(l=u.concat();v<a;){if((c=u[e.getPathSegAtLength(v)])!=f){for(;l.length&&l[0]!=c;)w(l.shift());f=c}switch(c.pathSegTypeAsLetter.toUpperCase()){case"C":case"T":case"S":case"Q":case"A":s=e.getPointAtLength(v),g(s.x,s.y,0)}v+=t}for(n=0,i=l.length;n<i;++n)w(l[n]);return h},r._svgPathToAbsolute=function(e){for(var t,n,r,o,i,a,s=e.pathSegList,c=0,u=0,l=s.numberOfItems,f=0;f<l;++f){var p=s.getItem(f),d=p.pathSegTypeAsLetter;if(/[MLHVCSQTA]/.test(d))"x"in p&&(c=p.x),"y"in p&&(u=p.y);else switch("x1"in p&&(r=c+p.x1),"x2"in p&&(i=c+p.x2),"y1"in p&&(o=u+p.y1),"y2"in p&&(a=u+p.y2),"x"in p&&(c+=p.x),"y"in p&&(u+=p.y),d){case"m":s.replaceItem(e.createSVGPathSegMovetoAbs(c,u),f);break;case"l":s.replaceItem(e.createSVGPathSegLinetoAbs(c,u),f);break;case"h":s.replaceItem(e.createSVGPathSegLinetoHorizontalAbs(c),f);break;case"v":s.replaceItem(e.createSVGPathSegLinetoVerticalAbs(u),f);break;case"c":s.replaceItem(e.createSVGPathSegCurvetoCubicAbs(c,u,r,o,i,a),f);break;case"s":s.replaceItem(e.createSVGPathSegCurvetoCubicSmoothAbs(c,u,i,a),f);break;case"q":s.replaceItem(e.createSVGPathSegCurvetoQuadraticAbs(c,u,r,o),f);break;case"t":s.replaceItem(e.createSVGPathSegCurvetoQuadraticSmoothAbs(c,u),f);break;case"a":s.replaceItem(e.createSVGPathSegArcAbs(c,u,p.r1,p.r2,p.angle,p.largeArcFlag,p.sweepFlag),f);break;case"z":case"Z":c=t,u=n}"M"!=d&&"m"!=d||(t=c,n=u)}}},function(e,t,n){var r={};e.exports=r;var o=n(5);n(0),r.create=o.create,r.add=o.add,r.remove=o.remove,r.clear=o.clear,r.addComposite=o.addComposite,r.addBody=o.addBody,r.addConstraint=o.addConstraint}])},e.exports=r()}},t={};function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports}n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),(()=>{"use strict";var e,t=function(){function e(e,t){void 0===t&&(t=e),this.x=e,this.y=t}return e.prototype.add=function(e){return this.x+=e.x,this.y+=e.y,this},e.prototype.sub=function(e){return this.x-=e.x,this.y-=e.y,this},e.prototype.mul=function(e){return this.x*=e.x,this.y*=e.y,this},e.prototype.scale=function(e){return this.x*=e,this.y*=e,this},e.prototype.div=function(e){return 0!==e.x&&(this.x/=e.x),0!==e.y&&(this.y/=e.y),this},e.prototype.distTo=function(e){return Math.sqrt(Math.pow(this.x-e.x,2)+Math.pow(this.y-e.y,2))},e.prototype.diff=function(t){return new e(Math.abs(this.x-t.x),Math.abs(this.y-t.y))},Object.defineProperty(e.prototype,"magnitude",{get:function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},enumerable:!1,configurable:!0}),e.prototype.normalise=function(){var e=this.magnitude;return 0!==e?this.scale(1/e):console.error("Cannot normalise vector with magnitude 0"),this},Object.defineProperty(e.prototype,"clone",{get:function(){return new e(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"angle",{get:function(){return-Math.atan2(-this.y,this.x)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"str",{get:function(){return"x: ".concat(this.x," \ny: ").concat(this.y)},enumerable:!1,configurable:!0}),e.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},e.prototype.isInRect=function(e,t){return this.x>e.x&&this.x<e.x+t.x&&this.y>e.y&&this.y<e.y+t.y},e.prototype.set=function(e){return this.x=Number(e.x),this.y=Number(e.y),this},e.prototype.apply=function(e){this.x=Number(e(this.x)),this.y=Number(e(this.y))},e.prototype.dot=function(e){return this.x*e.x+this.y*e.y},e.prototype.cross=function(e){return this.x*e.y-this.y*e.x},Object.defineProperty(e.prototype,"negative",{get:function(){return this.clone.scale(-1)},enumerable:!1,configurable:!0}),e.prototype.toInt=function(){return this.apply(Math.round),this},Object.defineProperty(e.prototype,"v3",{get:function(){return new r(this.x,this.y,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"array",{get:function(){return[this.x,this.y]},enumerable:!1,configurable:!0}),e.fromAngleMagnitude=function(t,n){for(;t<0;)t+=360;return t%=360,new e(Math.sin(t),Math.cos(t)).normalise().scale(n)},e.fromArray=function(t){return new e(t[0],t[1])},Object.defineProperty(e,"up",{get:function(){return new e(0,1)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"down",{get:function(){return new e(0,-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"right",{get:function(){return new e(1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"left",{get:function(){return new e(-1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"zero",{get:function(){return new e(0,0)},enumerable:!1,configurable:!0}),e.avPoint=function(t){var n,r,o=e.zero;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),a=i.next();!a.done;a=i.next()){var s=a.value;o.add(s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o.scale(1/t.length)},e}(),r=function(){function e(n,r,o,i){var a=this;void 0===r&&(r=n),void 0===o&&(o=n),void 0===i&&(i=1),this.add=function(e){return a.x+=(null==e?void 0:e.x)||0,a.y+=(null==e?void 0:e.y)||0,a.z+=(null==e?void 0:e.z)||0,a},this.sub=function(e){return a.x-=e.x||0,a.y-=e.y||0,a.z-=e.z||0,a},this.mul=function(e){return a.x*=e.x,a.y*=e.y,a.z*=e.z,a},this.scale=function(e){return a.x*=e,a.y*=e,a.z*=e,a},this.div=function(e){return 0!==e.x&&(a.x/=e.x),0!==e.y&&(a.y/=e.y),0!==e.z&&(a.z/=e.z),a},this.distTo=function(e){return a.clone.sub(e).magnitude},this.diff=function(t){return new e(Math.abs(a.x-t.x),Math.abs(a.y-t.y),Math.abs(a.z-t.z))},this.normalise=function(){var e=a.magnitude;return 0!==e?a.scale(1/e):console.error("Cannot normalise vector with magnitude 0"),a},this.equals=function(e){return e.x===a.x&&e.y===a.y&&e.z===a.z},this.isInCuboid=function(e,n){return new t(a.x,a.y).isInRect(new t(e.x,e.y),new t(n.x,n.y))&&new t(a.y,a.z).isInRect(new t(e.y,e.z),new t(n.y,n.z))&&new t(a.x,a.z).isInRect(new t(e.x,e.z),new t(n.x,n.z))},this.set=function(e){return a.x=e.x,a.y=e.y,a.z=e.z,a},this.apply=function(e){a.x=e(a.x),a.y=e(a.y),a.z=e(a.z)},this.dot=function(e){return a.x*e.x+a.y*e.y+a.z*e.z},this.cross=function(e){return a.x*e.y-a.y*e.x-a.z*e.z},this.toInt=function(){return a.apply(Math.round),a},this.x=n,this.y=r,this.z=o,this.w=i}return Object.defineProperty(e.prototype,"magnitude",{get:function(){var e=Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2);return 0===e?0:Math.sqrt(e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clone",{get:function(){return new e(this.x,this.y,this.z)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"str",{get:function(){return"x: ".concat(this.x," \ny: ").concat(this.y," \nz: ").concat(this.z)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"negative",{get:function(){return this.clone.scale(-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"v2",{get:function(){return new t(this.x,this.y)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"array",{get:function(){return[this.x,this.y,this.z]},enumerable:!1,configurable:!0}),Object.defineProperty(e,"up",{get:function(){return new e(0,1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"down",{get:function(){return new e(0,-1,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"right",{get:function(){return new e(1,0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"left",{get:function(){return new e(-1,0,0)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"forward",{get:function(){return new e(0,0,1)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"back",{get:function(){return new e(0,0,-1)},enumerable:!1,configurable:!0}),Object.defineProperty(e,"zero",{get:function(){return new e(0,0,0)},enumerable:!1,configurable:!0}),e.avPoint=function(t){var n,r,o=e.zero;try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(t),a=i.next();!a.done;a=i.next()){var s=a.value;o.add(s)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o.scale(1/t.length)},e.fromArray=function(t){return new e(t[0],t[1],t[2])},e}(),o=(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}),i=function(){function e(e,t,n){void 0===n&&(n=0),this.m=[];for(var r=0;r<t;r++){for(var o=[],i=0;i<e;i++)o.push(n);this.m.push(o)}}return e.prototype.at=function(e,t){return this.m[t][e]},e.prototype.set=function(e,t,n){this.m[t][e]=n},e}(),a=(function(e){function t(t){return void 0===t&&(t=0),e.call(this,4,4,t)||this}o(t,e),t.prototype.timesMat=function(e){var n=new r(e.at(0,0),e.at(1,0),e.at(2,0),e.at(3,0)),o=new r(e.at(0,1),e.at(1,1),e.at(2,1),e.at(3,1)),i=new r(e.at(0,2),e.at(1,2),e.at(2,0),e.at(3,2)),a=new r(e.at(0,3),e.at(1,3),e.at(2,0),e.at(3,3)),s=this.transformV3(n),c=this.transformV3(o),u=this.transformV3(i),l=this.transformV3(a),f=new t;return f.m=[[s.x,s.y,s.z,s.w],[c.x,c.y,c.z,c.w],[u.x,u.y,u.z,u.w],[l.x,l.y,l.z,l.w]],f},t.prototype.transformV3=function(e){return new r(e.x*this.at(0,0)+e.y*this.at(0,1)+e.z*this.at(2,0)+this.at(0,3),e.x*this.at(1,0)+e.y*this.at(1,1)+e.z*this.at(1,2)+this.at(1,3),e.x*this.at(2,0)+e.y*this.at(2,1)+e.z*this.at(2,2)+this.at(2,3))},t.unit=function(){for(var e=new t(0),n=0;n<4;n++)e.m[n][n]=1;return e}}(i),function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}),s=function(){function e(e){this.triangles=e}return e.prototype.move=function(e){var t,n;try{for(var r=a(this.triangles),o=r.next();!o.done;o=r.next())o.value.move(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e}(),c=function(){function e(e){this.points=e}return e.prototype.move=function(e){var t,n;try{for(var r=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.points),o=r.next();!o.done;o=r.next())o.value.add(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e}(),u=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},l=function(){function e(e,t,n){this.points=[e,t,n]}return e.prototype.move=function(e){var t,n;try{for(var r=u(this.points),o=r.next();!o.done;o=r.next())o.value.add(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.apply=function(e){for(var t=0;t<3;t++)this.points[t]=e(this.points[t].clone)},Object.defineProperty(e.prototype,"clone",{get:function(){return new(e.bind.apply(e,function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([void 0],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(this.points.map((function(e){return e.clone}))),!1)))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"triangleV2",{get:function(){return new c([this.points[0].v2,this.points[1].v2,this.points[2].v2])},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"json",{get:function(){var e,t,n=[];try{for(var r=u(this.points),o=r.next();!o.done;o=r.next()){var i=o.value;n.push(i.array)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),e}(),f=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},p=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},d=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},y=function(){function e(e){this.triangles=e}return e.prototype.move=function(e){var t,n;try{for(var r=f(this.triangles),o=r.next();!o.done;o=r.next())o.value.move(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},Object.defineProperty(e.prototype,"json",{get:function(){var e,t,n=[];try{for(var r=f(this.triangles),o=r.next();!o.done;o=r.next()){var i=o.value;n.push(i.json)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clone",{get:function(){return new e(this.triangles.map((function(e){return e.clone})))},enumerable:!1,configurable:!0}),e.fromArray=function(t){var n,o,i,a,s=new e([]);try{for(var c=f(t),u=c.next();!u.done;u=c.next()){var y=u.value,h=[];try{for(var v=(i=void 0,f(y)),m=v.next();!m.done;m=v.next()){var b=m.value;h.push(r.fromArray(b))}}catch(e){i={error:e}}finally{try{m&&!m.done&&(a=v.return)&&a.call(v)}finally{if(i)throw i.error}}s.triangles.push(new(l.bind.apply(l,d([void 0],p(h),!1))))}}catch(e){n={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(n)throw n.error}}return s},Object.defineProperty(e,"cube",{get:function(){return new e([new l(new r(0,0,0),new r(0,1,0),new r(1,1,0)),new l(new r(0,0,0),new r(1,1,0),new r(1,0,0)),new l(new r(1,0,0),new r(1,1,0),new r(1,1,1)),new l(new r(1,0,0),new r(1,1,1),new r(1,0,1)),new l(new r(1,0,1),new r(1,1,1),new r(0,1,1)),new l(new r(1,0,1),new r(0,1,1),new r(0,0,1)),new l(new r(0,0,1),new r(0,1,1),new r(0,1,0)),new l(new r(0,0,1),new r(0,1,0),new r(0,0,0)),new l(new r(0,1,0),new r(0,1,1),new r(1,1,1)),new l(new r(0,1,0),new r(1,1,1),new r(1,1,0)),new l(new r(1,0,1),new r(0,0,1),new r(0,0,0)),new l(new r(1,0,1),new r(0,0,0),new r(1,0,0))])},enumerable:!1,configurable:!0}),e}(),h=function(){function e(e,t,n,r){void 0===r&&(r=1),this.red=e,this.green=t,this.blue=n,this.alpha=r,this.isColour=!0}return Object.defineProperty(e.prototype,"hex",{get:function(){return"#".concat(g(this.red)).concat(g(this.green)).concat(g(this.blue))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rgb",{get:function(){return"rgb(".concat(this.red,", ").concat(this.green,", ").concat(this.blue,")")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"rgba",{get:function(){return"rgba(".concat(this.red,", ").concat(this.green,", ").concat(this.blue,", ").concat(this.alpha,")")},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"clone",{get:function(){return new e(this.red,this.green,this.blue,this.alpha)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"json",{get:function(){return{r:this.red,g:this.green,b:this.blue,a:this.alpha}},enumerable:!1,configurable:!0}),e.parse=function(e){var t;return(t=e.match(/^#([0-9a-f]{3})$/i))&&t[1]?v(17*parseInt(t[1].charAt(0),16),17*parseInt(t[1].charAt(1),16),17*parseInt(t[1].charAt(2),16)):(t=e.match(/^#([0-9a-f]{6})$/i))?v(parseInt(t[1].substr(0,2),16),parseInt(t[1].substr(2,2),16),parseInt(t[1].substr(4,2),16)):(t=e.match(/^rgb\s*\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*\)$/i))?v(parseInt(t[1]),parseInt(t[2]),parseInt(t[3])):m[e]||v(0,0,0)},e}();function v(e,t,n){return new h(e,t,n)}var m={red:v(255,0,0),green:v(0,255,0),blue:v(0,0,255),white:v(255,255,255)};function b(e,t,n,r){return new h(e,t,n,r)}function g(e){var t=Number(e).toString(16);return t.length<2&&(t="0"+t),t}v.parse=h.parse;var w,x,_=function(e){this.array=e.array||!1,this.type=e.type||typeof e.value||"string",this.value=e.value,this.name=e.name,this.description=e.description||"",this.default=e.default,this.assetType=e.assetType,this.array&&(this.value?Array.isArray(this.value)||(this.value=[this.value]):this.value=[])},S=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},O=function(){function e(e,t){void 0===t&&(t=""),this.type=e,this.subtype=t,this.public=[]}return e.prototype.addPublic=function(e){if(e.name)if(this.hasPublic(e.name))console.error("Cannot add property with existing name: "+e.name);else{if(void 0!==e.value||void 0!==e.default){void 0===e.value&&(e.value=e.default);var t=new _(e);return this.public.push(t),Object.defineProperty(this,e.name,{enumerable:!0,get:function(){return void 0===e.overrideGet?this.getPublic(e.name):e.overrideGet()},set:function(t){void 0!==e.overrideSet?e.overrideSet(t):this.setPublicTypeCheck(e.name,t)}}),t}console.error("Public fields must have 'value' property")}else console.error("Public fields must have 'name' property")},e.prototype.getPublic=function(e){var t,n;try{for(var r=S(this.public),o=r.next();!o.done;o=r.next()){var i=o.value;if(i.name===e)return i.value}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.getPublicField=function(e){var t,n;try{for(var r=S(this.public),o=r.next();!o.done;o=r.next()){var i=o.value;if(i.name===e)return i}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.hasPublic=function(e){var t,n;try{for(var r=S(this.public),o=r.next();!o.done;o=r.next())if(o.value.name===e)return!0}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return!1},e.prototype.setPublic=function(e,t){var n,r;try{for(var o=S(this.public),i=o.next();!i.done;i=o.next()){var a=i.value;a.name===e&&(a.value=t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.prototype.setPublicTypeCheck=function(e,n){if(this.hasPublic(e)){var o=typeof n,i=this.getPublicField(e);if(void 0!==i)switch(i.type){case"rgb":if("string"==typeof n){this.setPublic(e,v.parse(n));break}if(n&&(null==n?void 0:n.isColour)){this.setPublic(e,n);break}console.error("Cannot set property '".concat(e,"' of type '").concat(o,"' to:"),n);break;case"Transform":this.setPublic(e,n);break;case"v2":if(n instanceof t){this.setPublic(e,n);break}if(Array.isArray(n)&&2===n.length){this.setPublic(e,t.fromArray(n));break}if("number"==typeof n.x&&"number"==typeof n.y){this.setPublic(e,new t(n.x,n.y));break}console.error("Cannot set public property '".concat(e,"' of type v2 to value '").concat(n,"' of type '").concat(o,"'"));break;case"v3":if(n instanceof r){this.setPublic(e,n);break}if(Array.isArray(n)&&(3===n.length||4===n.length)){this.setPublic(e,r.fromArray(n));break}if("number"==typeof n.x&&"number"==typeof n.y&&"number"==typeof n.z){this.setPublic(e,new r(n.x,n.y,n.z,n.w));break}console.error("Cannot set public property '".concat(e,"' of type v3 to value '").concat(n,"' of type '").concat(o,"'"));break;default:if(o!==i.type)return void console.error("Tried to set public variable '".concat(e,"' of type '").concat(i.type,"' to '").concat(n,"' of type '").concat(o,"'"));this.setPublic(e,n)}else console.log("No public variable found  with name ".concat(e))}else console.log("No public variable found  with name ".concat(e))},e}(),T="0123456789",k="_$abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",P=["'","`",'"'],C="undefined"==typeof window,E={print:console.log},A=["var","let","global","local","mutable","const","if","else","while","for","in","continue","break","func","return","yield","class","extends","namespace","export"],I=function(){return 0};function j(e){return t=this,n=void 0,o=function(){return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(t){return I=e?function(){return Date.now()}:function(){try{return null===performance||void 0===performance?void 0:performance.now()}catch(e){return 0}},[2]}))},new((r=void 0)||(r=Promise))((function(e,i){function a(e){try{c(o.next(e))}catch(e){i(e)}}function s(e){try{c(o.throw(e))}catch(e){i(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof r?n:new r((function(e){e(n)}))).then(a,s)}c((o=o.apply(t,n||[])).next())}));var t,n,r,o}j(C);var R,B={};!function(e){e[e.NUMBER=0]="NUMBER",e[e.STRING=1]="STRING",e[e.ENDSTATEMENT=2]="ENDSTATEMENT",e[e.IDENTIFIER=3]="IDENTIFIER",e[e.KEYWORD=4]="KEYWORD",e[e.COMMA=5]="COMMA",e[e.ASSIGN=6]="ASSIGN",e[e.ADD=7]="ADD",e[e.SUB=8]="SUB",e[e.MUL=9]="MUL",e[e.DIV=10]="DIV",e[e.POW=11]="POW",e[e.OPAREN=12]="OPAREN",e[e.CPAREN=13]="CPAREN",e[e.OBRACES=14]="OBRACES",e[e.CBRACES=15]="CBRACES",e[e.OSQUARE=16]="OSQUARE",e[e.CSQUARE=17]="CSQUARE",e[e.EQUALS=18]="EQUALS",e[e.NOTEQUALS=19]="NOTEQUALS",e[e.NOT=20]="NOT",e[e.GT=21]="GT",e[e.LT=22]="LT",e[e.GTE=23]="GTE",e[e.LTE=24]="LTE",e[e.AND=25]="AND",e[e.OR=26]="OR",e[e.COLON=27]="COLON",e[e.DOT=28]="DOT",e[e.EOF=29]="EOF",e[e.BITWISE_OR=30]="BITWISE_OR",e[e.BITWISE_AND=31]="BITWISE_AND",e[e.BITWISE_NOT=32]="BITWISE_NOT"}(R||(R={}));var M=R,N=((w={})[M.NUMBER]="Number",w[M.STRING]="String",w[M.ENDSTATEMENT]=";",w[M.IDENTIFIER]="Identifier",w[M.KEYWORD]="Keyword",w[M.COMMA]=",",w[M.OBRACES]="{",w[M.CBRACES]="}",w[M.OPAREN]="(",w[M.CPAREN]=")",w[M.OSQUARE]="[",w[M.CSQUARE]="]",w[M.ASSIGN]="=",w[M.ADD]="+",w[M.SUB]="-",w[M.MUL]="*",w[M.DIV]="/",w[M.POW]="^",w[M.EQUALS]="==",w[M.NOTEQUALS]="!=",w[M.NOT]="!",w[M.GT]=">",w[M.LT]="<",w[M.GTE]=">=",w[M.LTE]="<=",w[M.AND]="&&",w[M.OR]="||",w[M.COLON]=":",w[M.DOT]=".",w[M.EOF]="End of File",w[M.BITWISE_AND]="&",w[M.BITWISE_OR]="|",w[M.BITWISE_NOT]="~",w),D={"*":M.MUL,"/":M.DIV,"+":M.ADD,"-":M.SUB,"(":M.OPAREN,")":M.CPAREN,"^":M.POW,"{":M.OBRACES,"}":M.CBRACES,",":M.COMMA,"[":M.OSQUARE,"]":M.CSQUARE,";":M.ENDSTATEMENT,":":M.COLON,".":M.DOT,"=":M.ASSIGN,">":M.GT,"<":M.LT,"!":M.NOT,"|":M.BITWISE_OR,"&":M.BITWISE_AND,"~":M.BITWISE_NOT},L={"==":M.EQUALS,"!=":M.NOTEQUALS,">=":M.GTE,"<=":M.LTE,"+=":M.ASSIGN,"-=":M.ASSIGN,"*=":M.ASSIGN,"/=":M.ASSIGN,"&&":M.AND,"||":M.OR},U={},G=["__add__","__subtract__","__multiply__","__divide__","__pow__","__eq__","__gt__","__lt__","__and__","__or__","__bool__","__setProperty__","__getProperty__","__call__"],z={},F=function(){function e(e,t,n,r){void 0===r&&(r="(unknown)"),this.idx=e,this.ln=t,this.col=n,this.file=r}return e.prototype.advance=function(e){return void 0===e&&(e=""),this.idx++,this.col++,"\n"===e&&(this.ln++,this.col=0),this},Object.defineProperty(e.prototype,"clone",{get:function(){return new e(this.idx,this.ln,this.col,this.file)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"str",{get:function(){return"File ".concat(this.file,", ").concat(this.ln+1,":").concat(this.col+1)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"isUnknown",{get:function(){return-2===this.idx},enumerable:!1,configurable:!0}),Object.defineProperty(e,"unknown",{get:function(){return new e(-2,-2,-2,"(unknown)")},enumerable:!1,configurable:!0}),e}();function W(e,t,n){var r,o=e;(e=t.__closure__).path=o.path;var i=t.__value__,a=function(e,t,n){var r=new Ze;r.parent=n;for(var o=Math.max(e.length,t.arguments_.length),i=0;i<o;i++){var a=new ee,s=z.any;if(t.arguments_[i]){var c=t.arguments_[i];if(!(c.type instanceof K))return new Lt(F.unknown,"Type",typeof c.type,c.type);if(e[i]instanceof qt&&(s=e[i].__type__,a=e[i]),!c.type.includesType({context:n},s).bool().valueOf())return new Lt(F.unknown,c.type.__name__,s.__name__,At(a));r.setOwn(c.name,a,{forceThroughConst:!0})}}var u=r.setOwn("args",new ye(e),{forceThroughConst:!0});return u instanceof Mt?u:r}(n,t,e);if(a instanceof Mt)return a;var s=null!==(r=t.this_)&&void 0!==r?r:new re;if(!(s instanceof re))return new Lt(F.unknown,"object",typeof s,s,"'this' must be an object");var c=a.setOwn("this",s);return c instanceof Mt?c:i instanceof it?function(e,t,n,r){var o,i,a,s,c=r.interpret(t);return c.error?c.error:(void 0!==c.funcReturn&&(c.val=c.funcReturn,c.funcReturn=void 0),!1===e.returnType.includesType({context:t},null!==(i=null===(o=c.val)||void 0===o?void 0:o.__type__)&&void 0!==i?i:z.any).valueOf()?new Lt(F.unknown,e.returnType.__name__,(null===(a=c.val)||void 0===a?void 0:a.typeName().valueOf())||"undefined",null===(s=c.val)||void 0===s?void 0:s.str().valueOf(),"(from function return)"):c.val?c.val:new ee)}(t,a,0,i):"function"==typeof i?function(e,t,n,r){for(var o=n.length;o<r.length;o++)n.push(new ee);var i=r.apply(void 0,function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([{context:t}],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(n),!1));return i instanceof Mt||i instanceof qt?i:new ee}(0,a,n,i):new Lt(F.unknown,"function",typeof i)}var V=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},q=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function H(e,t,n,r,o){if(!(t instanceof K))return new Lt(F.unknown,"Type",typeof t,t);var i=new ie((function(e){for(var i=e.context,a=[],s=1;s<arguments.length;s++)a[s-1]=arguments[s];var c=new Ze;if(c.parent=i,t.__extends__){var u=H(c,t.__extends__,n,r,o);if(u instanceof Mt)return u}var l=null==t?void 0:t.__init__;if(l){l.this_=r,l.__closure__=c;var f=l.__call__.apply(l,q([{context:c}],V(a),!1));return f instanceof Mt?f:void 0}}),void 0,"super",r),a=e.setOwn("super",i);if(a instanceof Mt)return a;var s=Y(t,{context:e},[],!1,n);return s instanceof Mt?s:void 0}function Y(e,t,n,r,o){var i,a,s,c,u=t.context;if(void 0===r&&(r=!0),void 0===o&&(o={}),e.__isPrimitive__){if(n.length<1)return new ee;switch(e.__name__){case"Undefined":case"Type":return n.length<1?new K:new ve(n[0].__type__.__name__);case"String":return new ve(n[0].str().valueOf());case"Array":return new ye(n);case"Number":return new se(n[0].valueOf());case"Function":return new ie(n[0].valueOf());case"Boolean":return new ue(n[0].bool().valueOf());default:return Oe(n[0])}}var l=new Ze;l.parent=null===(c=e.__init__)||void 0===c?void 0:c.__closure__;var f,p=new re;if(e.__extends__&&(f=H(l,e.__extends__,o,p,u))instanceof Mt)return f;p.__value__=o;try{for(var d=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new Lt(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e.__methods__),y=d.next();!y.done;y=d.next()){var h=y.value,v=h.clone();v.this_=p,o[h.name]=v,-1!==G.indexOf(h.name)&&(p[h.name]=v.__call__)}}catch(e){i={error:e}}finally{try{y&&!y.done&&(a=d.return)&&a.call(d)}finally{if(i)throw i.error}}return r&&e.__init__&&(e.__init__.this_=p,e.__init__.__closure__=l,(f=(s=e.__init__).__call__.apply(s,q([{context:l}],V(n),!1)))instanceof Mt)?f:(p.__type__=e,e.__instances__.push(p),p)}var Q=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),K=function(e){function t(n,r,o,i,a){void 0===n&&(n=!1),void 0===r&&(r="(anon)"),void 0===o&&(o=[]);var s=e.call(this,void 0,null==z?void 0:z.type)||this;return s.__instances__=[],s.clone=function(){return new t(s.__isPrimitive__,s.__name__,s.__methods__,s.__extends__,s.__init__)},s.isa=function(e,t){return new ue(t===z.type)},s.cast=function(e,t){return new Ft("cast",s)},s.includesType=function(e,t){var n,r,o,i,a,c;return s.equals(e,z.any).bool().valueOf()||t.equals(e,z.any).bool().valueOf()||!0===(null===(n=s.__extends__)||void 0===n?void 0:n.equals(e,t).valueOf())||!0===(null===(r=s.__extends__)||void 0===r?void 0:r.equals(e,z.any).valueOf())||!0===(null===(o=s.__extends__)||void 0===o?void 0:o.includesType(e,t).valueOf())||!0===(null===(i=t.__extends__)||void 0===i?void 0:i.equals(e,s).valueOf())||!0===(null===(a=t.__extends__)||void 0===a?void 0:a.equals(e,z.any).valueOf())||!0===(null===(c=t.__extends__)||void 0===c?void 0:c.includesType(e,s).valueOf())?new ue(!0):s.equals(e,t)},s.equals=function(e,t){return new ue(t.__name__===s.__name__&&t.__isPrimitive__===s.__isPrimitive__&&Object.is(s.valueOf(),t.valueOf()))},s.__call__=function(e){for(var t=e.context,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return Y(s,{context:t},n||[])},s.str=function(){return new ve("<Type: ".concat(s.__name__,">"))},s.__bool__=function(){return new ue(!0)},s.bool=s.__bool__,s.__getProperty__=function(e,t){if(s.self.hasOwnProperty(At(t))){var n=s.self[At(t)];return"function"==typeof n?new ie(n):Oe(n)}return new zt(F.unknown,t.valueOf(),s)},s.__isPrimitive__=n,s.__name__=r,s.info.name=r,s.__extends__=i,s.__methods__=o,a&&(a.name=r,s.__init__=a),z.type||(s.__type__=s),s}return Q(t,e),t}(qt),X=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),J=function(e){function t(n){void 0===n&&(n=new Mt(F.unknown,"Unknown","Error not specified"));var r=e.call(this,n,z.error)||this;return r.__getProperty__=function(e,t){if(r.self.hasOwnProperty(At(t))){var n=r.self[At(t)];return"function"==typeof n?new ie(n):Oe(n)}return new zt(F.unknown,t.valueOf(),r)},r.cast=function(e){return new Mt(F.unknown,"TypeError","Cannot cast type 'error'")},r.str=function(){return new ve("<Error: ".concat(r.valueOf().str,">"))},r.__eq__=function(e,n){return new ue(n instanceof t&&r.valueOf().constructor===n.valueOf().constructor)},r.__bool__=function(){return new ue(!0)},r.bool=r.__bool__,r.clone=function(){return new t(r.valueOf())},r}return X(t,e),t}(qt),Z=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ee=function(e){function t(){var n=e.call(this,void 0,z.undefined)||this;return n.cast=function(e,n){var r=e.context;switch(n){case z.number:return new se;case z.string:return new ve;case z.array:return new ye;case z.undefined:return new t;case z.type:return new K;case z.error:return new J;case z.object:case z.any:return new re;case z.function:return new ie((function(){}));case z.boolean:return new ue;default:return n instanceof K?n.__call__({context:r}):new Mt(F.unknown,"TypeError","Cannot cast to type '".concat(At(n.typeName()),"'"))}},n.str=function(){return new ve("<Undefined>")},n.__eq__=function(e,n){return new ue(n instanceof t||void 0===n||void 0===n.valueOf())},n.__bool__=function(){return new ue},n.bool=n.__bool__,n.clone=function(){return new t},n.__getProperty__=function(e,t){if(n.self.hasOwnProperty(At(t))){var r=n.self[At(t)];return"function"==typeof r?new ie(r):Oe(r)}return new zt(F.unknown,t.valueOf(),n)},n.info={name:"undefined",description:"Not defined, not a value.",file:"built-in",isBuiltIn:!0},n}return Z(t,e),t}(qt),te=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ne=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new Lt(t?"Object is not iterable.":"Symbol.iterator is not defined.")},re=function(e){function t(n){void 0===n&&(n={});var r=e.call(this,n,z.object)||this;return r.isa=function(e,t){return t===z.object?new ue(!0):t instanceof K?r.__type__.includesType(e,t):new Lt(F.unknown,"TypeError","type",At(t.typeName()),At(t))},r.cast=function(e,t){return t===z.number?new se(r.valueOf()?1:0):new Mt(F.unknown,"TypeError","Cannot cast boolean to type '".concat(At(t.typeName()),"'"))},r.str=function(){var e=At(r.valueOf());return"\n"===e[e.length-1]&&(e=e.substr(0,e.length-1)),new ve("<ESObject ".concat(e,">"))},r.__eq__=function(e,n){var o,i,a=e.context;if(!(n instanceof t))return new ue;if(n.keys.length!==r.keys.length)return new ue;try{for(var s=ne(r.keys),c=s.next();!c.done;c=s.next()){var u=c.value.valueOf(),l=r.valueOf()[u],f=n.valueOf()[u];if(l){if(!l.__eq__)return new ue;var p=l.__eq__({context:a},f);if(p instanceof Mt)return p;if(!p.valueOf())return new ue}else if(f)return new ue}}catch(e){o={error:e}}finally{try{c&&!c.done&&(i=s.return)&&i.call(s)}finally{if(o)throw o.error}}return new ue(!0)},r.__bool__=function(){return new ue(!0)},r.bool=r.__bool__,r.__add__=function(e,n){var o,i,a,s,c=e.context;if(!(n instanceof t))return new Lt(F.unknown,"object",n.typeName().valueOf(),n);var u={};try{for(var l=ne(r.keys),f=l.next();!f.done;f=l.next()){var p=(h=f.value).valueOf();if((v=r.__getProperty__({context:c},h))instanceof Mt)return v;u[p]=v}}catch(e){o={error:e}}finally{try{f&&!f.done&&(i=l.return)&&i.call(l)}finally{if(o)throw o.error}}try{for(var d=ne(n.keys),y=d.next();!y.done;y=d.next()){var h;if(p=(h=y.value).valueOf(),!u.hasOwnProperty(p)){var v;if((v=n.__getProperty__({context:c},h))instanceof Mt)return v;u[p]=v}}}catch(e){a={error:e}}finally{try{y&&!y.done&&(s=d.return)&&s.call(d)}finally{if(a)throw a.error}}return new t(u)},r.__subtract__=function(e,n){var o,i,a=[];if(n instanceof ve)a=[At(n)];else{if(!(n instanceof ye))return new Lt(F.unknown,"array | string",n.typeName().valueOf(),n);a=Te(n,e)}if(!Array.isArray(a))return new Lt(F.unknown,"array | string",n.typeName().valueOf(),n);var s={};try{for(var c=ne(r.keys),u=c.next();!u.done;u=c.next()){var l=u.value,f=l.valueOf();if(-1===a.indexOf(f)){var p=r.__getProperty__(e,l);if(p instanceof Mt)return p;s[f]=p}}}catch(e){o={error:e}}finally{try{u&&!u.done&&(i=c.return)&&i.call(c)}finally{if(o)throw o.error}}return new t(s)},r.__getProperty__=function(e,t){if(!(t instanceof ve))return new Lt(F.unknown,"string",t.typeName(),At(t));var n=t.valueOf();if(r.valueOf().hasOwnProperty(n))return r.valueOf()[n];if(r.self.hasOwnProperty(n)){var o=r.self[n];return"function"==typeof o?new ie(o):Oe(o)}return new ee},r.__setProperty__=function(e,t,n){if(!(t instanceof ve))return new Lt(F.unknown,"string",t.typeName(),At(t));r.__value__[t.valueOf()]=n},r.hasProperty=function(e,t){var n=At(t);return r.valueOf().hasOwnProperty(At(n))?new ue(!0):new ue(r.hasOwnProperty(n))},r.clone=function(){var e,n,o=new t,i={},a=r.valueOf();try{for(var s=ne(Object.keys(a)),c=s.next();!c.done;c=s.next()){var u=c.value;i[u]=a[u]}}catch(t){e={error:t}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(e)throw e.error}}return o.__value__=i,o},r}return te(t,e),Object.defineProperty(t.prototype,"keys",{get:function(){return Object.keys(this.valueOf()).map((function(e){return new ve(e)}))},set:function(e){},enumerable:!1,configurable:!0}),t}(qt),oe=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ie=function(e){function t(n,r,o,i,a,s){void 0===n&&(n=function(){}),void 0===r&&(r=[]),void 0===o&&(o="(anon)"),void 0===i&&(i=new re),void 0===a&&(a=z.any),void 0===s&&(s=x);var c=e.call(this,n,z.function)||this;return c.cast=function(e,t){return new Mt(F.unknown,"TypeError","Cannot cast type 'function'")},c.clone=function(){return new t(c.__value__,c.arguments_,c.name,c.this_,c.returnType,c.__closure__)},c.valueOf=function(){return c},c.str=function(){return new ve("<Func: ".concat(c.name,">"))},c.__eq__=function(e,n){return new ue(n instanceof t&&c.__value__===n.__value__)},c.__bool__=function(){return new ue(!0)},c.bool=c.__bool__,c.__call__=function(e){for(var t=e.context,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];return c.__closure__.path=t.path,W(c.__closure__,c,n)},c.__getProperty__=function(e,n){if(c.self.hasOwnProperty(At(n))){var r=c.self[At(n)];return"function"==typeof r?new t(r):Oe(r)}return new zt(F.unknown,n.valueOf(),c)},c.arguments_=r,c.info.name=o,c.this_=i,c.returnType=a,c.__closure__=s,c.info.returnType=At(a),c.info.args=r.map((function(e){return{name:e.name,defaultValue:At(e.defaultValue),type:e.type.info.name,required:!0}})),c}return oe(t,e),Object.defineProperty(t.prototype,"name",{get:function(){var e;return null!==(e=this.info.name)&&void 0!==e?e:"(anonymous)"},set:function(e){this.info.name=e},enumerable:!1,configurable:!0}),t}(qt),ae=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),se=function(e){function t(n){void 0===n&&(n=0);var r=e.call(this,n,z.number)||this;return r.cast=function(e,t){switch(t){case z.number:return r;case z.string:return r.str();case z.array:return new ye(new Array(r.valueOf()));default:return new Mt(F.unknown,"TypeError","Cannot cast to type '".concat(At(t.typeName()),"'"))}},r.str=function(){return new ve(r.valueOf().toString())},r.__add__=function(e,n){return n instanceof t?new t(r.valueOf()+n.valueOf()):new Lt(F.unknown,"Number",n.typeName().valueOf(),n.valueOf())},r.__subtract__=function(e,n){return n instanceof t?new t(r.valueOf()-n.valueOf()):new Lt(F.unknown,"Number",n.typeName().valueOf(),n.valueOf())},r.__multiply__=function(e,n){return n instanceof t?new t(r.valueOf()*n.valueOf()):new Lt(F.unknown,"Number",n.typeName().valueOf(),n.valueOf())},r.__divide__=function(e,n){return n instanceof t?new t(r.valueOf()/n.valueOf()):new Lt(F.unknown,"Number",n.typeName().valueOf(),n.valueOf())},r.__pow__=function(e,n){return n instanceof t?new t(Math.pow(r.valueOf(),n.valueOf())):new Lt(F.unknown,"Number",n.typeName().valueOf(),n.valueOf())},r.__eq__=function(e,n){return new ue(n instanceof t&&r.valueOf()===n.valueOf())},r.__gt__=function(e,n){return n instanceof t?new ue(r.valueOf()>n.valueOf()):new Lt(F.unknown,"Number",n.typeName().valueOf(),n.valueOf())},r.__lt__=function(e,n){return n instanceof t?new ue(r.valueOf()<n.valueOf()):new Lt(F.unknown,"Number",n.typeName().valueOf(),n.valueOf())},r.__bool__=function(){return new ue(r.valueOf()>0)},r.bool=r.__bool__,r.clone=function(){return new t(r.valueOf())},r.__getProperty__=function(e,t){if(r.self.hasOwnProperty(At(t))){var n=r.self[At(t)];return"function"==typeof n?new ie(n):Oe(n)}return new zt(F.unknown,t.valueOf(),r)},r}return ae(t,e),t}(qt),ce=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ue=function(e){function t(n){void 0===n&&(n=!1);var r=e.call(this,Boolean(n),z.bool)||this;return r.__getProperty__=function(e,t){if(r.self.hasOwnProperty(At(t))){var n=r.self[At(t)];return"function"==typeof n?new ie(n):Oe(n)}return new zt(F.unknown,t.valueOf(),r)},r.cast=function(e,t){return t===z.number?new se(r.valueOf()?1:0):new Mt(F.unknown,"TypeError","Cannot cast boolean to type '".concat(At(t.typeName()),"'"))},r.__eq__=function(e,n){return n instanceof t?new t(r.valueOf()===n.valueOf()):new Lt(F.unknown,"Boolean",n.typeName().valueOf(),n.valueOf())},r.__bool__=function(){return r},r.__and__=function(e,n){return new t(r.valueOf()&&n.bool().valueOf())},r.__or__=function(e,n){return new t(r.valueOf()||n.bool().valueOf())},r.str=function(){return new ve(r.valueOf()?"true":"false")},r.clone=function(){return new t(r.valueOf())},r.bool=function(){return r},r.info={name:At(n),description:"Boolean global constant which evaluates to ".concat(At(n),", the opposite of ").concat(At(!n)),file:"built-in",isBuiltIn:!0,helpLink:"https://en.wikipedia.org/wiki/Boolean_expression"},r}return ce(t,e),t}(qt),le=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fe=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},pe=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},de=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new Lt(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ye=function(e){function t(n){void 0===n&&(n=[]);var r=e.call(this,n,z.array)||this;return r.cast=function(e,t){switch(t){case z.number:return new se(r.len);case z.boolean:return r.bool();default:return new Mt(F.unknown,"TypeError","Cannot cast boolean to type '".concat(At(t.typeName()),"'"))}},r.str=function(){return new ve(At(r.valueOf()))},r.__eq__=function(e,n){var o=e.context;if(!(n instanceof t))return new ue;if(n.len!==r.len)return new ue;for(var i=0;i<r.len;i++){var a=r.valueOf()[i],s=n.valueOf()[i];if(a){if(!a.__eq__)return new ue;var c=a.__eq__({context:o},s);if(c instanceof Mt)return c;if(!c.valueOf())return new ue}else if(s)return new ue}return new ue(!0)},r.__add__=function(e,n){return e.context,n instanceof t?new t(pe(pe([],fe(r.valueOf()),!1),fe(n.valueOf()),!1)):new Lt(F.unknown,"array",n.typeName().valueOf(),n)},r.__bool__=function(){return new ue(r.valueOf().length>0)},r.bool=r.__bool__,r.__getProperty__=function(e,t){if(t instanceof ve&&r.self.hasOwnProperty(At(t))){var n=r.self[At(t)];return"function"==typeof n?new ie(n):Oe(n)}if(!(t instanceof se))return new ee;for(var o=t.valueOf();o<0;)o=r.valueOf().length+o;return o<r.valueOf().length?r.valueOf()[o]:new ee},r.add=function(e,t,n){if(void 0===n&&(n=new se(r.len-1)),!(t instanceof qt))throw"adding non-primitive to array: "+At(t);return r.len++,r.__value__.splice(n.valueOf(),0,t),new se(r.len)},r.contains=function(e,t){var n,o;try{for(var i=de(r.__value__),a=i.next();!a.done;a=i.next()){var s=a.value;if(t.valueOf()==s.valueOf())return!0}}catch(e){n={error:e}}finally{try{a&&!a.done&&(o=i.return)&&o.call(i)}finally{if(n)throw n.error}}return!1},r.clone=function(){var e,n,o=[];try{for(var i=de(r.valueOf()),a=i.next();!a.done;a=i.next()){var s=a.value;o.push(s)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return new t(o)},r.len=n.length,r}return le(t,e),t.prototype.__setProperty__=function(e,t,n){if(t instanceof se){n instanceof qt||(n=Oe(n));for(var r=t.valueOf();r<0;)r=this.valueOf().length+r;this.__value__[r]=n}},t}(qt),he=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ve=function(e){function t(n){void 0===n&&(n="");var r=e.call(this,n,z.string)||this;return r.str=function(){return r},r.cast=function(e,n){switch(n){case z.number:var o=parseFloat(r.valueOf());return isNaN(o)?new Mt(F.unknown,"TypeError","This string is not a valid number"):new se(o);case z.string:return r;case z.array:return new ye(r.valueOf().split("").map((function(e){return new t(e)})));default:return new Mt(F.unknown,"TypeError","Cannot cast to type '".concat(At(n.typeName()),"'"))}},r.__add__=function(e,n){return n instanceof t?new t(r.valueOf()+n.valueOf()):new Lt(F.unknown,"String",n.typeName().valueOf(),n.valueOf())},r.__multiply__=function(e,n){return n instanceof se?new t(r.valueOf().repeat(n.valueOf())):new Lt(F.unknown,"Number",n.typeName().valueOf(),n.valueOf())},r.__eq__=function(e,n){return new ue(n instanceof t&&r.valueOf()===n.valueOf())},r.__gt__=function(e,n){return n instanceof t?new ue(r.valueOf().length>n.valueOf().length):new Lt(F.unknown,"String",n.typeName().valueOf(),n.valueOf())},r.__lt__=function(e,n){return n instanceof t?new ue(r.valueOf().length<n.valueOf().length):new Lt(F.unknown,"String",n.typeName().valueOf(),n.valueOf())},r.__bool__=function(){return new ue(r.valueOf().length>0)},r.bool=r.__bool__,r.len=function(){return new se(r.valueOf().length)},r.clone=function(){return new t(r.valueOf())},r.__getProperty__=function(e,n){if(n instanceof t&&r.self.hasOwnProperty(At(n))){var o=r.self[At(n)];return"function"==typeof o?new ie(o):Oe(o)}if(!(n instanceof se))return new t;for(var i=n.valueOf();i<0;)i=r.valueOf().length+i;return i<r.valueOf().length?new t(r.valueOf()[i]):new t},r}return he(t,e),t.prototype.__setProperty__=function(e,n,r){if(n instanceof se){r instanceof t||(r=new t(At(r)));for(var o=n.valueOf();o<0;)o=this.valueOf().length+o;var i=r.str().valueOf(),a=this.__value__.substr(0,o),s=this.__value__.substr(o+i.length);this.__value__=a+i+s}},t}(qt),me=function e(t,n,r){var o,i,a=this;void 0===r&&(r={}),this.clone=function(){return new e(a.value.clone(),a.identifier,{isConstant:a.isConstant,isAccessible:a.isAccessible})},this.str=function(){return new ve("<Symbol: ".concat(a.identifier,">"))},this.value=t,this.identifier=n,this.isConstant=null!==(o=r.isConstant)&&void 0!==o&&o,this.isAccessible=null===(i=r.isAccessible)||void 0===i||i},be=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),ge=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},we=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},xe=function(e){function t(n,r,o){void 0===r&&(r="<AnonNative>"),void 0===o&&(o=!1);var i=e.call(this,n,z.object)||this;return i.cast=function(e){return new Mt(F.unknown,"TypeError","Cannot cast native object")},i.clone=function(){return new t(i.__value__)},i.str=function(){try{return new ve(JSON.stringify(i.__value__))}catch(e){return new ve("".concat(i.__value__))}},i.__eq__=function(e,t){return new ue(i===t)},i.__bool__=function(){return new ue(!0)},i.bool=i.__bool__,i.__getProperty__=function(e,n){var r=At(n),o=i.valueOf(),a=o[r];if(void 0===a){if(i.self.hasOwnProperty(r)){var s=i.self[At(r)];return"function"==typeof s?new ie(s):Oe(s)}return new zt(F.unknown,r,i)}return a instanceof qt?a:"function"==typeof a?new ie((function(t){t.context;for(var n=[],i=1;i<arguments.length;i++)n[i-1]=arguments[i];return o[r].apply(o,we([],ge(n.map((function(t){return Te(t,e)}))),!1))})):new t(a)},i.__call__=function(e){for(var n,r,o=[],a=1;a<arguments.length;a++)o[a-1]=arguments[a];if("function"!=typeof i.__value__)return new Lt(F.unknown,"function",typeof i.__value__,At(i));try{r=new((n=i.__value__).bind.apply(n,we([void 0],ge(o.map((function(t){return Te(t,e)}))),!1)))}catch(t){r=i.__value__.apply(i,we([],ge(o.map((function(t){return Te(t,e)}))),!1))}return r instanceof qt?r:new t(r)},i.hasProperty=function(e,t){return new ue(!(i.__getProperty__(e,t)instanceof Mt))},i.info.name=At(r),i}return be(t,e),t}(qt),_e=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Se=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};function Oe(e,t){return void 0===t&&(t=!1),e instanceof qt?e:null==e?new ee:e instanceof Mt?new J(e):e instanceof me?e.value:"number"==typeof e?new se(e):"string"==typeof e?new ve(e):"boolean"==typeof e?new ue(e):"bigint"==typeof e?new se(Number(e)):"symbol"==typeof e?new ve(String(e)):new xe(e,void 0,t)}function Te(e,t){if(null!=e){if(!(e instanceof qt))return e;if(e instanceof ye)return e.valueOf().map((function(e){return Te(e,t)}),t);if(e instanceof re){var n={};for(var r in e.valueOf())n[r]=Te(e.valueOf()[r],t);return n}if(!(e instanceof ee))return e instanceof ie?function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=e.__call__.apply(e,Se([t],_e(n.map((function(e){return Oe(e)}))),!1));return o instanceof Mt?o:Te(o,t)}:e instanceof K?e:e.valueOf()}}var ke,Pe,Ce={red:31,yellow:33,green:32,cyan:36,blue:34,grey:2},Ee={},Ae=function(e){Ee[e]=function(t){return t||(t=""),C?"[".concat(Ce[e],"m")+t+"[0m":'<span style="color: '.concat(e,'">').concat(t,"</span>")}};try{for(var Ie=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.keys(Ce)),je=Ie.next();!je.done;je=Ie.next())Ae(je.value)}catch(e){ke={error:e}}finally{try{je&&!je.done&&(Pe=Ie.return)&&Pe.call(Ie)}finally{if(ke)throw ke.error}}const Re=Ee;var Be=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Me=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Ne=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new Lt(t?"Object is not iterable.":"Symbol.iterator is not defined.")},De={range:[function(e,t){if(e.context,!(t instanceof se))return new Lt(F.unknown,"Number",t.typeName().valueOf(),t.valueOf());var n=t.valueOf();try{return new ye(Me([],Be(Array(n).keys()),!1).map((function(e){return new se(e)})))}catch(e){return new Mt(F.unknown,"RangeError","Cannot make range of length '".concat(At(t),"'"))}},{args:[{name:"N",type:"Number"}],description:"Generates an array of integers given N. Starts at 0 and goes to N-1. Can be used like for i in range(10) ..., similarly to python.",returns:"array of numbers from 0 to N-1",returnType:"number[] | RangeError"}],log:[function(e){e.context;for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];console.log.apply(console,Me([],Be(t.map((function(e){return At(e)}))),!1))},{args:[{name:"...values",type:"any[]"}],description:"Uses console.log to log all values",returnType:"void"}],parseNum:[function(e,t){e.context;try{var n=parseFloat(At(t));return isNaN(n)?new Mt(F.unknown,"TypeError","Cannot convert '".concat(At(t),"' to a number.")):new se(n)}catch(e){return new Mt(F.unknown,"TypeError","Cannot convert '".concat(At(t),"' to a number."))}},{args:[{name:"num",type:"any"}],description:"Converts a string of digits into a number. Works with decimals and integers. Calls .str() on value before using native JS 'parseFloat' function. Returns TypeError if the string can't be converted into a number.",returnType:"number | TypeError"}],help:[function(e){e.context;for(var t,n,r,o,i,a,s=[],c=1;c<arguments.length;c++)s[c-1]=arguments[c];if(!s.length)return new ve("Visit https://entropygames.io/entropy-script for help with Entropy Script!\nTry 'help(<anything>)' for help about a particular object.");var u="";try{for(var l=Ne(s),f=l.next();!f.done;f=l.next()){var p=f.value;if(!(p instanceof qt))return void console.log("Invalid arg not primitive: "+At(p));var d=p.info;if(u+="".concat(Re.yellow("Help on '".concat(d.name||"(anonymous)","'")),":\n    \n    ").concat(Re.yellow("Value"),": ").concat(jt(jt(At(p))),"\n    ").concat(Re.yellow("Type"),": '").concat(At(p.typeName()),"'\n    ").concat(Re.yellow("Location"),": ").concat(d.file||Re.yellow("(unknown)"),"\n    \n        ").concat(Re.green(d.description)||"No description.","\n        \n    ").concat(d.helpLink?Re.cyan(d.helpLink+"\n\n"):"","\n"),d.args&&p instanceof ie){var y=d.args.length,h=d.args.filter((function(e){return e.required})).length;u+=y==h?Re.yellow("    Arguments (".concat(y,"): \n")):Re.yellow("    Arguments (".concat(h,"-").concat(y,"): \n"));try{for(var v=(r=void 0,Ne(d.args.entries())),m=v.next();!m.done;m=v.next()){var b=Be(m.value,2),g=b[0],w=b[1];u+="object"!=typeof w?"        ".concat(g+1,". INVALID ARG INFO"):"        ".concat(g+1,". ").concat(w.name).concat(!1===w.required?Re.yellow(" (optional) "):" ","{").concat(w.type,"} ").concat(w.description||"","\n")}}catch(e){r={error:e}}finally{try{m&&!m.done&&(o=v.return)&&o.call(v)}finally{if(r)throw r.error}}u+="\n\n",d.returns&&(u+="    Returns: ".concat(d.returns,"\n\n")),d.returnType&&(u+="    Return Type: ".concat(d.returnType,"\n\n"))}if(d.contents&&(p instanceof re||p instanceof Yt)){u+="    Properties: \n      ";try{for(var x=(i=void 0,Ne(d.contents)),_=x.next();!_.done;_=x.next()){var S=_.value;u+=S.name+"\n      "}}catch(e){i={error:e}}finally{try{_&&!_.done&&(a=x.return)&&a.call(x)}finally{if(i)throw i.error}}}}}catch(e){t={error:e}}finally{try{f&&!f.done&&(n=l.return)&&n.call(l)}finally{if(t)throw t.error}}return console.log(u),s.length>1?new ye(s):s?s[0]:void 0},{args:[{name:"value",type:"any"}],description:"logs info on value",returns:"value passed in"}],delete:[function(e,t){var n=e.context,r=At(t);if(!n.has(r))return new Mt(F.unknown,"DeleteError","Identifier '".concat(r,"' not found in the current context"));n.set(r,new ee)},{name:"delete",args:[{name:"identifier",type:"string"}],description:"Deletes a variable from the current context"}],__path:[function(e){var t=e.context;return new ve(t.path)},{name:"__path",args:[],description:"Returns the current path"}],__symbols:[function(e){return Oe(e.context.keys)},{name:"__allSymbols",args:[],description:"Returns an array of the names of all symbols in the current context"}],using:[function(e,t,n){var r,o,i=e.context;if(!(t instanceof Yt||t instanceof xe))return new Lt(F.unknown,"Namespace",At(t.typeName()));var a=!0;n&&(n.bool().valueOf()||(a=!1));var s=t.valueOf();a?i=i.root:i.parent&&(i=i.parent);try{for(var c=Ne(Object.keys(s)),u=c.next();!u.done;u=c.next()){var l=u.value;i.setOwn(l,s[l].value,{isConstant:s[l].isConstant,isAccessible:s[l].isAccessible,forceThroughConst:!0})}}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}},{name:"using",args:[{name:"module",type:"namespace"},{name:"global",type:"bool"}],description:"Adds contents of a namespace to the global context"}],sleep:[function(e,t,n){var r=e.context;return t instanceof se?n instanceof ie?void It(t.valueOf()).then((function(){var e=n.__call__({context:r});e instanceof Mt&&console.log(e.str)})):new Lt(F.unknown,"function",At(n.typeName()),At(n)):new Lt(F.unknown,"number",At(t.typeName()),At(t))},{name:"sleep",args:[{name:"n",type:"number"},{name:"callback",type:"function"}],description:"Waits n milliseconds and then executes the callback"}]};var Le={ascii:{asciiToChar:function(e,t){return t instanceof se?new ve(String.fromCharCode(t.valueOf())):new Lt(F.unknown,"number",At(t.typeName()),At(t))},charToAscii:function(e,t){return t instanceof ve?new se(At(t).charCodeAt(0)):new Lt(F.unknown,"string",At(t.typeName()),At(t))}},json:{parse:function(e,t){return new re(JSON.parse(At(t)))},stringify:function(e,t){return t instanceof re?new ve(JSON.stringify(Te(t,e))):new Lt(F.unknown,"object",At(t.typeName()),At(t))}}},Ue={};function Ge(e,t){var n,r,o={},i=e.valueOf();try{for(var a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.keys(i)),s=a.next();!s.done;s=a.next()){var c=s.value;o[c]=new me(i[c],c)}}catch(e){n={error:e}}finally{try{s&&!s.done&&(r=a.return)&&r.call(a)}finally{if(n)throw n.error}}return new xe(o,t)}function ze(e){return e in Le||e in Ue}function Fe(e){if(e in Ue)return Ue[e];if(e in Le){var t=Ge(new xe(Le[e]),e);return Ue[e]=t,t}}var We=function(){function e(e,t,n){void 0===n&&(n=void 0),this.type=t,this.value=n,this.pos=e}return e.prototype.matches=function(e,t){return this.type===e&&this.value===t},e}(),Ve=function(){function e(e,t){this.text=e,this.position=new F(-1,0,-1,t),this.advance()}return e.prototype.advance=function(){this.position.advance(this.currentChar),this.currentChar=this.text[this.position.idx]},e.prototype.generate=function(){if(!this.text)return[new We(this.position,M.EOF)];for(var e=[];void 0!==this.currentChar;)if(" \t\n".includes(this.currentChar))this.advance();else if(T.includes(this.currentChar))e.push(this.makeNumber());else if(this.currentChar==="//"[0]&&this.text[this.position.idx+1]==="//"[1])this.singleLineComment();else if(this.currentChar==="/*"[0]&&this.text[this.position.idx+1]==="/*"[1])this.multiLineComment();else if(k.includes(this.currentChar))e.push(this.makeIdentifier());else if(-1!==P.indexOf(this.currentChar))e.push(this.makeString());else{var t=this.currentChar,n=this.unknownChar();if(!n){var r=this.position.clone,o=this.currentChar;return this.advance(),new Nt(r,o)}n.type===M.ASSIGN&&(n.value=t),e.push(n)}return e.push(new We(this.position,M.EOF)),e},e.prototype.makeNumber=function(){for(var e=this.position.clone,t="",n=0;void 0!==this.currentChar&&(T+"._").includes(this.currentChar);){if("."===this.currentChar){if(1===n)break;n++,t+="."}else"_"!==this.currentChar&&(t+=this.currentChar);this.advance()}return new We(e,M.NUMBER,parseFloat(t))},e.prototype.makeString=function(){var e=this.position.clone,t="",n=this.currentChar;for(this.advance();this.currentChar!==n&&void 0!==this.currentChar;)"\\"!==this.currentChar||(this.advance(),"n"!==this.currentChar)?(t+=this.currentChar,this.advance()):(t+="\n",this.advance());return this.advance(),new We(e,M.STRING,t)},e.prototype.makeIdentifier=function(){for(var e="",t=this.position.clone;void 0!==this.currentChar&&(k+T).includes(this.currentChar);)e+=this.currentChar,this.advance();var n=M.IDENTIFIER;return-1!==A.indexOf(e)&&(n=M.KEYWORD),new We(t,n,e)},e.prototype.unknownChar=function(){if(void 0!==this.currentChar){for(var e in U)if(e[0]===this.currentChar&&e[1]===this.text[this.position.idx+1]&&e[2]===this.text[this.position.idx+2]){var t=this.position.clone;return this.advance(),this.advance(),this.advance(),new We(t,U[e])}for(var n in L)if(n[0]===this.currentChar&&n[1]===this.text[this.position.idx+1])return t=this.position.clone,this.advance(),this.advance(),new We(t,L[n]);if(D.hasOwnProperty(this.currentChar)){t=this.position.clone;var r=D[this.currentChar];return this.advance(),new We(t,r)}}},e.prototype.singleLineComment=function(){for(this.advance();"\n"!==this.currentChar&&void 0!==this.currentChar;)this.advance();this.advance()},e.prototype.multiLineComment=function(){for(this.advance();this.currentChar!=="*/"[0]||this.text[this.position.idx+1]!=="*/"[1];)this.advance();this.advance(),this.advance()},e}(),qe=function(){function e(){this.advanceCount=0,this.lastRegisteredAdvanceCount=0,this.reverseCount=0}return e.prototype.registerAdvance=function(){this.advanceCount=1,this.lastRegisteredAdvanceCount++},e.prototype.register=function(e){return this.lastRegisteredAdvanceCount=e.advanceCount,this.advanceCount+=e.advanceCount,e.error&&(this.error=e.error),e.node?e.node:new kt},e.prototype.tryRegister=function(e){if(!e.error)return this.register(e);this.reverseCount+=e.advanceCount},e.prototype.success=function(e){return this.node=e,this},e.prototype.failure=function(e){return this.error=e,this},e}(),He=function(){function e(e){this.tokens=e,this.tokenIdx=-1,this.currentToken=e[0],this.advance()}return e.prototype.parse=function(){var e;if(!this.currentToken||!this.tokens||1===this.tokens.length&&this.tokens[0].type===M.EOF)return new qe;var t=this.statements(!0);return t.error||this.currentToken.type===R.EOF?t:t.failure(new Dt(null===(e=this.currentToken)||void 0===e?void 0:e.pos,"Expected 'End of File', got token of type'".concat(N[this.currentToken.type],"' of value ").concat(this.currentToken.value)))},e.prototype.advance=function(e){return e&&e.registerAdvance(),this.tokenIdx++,this.currentToken=this.tokens[this.tokenIdx],this.currentToken},e.prototype.reverse=function(e){return void 0===e&&(e=1),this.tokenIdx-=e,this.currentToken=this.tokens[this.tokenIdx],this.currentToken},e.prototype.consume=function(e,t,n){if(this.currentToken.type!==t)return e.failure(new Dt(this.currentToken.pos,null!=n?n:"Expected '".concat(N[t],"' but got '").concat(N[this.currentToken.type],"'")));this.advance(e)},e.prototype.clearEndStatements=function(e){for(;this.currentToken.type===M.ENDSTATEMENT;)this.advance(e)},e.prototype.statements=function(e){void 0===e&&(e=!1);var t=new qe,n=this.currentToken.pos,r=[];this.clearEndStatements(t);var o=t.register(this.statement());if(!o)return t;if(r.push(o),t.error)return t;for(var i=!0;;){for(var a=0;this.currentToken.type===M.ENDSTATEMENT;)this.advance(t),a++;if(0===a&&(i=!1),!i)break;var s=t.tryRegister(this.statement());s?r.push(s):this.reverse(t.reverseCount)}this.clearEndStatements(t);var c=new ht(n,r);return e&&(c=new pt(n,r,!0)),t.success(c)},e.prototype.statement=function(){var e=new qe,t=this.currentToken.pos;if(this.currentToken.matches(M.KEYWORD,"return")){this.advance(e);var n=new kt(this.currentToken.pos);if(this.currentToken.type!==M.ENDSTATEMENT){if(!(o=e.register(this.expr())))return e.failure(new Dt(this.currentToken.pos,"Expected end of statement"));n=o}return e.success(new bt(t,n))}if(this.currentToken.matches(M.KEYWORD,"yield")){this.advance(e);var r=new kt(this.currentToken.pos);if(this.currentToken.type!==M.ENDSTATEMENT){var o;if(!(o=e.register(this.expr())))return e.failure(new Dt(this.currentToken.pos,"Expected end of statement"));r=o}return e.success(new gt(t,r))}if(this.currentToken.matches(M.KEYWORD,"break"))return this.advance(e),e.success(new Pt(t));if(this.currentToken.matches(M.KEYWORD,"continue"))return this.advance(e),e.success(new Ct(t));var i=e.register(this.expr());return e.error?e:i?e.success(i):e.failure(new Dt(t,"No empty statements"))},e.prototype.atom=function(){var e=new qe,t=this.currentToken,n=this.currentToken.pos;switch(t.type){case M.NUMBER:return this.advance(e),e.success(new St(n,t));case M.STRING:return this.advance(e),e.success(new Ot(n,t));case M.IDENTIFIER:return this.atomIdentifier(e,n,t);case M.OPAREN:this.advance(e);var r=e.register(this.expr());return e.error?e:this.currentToken.type==M.CPAREN?(this.advance(e),e.success(r)):e.failure(new Dt(this.currentToken.pos,"Expected ')'"));case M.OSQUARE:var o=e.register(this.array());return e.error?e:e.success(o);case M.OBRACES:var i=e.register(this.object());return e.error?e:e.success(i);case M.KEYWORD:if("if"===t.value){var a=e.register(this.ifExpr());return e.error?e:e.success(a)}return e.failure(new Dt(this.currentToken.pos,"Invalid Identifier ".concat(t.value)));default:return e.failure(new Dt(this.currentToken.pos,"Expected number, identifier, '(', '+' or '-'"))}},e.prototype.atomIdentifier=function(e,t,n){this.advance(e);for(var r=new Tt(n),o=new kt(t),i=!1;-1!==[M.OPAREN,M.OSQUARE,M.DOT].indexOf(this.currentToken.type);)switch(this.currentToken.type){case M.OPAREN:i=!0;var a=r;if(r=e.register(this.makeFunctionCall(r,o)),o=a,e.error)return e;break;case M.OSQUARE:if(o=r,r=e.register(this.makeIndex(r)),e.error)return e;break;case M.DOT:if(this.advance(e),this.currentToken.type!==M.IDENTIFIER)return e.failure(new Dt(this.currentToken.pos,"Expected identifier after '.'"));o=r,r=new wt(this.currentToken.pos,r,new Ot(this.currentToken.pos,this.currentToken)),this.advance(e)}if(this.currentToken.type===M.ASSIGN){var s=this.currentToken.value;if(i)return e.failure(new Dt(t,"Cannot assign to return value of function"));this.advance(e);var c=e.register(this.expr());if(r instanceof Tt)r=new ct(t,r.a,c,s,!1);else{if(!(r instanceof wt))return e.failure(new Dt(t,"Cannot have node of type ".concat(this.currentToken.constructor.name,".\n                            Expected either index or variable node.")));r.value=c,r.assignType=s}if(e.error)return e}return e.success(r)},e.prototype.power=function(){var e=this;return this.binOp((function(){return e.atom()}),[R.POW],(function(){return e.factor()}))},e.prototype.factor=function(){var e=new qe,t=this.currentToken;switch(t.type){case M.SUB:case M.ADD:this.advance(e);var n=e.register(this.factor());return e.error?e:e.success(new st(t.pos,n,t));default:return this.power()}},e.prototype.term=function(){var e=this;return this.binOp((function(){return e.factor()}),[M.MUL,M.DIV])},e.prototype.arithmeticExpr=function(){var e=this;return this.binOp((function(){return e.term()}),[M.ADD,M.SUB])},e.prototype.comparisonExpr=function(){var e=this,t=new qe;if(this.currentToken.type===M.NOT){var n=this.currentToken;this.advance(t);var r=t.register(this.expr());return t.error?t:t.success(new st(n.pos,r,n))}var o=t.register(this.binOp((function(){return e.arithmeticExpr()}),[M.EQUALS,M.NOTEQUALS,M.GT,M.GTE,M.LTE,M.LT]));return t.error?t:t.success(o)},e.prototype.expr=function(){var e=this,t=new qe;if(this.clearEndStatements(t),this.currentToken.type===M.KEYWORD&&-1!==["var","let","global","mutable","const","local"].indexOf(this.currentToken.value))return this.initiateVar(t);if(this.currentToken.matches(R.KEYWORD,"if"))return this.ifExpr();if(this.currentToken.matches(R.KEYWORD,"while"))return this.whileExpr();if(this.currentToken.matches(R.KEYWORD,"for"))return this.forExpr();if(this.currentToken.matches(R.KEYWORD,"func"))return this.funcExpr();if(this.currentToken.matches(R.KEYWORD,"class"))return this.classExpr();if(this.currentToken.matches(R.KEYWORD,"namespace"))return this.namespace();var n=t.register(this.binOp((function(){return e.comparisonExpr()}),[M.AND,M.OR]));return t.error?t:t.success(n)},e.prototype.binOp=function(e,t,n){void 0===n&&(n=e);var r=new qe,o=r.register(e());if(r.error)return r;for(;-1!==t.indexOf(this.currentToken.type)||-1!==t.indexOf([this.currentToken.type,this.currentToken.value]);){var i=this.currentToken;this.advance(r);var a=r.register(n());if(r.error)return r;o=new at(o.pos,o,i,a)}return r.success(o)},e.prototype.typeExpr=function(){var e=new qe;if(this.currentToken.type!==M.IDENTIFIER)return e.failure(new Dt(this.currentToken.pos.clone,"Expected an identifier"));var t=this.currentToken;return this.advance(e),e.success(new Tt(t))},e.prototype.makeFunctionCall=function(e,t){void 0===t&&(t=new kt);var n=new qe,r=[],o=this.currentToken.pos;if(this.currentToken.type!==M.OPAREN)return n.failure(new Dt(o,"Expected '['"));if(this.advance(n),this.currentToken.type===M.CPAREN)return this.advance(n),n.success(new vt(o,e,[]));if(r.push(n.register(this.expr())),n.error)return n.failure(new Dt(this.currentToken.pos,"Invalid argument"));for(;this.currentToken.type===M.COMMA;)if(this.advance(n),r.push(n.register(this.expr())),n.error)return n;return this.currentToken.type!==M.CPAREN?n.failure(new Dt(this.currentToken.pos,"Expected ',' or ')'")):(this.advance(n),n.success(new vt(o,e,r)))},e.prototype.makeIndex=function(e){var t=new qe,n=this.currentToken.pos,r=e;if(this.currentToken.type!==M.OSQUARE)return t.failure(new Dt(n,"Expected '["));if(this.advance(t),this.currentToken.type===M.CSQUARE)return t.failure(new Dt(n,"Cannot index without expression"));var o=t.register(this.expr());return t.error?t.failure(new Dt(this.currentToken.pos,"Invalid index")):this.currentToken.type!==M.CSQUARE?t.failure(new Dt(this.currentToken.pos,"Expected ']'")):(this.advance(t),t.success(new wt(n,r,o)))},e.prototype.initiateVar=function(e){var t=this.currentToken.pos,n=!1,r=!1,o=!1,i=!1;if(this.currentToken.type===M.KEYWORD&&-1!==["var","let"].indexOf(this.currentToken.value)&&(i=!0,r=!0,this.advance(e),e.error))return e;if(this.currentToken.type===M.KEYWORD&&-1!==["global","local"].indexOf(this.currentToken.value)&&(i=!0,"global"===this.currentToken.value?o=!0:r=!0,this.advance(e),e.error))return e;if(this.currentToken.type===M.KEYWORD&&-1!==["const","mutable"].indexOf(this.currentToken.value)&&(i=!0,"const"===this.currentToken.value&&(n=!0),this.advance(e),e.error))return e;if(this.currentToken.type===M.KEYWORD)return e.failure(new Dt(this.currentToken.pos,"Expected Identifier 'var', 'let', 'const', 'mutable', 'local', or 'global', not ".concat(this.currentToken.value)));if(this.currentToken.type!==R.IDENTIFIER)return e.failure(new Dt(this.currentToken.pos,"Expected Identifier or Keyword"));var a=this.currentToken;this.advance(e);var s=z.any;if(this.currentToken.type===M.COLON&&(i=!0,this.consume(e,M.COLON),s=e.register(this.typeExpr())),this.currentToken.type!==M.ASSIGN)return n?e.failure(new Dt(t,"Cannot initialise constant to undefined")):e.success(new ct(t,a,new kt(this.currentToken.pos),"=",o,r,n,i,s));var c=this.currentToken.value;this.advance(e);var u=e.register(this.expr());return e.error?e:((u instanceof xt||u instanceof mt)&&(u.name=a.value),u instanceof _t&&(u.name=a.value,u.mutable=!n),e.success(new ct(t,a,u,c,o,r,n,i,s)))},e.prototype.bracesExp=function(){var e=new qe;if(this.consume(e,M.OBRACES),e.error)return e;if(this.clearEndStatements(e),this.currentToken.type===M.CBRACES)return this.advance(e),e.success(new kt(this.currentToken.pos));var t=e.register(this.statements());return e.error?e:(this.consume(e,M.CBRACES),e.error?e:e.success(t))},e.prototype.addEndStatement=function(e){this.tokens.splice(this.tokenIdx,0,new We(this.currentToken.pos,M.ENDSTATEMENT)),this.reverse(),this.advance(e)},e.prototype.ifExpr=function(){var e,t,n,r=new qe,o=this.currentToken.pos;if(!this.currentToken.matches(M.KEYWORD,"if"))return r.failure(new Dt(this.currentToken.pos,"Expected 'if'"));if(this.advance(r),n=r.register(this.expr()),r.error)return r;if(e=r.register(this.bracesExp()),r.error)return r;if(this.clearEndStatements(r),this.currentToken.matches(M.KEYWORD,"else"))if(this.advance(r),this.currentToken.type==M.OBRACES){if(t=r.register(this.bracesExp()),r.error)return r}else if(t=r.register(this.statement()),r.error)return r;return this.addEndStatement(r),r.success(new ut(o,n,e,t))},e.prototype.whileExpr=function(){var e,t,n=new qe,r=this.currentToken.pos;return this.currentToken.matches(M.KEYWORD,"while")?(this.advance(n),t=n.register(this.expr()),n.error?n:(e=n.register(this.bracesExp()),n.error?n:(this.addEndStatement(n),n.success(new lt(r,t,e))))):n.failure(new Dt(this.currentToken.pos,"Expected 'while'"))},e.prototype.parameter=function(e){var t,n=new Et(z.any);if(this.currentToken.type!==M.IDENTIFIER)return new Dt(this.currentToken.pos,"Expected identifier");if(t=this.currentToken.value,this.advance(e),this.currentToken.type===M.COLON){if(this.consume(e,M.COLON),e.error)return e.error;if(n=e.register(this.typeExpr()),e.error)return e.error}return{name:t,type:n}},e.prototype.funcCore=function(){var e,t=new qe,n=this.currentToken.pos,r=[],o=new Et(z.any);if(this.consume(t,M.OPAREN),this.currentToken.type===M.CPAREN)this.advance(t);else{var i=this.parameter(t);if(i instanceof Mt)return t.failure(i);for(r.push(i);this.currentToken.type===M.COMMA;){this.advance(t);var a=this.parameter(t);if(a instanceof Mt)return t.failure(a);r.push(a)}if(this.currentToken.type!==M.CPAREN)return t.failure(new Dt(this.currentToken.pos,"Expected ',' or ')'"));this.advance(t)}if(this.currentToken.type===M.COLON&&(this.advance(t),o=t.register(this.typeExpr()),t.error))return t;if(this.currentToken.type!==M.OBRACES){if(e=new bt(this.currentToken.pos,t.register(this.expr())),t.error)return t}else{if(this.consume(t,M.OBRACES),t.error)return t;if(e=this.currentToken.type!==M.CBRACES?t.register(this.statements()):new kt(this.currentToken.pos),this.consume(t,M.CBRACES),t.error)return t}return t.success(new mt(n,e,r,o))},e.prototype.funcExpr=function(){var e=new qe;if(!this.currentToken.matches(M.KEYWORD,"func"))return e.failure(new Dt(this.currentToken.pos,"Expected 'func'"));this.advance(e);var t=e.register(this.funcCore());return e.error?e:e.success(t)},e.prototype.classExpr=function(e){var t,n,r=new qe,o=this.currentToken.pos,i=[];if(!this.currentToken.matches(M.KEYWORD,"class"))return r.failure(new Dt(this.currentToken.pos,"Expected 'class'"));if(this.advance(r),this.currentToken.matches(M.KEYWORD,"extends")&&(this.advance(r),n=r.register(this.expr()),r.error))return r;if(this.consume(r,M.OBRACES),r.error)return r;if(this.currentToken.type===M.CBRACES)return this.advance(r),r.success(new xt(o,[],void 0,void 0,e));for(;this.currentToken.type===M.IDENTIFIER;){var a=this.currentToken.value;this.advance(r);var s=r.register(this.funcCore());if(r.error)return r;if(!(s instanceof mt))return r.failure(new Mt(this.currentToken.pos,"ParseError","Tried to get function, but got ".concat(s," instead")));s.name=a,"init"===a?t=s:i.push(s)}return this.consume(r,M.CBRACES),r.success(new xt(o,i,n,t,e))},e.prototype.forExpr=function(){var e,t,n,r=new qe,o=this.currentToken.pos,i=!1,a=!1;return this.currentToken.matches(M.KEYWORD,"for")?(this.advance(r),this.currentToken.matches(M.KEYWORD,"global")?(i=!0,this.advance(r)):this.currentToken.matches(M.KEYWORD,"const")?(a=!0,this.advance(r)):(this.currentToken.matches(M.KEYWORD,"var")||this.currentToken.matches(M.KEYWORD,"let"))&&this.advance(r),this.currentToken.type!==M.IDENTIFIER?r.failure(new Dt(this.currentToken.pos,"Expected identifier")):(n=this.currentToken,this.advance(r),this.currentToken.matches(M.KEYWORD,"in")?(this.advance(r),t=r.register(this.expr()),r.error?r:(e=r.register(this.bracesExp()),r.error?r:(this.addEndStatement(r),r.success(new ft(o,e,t,n,i,a))))):r.failure(new Dt(this.currentToken.pos,"Expected keyword 'in")))):r.failure(new Dt(this.currentToken.pos,"Expected 'for'"))},e.prototype.array=function(){var e=new qe,t=[],n=this.currentToken.pos;if(this.currentToken.type!==M.OSQUARE)return e.failure(new Dt(n,"Expected '["));if(this.advance(e),this.currentToken.type===M.CSQUARE)return this.advance(e),e.success(new pt(n,[]));if(t.push(e.register(this.expr())),e.error)return e.failure(new Dt(this.currentToken.pos,"Expected ']', 'var', 'if', 'for', 'while', number, identifier, '+', '-', '(', '[' or '!' 2"));for(;this.currentToken.type===M.COMMA;)if(this.advance(e),t.push(e.register(this.expr())),e.error)return e;return this.currentToken.type!==M.CSQUARE?e.failure(new Dt(this.currentToken.pos,"Expected ',' or ']'")):(this.advance(e),e.success(new pt(n,t)))},e.prototype.object=function(){var e=new qe,t=[],n=this.currentToken.pos;if(this.currentToken.type!==M.OBRACES)return e.failure(new Dt(n,"Expected '{"));if(this.advance(e),this.currentToken.type===M.CBRACES)return this.advance(e),e.success(new yt(n));for(;;){var r=void 0,o=void 0,i=void 0;if(this.currentToken.type===M.IDENTIFIER)r="id",o=new Ot(this.currentToken.pos,this.currentToken),this.advance(e);else if(this.currentToken.type===M.STRING)r="string",o=new Ot(this.currentToken.pos,this.currentToken),this.advance(e);else{if(this.currentToken.type!==M.OSQUARE)break;if(r="value",this.advance(e),o=e.register(this.expr()),e.error)return e;if(this.currentToken.type!==M.CSQUARE)return e.failure(new Dt(this.currentToken.pos,"Expected ']', got '".concat(N[this.currentToken.type],"'")));this.advance(e)}if(this.currentToken.type===M.COLON){if(this.advance(e),i=e.register(this.expr()),e.error)return e;if(this.currentToken.type!==M.COMMA&&this.currentToken.type!==M.CBRACES)return e.failure(new Dt(this.currentToken.pos,"Expected ',' or '}', got '".concat(N[this.currentToken.type],"'")));this.currentToken.type===M.COMMA&&this.advance(e)}else{if(this.currentToken.type!==M.COMMA&&this.currentToken.type!==M.CBRACES)return e.failure(new Dt(this.currentToken.pos,"Expected ',' or '}', got '".concat(N[this.currentToken.type],"'")));if("id"!==r)return e.failure(new Dt(this.currentToken.pos,"You must specify a value when initialising an object literal with a key that is not an identifier.\n                        Try using `key: value` syntax."));this.reverse(),i=new Tt(this.currentToken),this.advance(e),this.currentToken.type===M.COMMA&&this.advance(e)}if(t.push([o,i]),e.error)return e}return this.currentToken.type!==M.CBRACES?e.failure(new Dt(this.currentToken.pos,"Expected identifier, ',' or '}'")):(this.advance(e),e.success(new dt(n,t)))},e.prototype.namespace=function(){var e=new qe,t=this.currentToken.pos;if(this.consume(e,M.KEYWORD),e.error)return e;if(this.consume(e,M.OBRACES),e.error)return e;if(this.currentToken.type===M.CBRACES)return this.advance(e),e.success(new _t(t,new kt));var n=e.register(this.statements());return e.error?e:(this.consume(e,M.CBRACES),e.error?e:e.success(new _t(t,n)))},e}();var Ye=function(){return Ye=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Ye.apply(this,arguments)};function Qe(e,t,n,r,o,i){var a,s,c,u,l;return void 0===e&&(e=console.log),void 0===n&&(n=!0),void 0===r&&(r={print:console.log}),void 0===o&&(o=new Ze),void 0===i&&(i=""),s=this,c=void 0,l=function(){var s;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(c){switch(c.label){case 0:return(s=Xe(o,e,t))instanceof Mt?[2,s]:(function(e){x=e}(o),null!==(a=r.context)&&void 0!==a||(r.context=o),i&&(o.path=i),r.print&&(E.print=r.print),n?(C=!0,[4,j(!0)]):[3,2]);case 1:c.sent(),function(e,t){var n,r,o=e.fs,i=e.path;for(var a in e)e.hasOwnProperty(a)&&(n=a,r=new xe(e[a],a),function(e,t){Le[e]={},Ue[e]=t}(n,Ge(Oe(r),n)));t.set("import",new ie((function(e,t){var n=e.context,r=At(t);if(ze(r))return Fe(r);if((r=i.join(n.path,r))in B)return B[r];try{if(!o.existsSync(r)){if(!o.existsSync("./particles/"+r))return new Mt(F.unknown,"ImportError","Can't find file '".concat(r,"' to import."));if(!o.existsSync("particles/"+r+"/main.es"))return new Mt(F.unknown,"ImportError","Module '".concat(r,"' has no entry point. Requires 'main.es'."));r="particles/"+r+"/main.es"}var a=i.dirname(r),s=o.readFileSync(r,"utf-8"),c=new Ze;c.parent=x,c.path=a;var u=new Yt(new ve(r),{});B[r]=u;var l=Ke(s,{env:c,measurePerformance:!1,fileName:r,currentDir:a});return u.__value__=c.getSymbolTableAsDict(),l.error?l.error:u}catch(e){return new Mt(F.unknown,"ImportError",e.toString())}}),[{name:"path",type:z.string}],"import",void 0,z.object),{forceThroughConst:!0,isConstant:!0}),t.setOwn("open",new ie((function(e,t,n){e.context;var r=At(t),i=At(n)||"utf-8";return o.existsSync(r)?new re({str:new ie((function(e){var t=e.context;return new ve(o.readFileSync(t.path+r,i))}),[],"str",void 0,z.string),write:new ie((function(e,t){var n=e.context;o.writeFileSync(n.path+r,At(t))}),[{name:"path",type:z.string}]),append:new ie((function(e,t){var n=e.context;o.appendFileSync(n.path+r,At(t))}),[{name:"path",type:z.string}])}):new Ut(F.unknown,r)})))}(r,o),c.label=2;case 2:return[2]}}))},new((u=void 0)||(u=Promise))((function(e,t){function n(e){try{o(l.next(e))}catch(e){t(e)}}function r(e){try{o(l.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof u?o:new u((function(e){e(o)}))).then(n,r)}o((l=l.apply(s,c||[])).next())}))}function Ke(e,t){var n=void 0===t?{}:t,r=n.env,o=void 0===r?x:r,i=n.measurePerformance,a=void 0!==i&&i,s=n.fileName,c=void 0===s?"(unknown)":s,u=n.currentDir,l=void 0===u?"":u;l&&(o.path=l),it.maxTime=0,it.totalTime=0,it.interprets=0;var f={total:0,lexerTotal:0,parserTotal:0,interpretTotal:0,nodeMax:0,nodeAvg:0,nodeTotal:0,interprets:0},p=I();if(!o.root.initialisedAsGlobal){var d=new ot;return d.error=new Mt(F.unknown,"Uninitialised","Global context has not been initialised with global values"),d}var y=new Ve(e,c).generate();if(y instanceof Mt)return(h=new ot).error=y,h;f.lexerTotal=I()-p,p=I();var h,v=new He(y).parse();if(v.error)return(h=new ot).error=v.error,h;if(f.parserTotal=I()-p,p=I(),!v.node){var m=new ot;return m.val=new ye([]),m}var b=v.node.interpret(o);return f.interpretTotal=I()-p,f.total=I()-p,f.nodeMax=it.maxTime,f.nodeTotal=it.totalTime,f.nodeAvg=it.totalTime/it.interprets,f.interprets=it.interprets,a&&console.log(f),Ye(Ye({},b),{timeData:f})}var $e=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")};function Xe(e,t,n){var r=this;for(var o in De.import=[function(n,o,i){var a=n.context;if(C)return new Mt(F.unknown,"ImportError","Is running in node instance but trying to run browser import function");var s=o.str();if(ze(At(s)))return Fe(At(s));try{fetch(At(s)).then((function(e){return e.text()})).then((function(n){return o=r,c=void 0,l=function(){var r,o;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(c){switch(c.label){case 0:return(r=new Ze).parent=e,[4,Ke(n)];case 1:return(o=c.sent()).error?(t(new Ut(F.unknown,At(s),o.error.str).str),[2]):i instanceof ie?(i.__call__({context:a},new Yt(s,r.getSymbolTableAsDict())),[2]):[2]}}))},new((u=void 0)||(u=Promise))((function(e,t){function n(e){try{i(l.next(e))}catch(e){t(e)}}function r(e){try{i(l.throw(e))}catch(e){t(e)}}function i(t){var o;t.done?e(t.value):(o=t.value,o instanceof u?o:new u((function(e){e(o)}))).then(n,r)}i((l=l.apply(o,c||[])).next())}));var o,c,u,l}))}catch(e){return new Mt(F.unknown,"ImportError",e.toString())}},{}],De.print=[function(e){e.context;for(var n,r,o=[],i=1;i<arguments.length;i++)o[i-1]=arguments[i];var a="";try{for(var s=$e(o),c=s.next();!c.done;c=s.next()){var u=c.value;a+=At(u)}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}t(a)},{}],De.input=[function(e,t,r){var o=e.context;n(t.valueOf(),(function(e){var t=null==r?void 0:r.valueOf();if(t instanceof ie){var n=t.__call__({context:o},new ve(e));n instanceof Mt&&console.log(n.str)}else"function"==typeof t&&t(e);return new ve("'input()' does not return anything. Pass in a function as the second argument, which will take the user input as an argument.")}))},{}],De){var i=new ie(De[o][0],[],o,void 0,void 0,e);i.info=De[o][1],i.info.name=o,i.info.isBuiltIn=!0,i.info.file="built-in",e.set(o,i,{global:!0,isConstant:!0})}!function(e){var t={false:new ue(!1),true:new ue(!0),nil:new ee,any:z.any,number:z.number,string:z.string,bool:z.bool,function:z.function,array:z.array,object:z.object,type:z.type,error:z.error,undefined:z.undefined};for(var n in t){var r=t[n];e.set(n,r,{global:!0,isConstant:!0})}}(e);var a=function(){if(Ue.math=new xe(Math),!C){var e=function(){if(C)return new Wt;var e=window;return void 0!==e&&"$"in e?{$:new xe(e.$,"jquery"),window:new xe(e,"window"),document:new xe(e.document,"document")}:new Gt(F.unknown,"$ must be property of window to use dom library")}();if(e instanceof Mt)return e;Le.dom=e}}();if(a)return a;e.initialisedAsGlobal=!0}var Je=function(){return Je=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Je.apply(this,arguments)},Ze=function(){function e(){this.symbolTable={},this.initialisedAsGlobal=!1,this.deleted=!1,this.path_=""}return Object.defineProperty(e.prototype,"path",{get:function(){return this.path_||!this.parent?this.path_:this.parent.path},set:function(e){this.path_=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.parent_},set:function(e){e!=this?this.parent_=e:console.error(Re.red("Setting context parent to self"))},enumerable:!1,configurable:!0}),e.prototype.has=function(e){return void 0!==this.get(e)},e.prototype.hasOwn=function(e){return this.symbolTable[e]instanceof me},e.prototype.get=function(e){var t=this.getSymbol(e);return t instanceof Mt||null==t?t:t.value},e.prototype.getRawSymbolTableAsDict=function(){var e={};for(var t in this.symbolTable)e[t]=this.symbolTable[t].value;return e},e.prototype.getSymbolTableAsDict=function(){var e={};for(var t in this.symbolTable)e[t]=this.symbolTable[t];return e},e.prototype.getSymbol=function(e){var t=this.symbolTable[e];if(void 0!==t&&!t.isAccessible)return new Lt(F.unknown,"assessable","inaccessible",t.identifier);if(void 0===t&&this.parent){var n=this.parent.getSymbol(e);if(n instanceof Mt)return n;if(!n)return new Gt(F.unknown,e);t=n}return t},e.prototype.set=function(e,t,n){void 0===n&&(n={});var r=this;if(n.global)r=this.root;else{for(;!r.hasOwn(e)&&void 0!==r.parent;)r=r.parent;r.hasOwn(e)||(r=this)}return r.setOwn(e,t,n)},e.prototype.setOwn=function(e,t,n){if(void 0===n&&(n={}),t instanceof qt||(t=Oe(t)),n.global&&!this.initialisedAsGlobal&&(n.global=!1),!n.forceThroughConst){var r=this.symbolTable[e];if(null==r?void 0:r.isConstant)return new Lt(F.unknown,"dynamic","constant",e)}this.symbolTable[e]=new me(t,e,n)},e.prototype.remove=function(e){delete this.symbolTable[e]},e.prototype.clear=function(){for(var e in this.symbolTable)this.remove(e);this.parent=void 0,this.deleted=!0},Object.defineProperty(e.prototype,"root",{get:function(){for(var e=this;e.parent;)e=e.parent;return e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"keys",{get:function(){return Object.keys(this.symbolTable)},enumerable:!1,configurable:!0}),e.prototype.resetAsGlobal=function(){var e,t;if(this.initialisedAsGlobal){var n=this.root.get("print"),r=this.root.get("input");n instanceof qt&&r instanceof qt?(this.symbolTable={},this.initialisedAsGlobal=!1,Xe(this,(null===(e=n.valueOf())||void 0===e?void 0:e.func)||console.log,(null===(t=r.valueOf())||void 0===t?void 0:t.func)||function(){})):console.error("Error with print and input functions.")}},e.prototype.clone=function(){var t=new e;return t.parent=this.parent,t.deleted=this.deleted,t.initialisedAsGlobal=this.initialisedAsGlobal,t.symbolTable=Je(Je({},t.symbolTable),this.symbolTable),t},e.prototype.deepClone=function(){var e,t=this.clone();return t.parent=null===(e=t.parent)||void 0===e?void 0:e.deepClone(),t},e.prototype.log=function(){for(var e in console.log("---- CONTEXT ----"),this.symbolTable){var t=this.symbolTable[e],n=e;t.isConstant&&(n+=" (CONST)"),t.isAccessible||(n+=" (INACCESSIBLE)"),n+=": ",n+=At(this.symbolTable[e].value),console.log(n)}console.log("-----------------")},e}();function et(e,t){var n,r,o,i=e.type.interpret(t);if(i.error)return i.error;if(!(i.val instanceof K))return new Lt(F.unknown,"Type",typeof i.val,i.val,"Argument can't be undefined");if(r=i.val,e.defaultValue){var a=null===(n=e.defaultValue)||void 0===n?void 0:n.interpret(t);if(a.error)return a.error;a.val instanceof qt&&(o=a.val)}return{name:e.name,type:r,defaultValue:o}}var tt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),nt=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new Lt(t?"Object is not iterable.":"Symbol.iterator is not defined.")},rt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},ot=function(){this.val=new ee,this.shouldBreak=!1,this.shouldContinue=!1},it=function(){function e(e,t){void 0===t&&(t=!1),this.pos=e,this.isTerminal=t}return e.prototype.interpret=function(t){var n,r=I(),o=new ot,i=this.interpret_(t);i instanceof Mt?o.error=i:i instanceof ot?(o.val=i.val,o.error=i.error,o.funcReturn=i.funcReturn,o.shouldBreak=i.shouldBreak,o.shouldContinue=i.shouldContinue):o.val=i,o.error&&o.error.pos.isUnknown&&(o.error.pos=this.pos),o.val instanceof qt||(o.error=new Lt(F.unknown,"Primitive","Native JS value",At(o.val)),o.val=new ee),(n=o.val.info).file||(n.file=this.pos.file),e.interprets++;var a=I()-r;return e.totalTime+=a,a>e.maxTime&&(e.maxTime=a),o},e.interprets=0,e.totalTime=0,e.maxTime=0,e}(),at=function(e){function t(t,n,r,o){var i=e.call(this,t)||this;return i.left=n,i.opTok=r,i.right=o,i}return tt(t,e),t.prototype.interpret_=function(e){var t=this.left.interpret(e);if(t.error)return t.error;var n=this.right.interpret(e);if(n.error)return n.error;var r=t.val,o=n.val;if(void 0===r)return new Lt(this.opTok.pos,"~undefined","undefined",r,"N_binOp.interpret_");if(void 0===o)return new Lt(this.opTok.pos,"~undefined","undefined",o,"N_binOp.interpret_");switch(this.opTok.type){case M.LTE:var i=r.__lt__({context:e},o),a=r.__eq__({context:e},o);return i instanceof Mt?i:a instanceof Mt?a:i.__or__({context:e},a);case M.GTE:var s=r.__gt__({context:e},o);return a=r.__eq__({context:e},o),s instanceof Mt?s:a instanceof Mt?a:s.__or__({context:e},a);case M.NOTEQUALS:var c=r.__eq__({context:e},o);return c instanceof Mt?c:new ue(!c.bool().valueOf());case M.ADD:return r.__add__({context:e},o);case M.SUB:return r.__subtract__({context:e},o);case M.MUL:return r.__multiply__({context:e},o);case M.DIV:return r.__divide__({context:e},o);case M.POW:return r.__pow__({context:e},o);case M.EQUALS:return r.__eq__({context:e},o);case M.LT:return r.__lt__({context:e},o);case M.GT:return r.__gt__({context:e},o);case M.AND:return r.__and__({context:e},o);case M.OR:return r.__or__({context:e},o);default:return new Dt(this.opTok.pos,"Invalid binary operator: ".concat(N[this.opTok.type]))}},t}(it),st=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.a=n,o.opTok=r,o}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r,o=this.a.interpret(e);if(o.error)return o.error;switch(this.opTok.type){case M.SUB:case M.ADD:if(!(o.val instanceof se))return new Lt(this.pos,"Number",(null===(t=o.val)||void 0===t?void 0:t.typeName().toString())||"undefined_",null===(n=o.val)||void 0===n?void 0:n.valueOf());var i=o.val.valueOf();return new se(this.opTok.type===M.SUB?-i:Math.abs(i));case M.NOT:return new ue(!(null===(r=null==o?void 0:o.val)||void 0===r?void 0:r.bool().valueOf()));default:return new Dt(this.opTok.pos,"Invalid unary operator: ".concat(N[this.opTok.type]))}},t}(it),ct=function(e){function t(t,n,r,o,i,a,s,c,u){void 0===o&&(o="="),void 0===i&&(i=!1),void 0===a&&(a=!1),void 0===s&&(s=!1),void 0===c&&(c=!1),void 0===u&&(u=z.any);var l=e.call(this,t)||this;return l.value=r,l.varNameTok=n,l.isGlobal=i,l.assignType=o,l.isConstant=s,l.isDeclaration=c,l.isLocal=a,l.type=u instanceof K?new Et(u):u,l}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r,o;if(this.isDeclaration&&e.hasOwn(this.varNameTok.value))return new Dt(this.pos,"Symbol '".concat(this.varNameTok.value,"' already exists, and cannot be redeclared"));var i=this.value.interpret(e),a=this.type.interpret(e);if(i.error)return i.error;if(a.error)return a.error;if(!(a.val&&a.val instanceof K))return new Lt(this.varNameTok.pos,"Type",null!==(n=null===(t=a.val)||void 0===t?void 0:t.typeName().valueOf())&&void 0!==n?n:"undefined",null===(r=a.val)||void 0===r?void 0:r.str(),"@ !typeRes.val || !(typeRes.val instanceof ESType)");if(!i.val)return new Lt(this.varNameTok.pos,"~undefined","undefined","N_varAssign.interpret_");if(!a.val.includesType({context:e},i.val.__type__).bool().valueOf())return new Lt(this.varNameTok.pos,At(a.val),At(null===(o=i.val)||void 0===o?void 0:o.typeName()),At(i.val));if(this.isDeclaration)return"="!==this.assignType?new Dt(this.pos,"Cannot declare variable with operator '".concat(this.assignType,"'")):(e.setOwn(this.varNameTok.value,i.val,{global:!1,isConstant:this.isConstant}),i.val);if("="===this.assignType){var s=i.val;if(void 0===s&&(s=new ee),(u=e.set(this.varNameTok.value,s,{global:this.isGlobal,isConstant:this.isConstant}))instanceof Mt)return u}else{if(this.isDeclaration)return new Dt(this.pos,"Cannot declare variable with operator '".concat(this.assignType,"'"));var c=e.get(this.varNameTok.value);if(c instanceof Mt)return c;if(null==c)return new Dt(this.pos,"Cannot declare variable with operator '".concat(this.assignType,"'"));var u,l=void 0,f=i.val;switch(this.assignType[0]){case"*":l=c.__multiply__({context:e},f);break;case"/":l=c.__divide__({context:e},f);break;case"+":l=c.__add__({context:e},f);break;case"-":l=c.__subtract__({context:e},f);break;default:return new Mt(this.pos,"AssignError","Cannot find assignType of ".concat(this.assignType[0]))}if(l instanceof Mt)return l;if((u=e.set(this.varNameTok.value,l,{global:this.isGlobal,isConstant:this.isConstant}))instanceof Mt)return u;i.val=l}return"(anonymous)"!==i.val.info.name&&i.val.info.name||(i.val.info.name=this.varNameTok.value),i},t}(it),ut=function(e){function t(t,n,r,o){var i=e.call(this,t)||this;return i.comparison=n,i.ifFalse=o,i.ifTrue=r,i}return tt(t,e),t.prototype.interpret_=function(e){var t,n=new Ze;n.parent=e;var r=new ot,o=this.comparison.interpret(e);if(o.error)return o;if(null===(t=o.val)||void 0===t?void 0:t.bool().valueOf()){if((r=this.ifTrue.interpret(n)).val=new ee,r.error)return r}else if(this.ifFalse&&((r=this.ifFalse.interpret(n)).val=new ee,r.error))return r;return r},t}(it),lt=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.comparison=n,o.loop=r,o}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r=new Ze;for(r.parent=e;;){var o=this.comparison.interpret(e);if(o.error)return o;if(!(null===(n=null===(t=o.val)||void 0===t?void 0:t.bool())||void 0===n?void 0:n.valueOf()))break;var i=this.loop.interpret(r);if(i.error)return i;if(i.shouldBreak)break}return new ee},t}(it),ft=function(e){function t(t,n,r,o,i,a){var s=e.call(this,t)||this;return s.body=n,s.array=r,s.identifier=o,s.isGlobalId=i,s.isConstId=a,s}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r,o,i,a,s,c,u,l,f=new Ze;f.parent=e;var p=this.array.interpret(e);if(p.error)return p;if(-1===["Array","Number","Object","String","Any"].indexOf((null===(r=p.val)||void 0===r?void 0:r.typeName().valueOf())||""))return new Lt(this.identifier.pos,"Array | Number | Object | String",typeof p.val+" | "+(null===(o=p.val)||void 0===o?void 0:o.typeName()));function d(e,t,n,r,o){f.set(t,n,{global:r,isConstant:o});var i=e.interpret(f);return i.error||void 0!==i.funcReturn?i:i.shouldBreak?(i.shouldBreak=!1,"break"):void(i.shouldContinue&&(i.shouldContinue=!1))}if(p.val instanceof se||"number"==typeof(null===(i=p.val)||void 0===i?void 0:i.valueOf())){for(var y=0;y<p.val.valueOf()&&"break"!==(b=d(this.body,this.identifier.value,new se(y),this.isGlobalId,this.isConstId));y++)if(b&&(b.error||void 0!==b.funcReturn))return b}else if(p.val instanceof re||"number"==typeof(null===(a=p.val)||void 0===a?void 0:a.valueOf())&&!Array.isArray(null===(s=p.val)||void 0===s?void 0:s.valueOf()))for(var h in null===(c=p.val)||void 0===c?void 0:c.valueOf()){if("break"===(b=d(this.body,this.identifier.value,new ve(h),this.isGlobalId,this.isConstId)))break;if(b&&(b.error||void 0!==b.funcReturn))return b}else{if(!(p.val instanceof ye||Array.isArray(null===(u=p.val)||void 0===u?void 0:u.valueOf())))return new Lt(this.identifier.pos,"Array | Number | Object | String",typeof p.val);try{for(var v=nt(null===(l=p.val)||void 0===l?void 0:l.valueOf()),m=v.next();!m.done;m=v.next()){var b;if(h=m.value,"break"===(b=d(this.body,this.identifier.value,h,this.isGlobalId,this.isConstId)))break;if(b&&(b.error||void 0!==b.funcReturn))return b}}catch(e){t={error:e}}finally{try{m&&!m.done&&(n=v.return)&&n.call(v)}finally{if(t)throw t.error}}}return new ee},t}(it),pt=function(e){function t(t,n,r){void 0===r&&(r=!1);var o=e.call(this,t)||this;return o.items=n,o.shouldClone=r,o}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r=new ot,o=[];try{for(var i=nt(this.items),a=i.next();!a.done;a=i.next()){var s=a.value.interpret(e);if(s.error||void 0!==s.funcReturn)return s;if(s.val){var c=s.val;this.shouldClone&&(c=c.clone()),o.push(c)}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}return r.val=new ye(o),r},t}(it),dt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.properties=n,r}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r={};try{for(var o=nt(this.properties),i=o.next();!i.done;i=o.next()){var a=rt(i.value,2),s=a[0],c=a[1].interpret(e);if(c.error)return c.error;var u=s.interpret(e);if(u.error)return u.error;u.val&&c.val&&(r[u.val.valueOf()]=c.val)}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return new re(r)},t}(it),yt=function(e){function t(t){return e.call(this,t)||this}return tt(t,e),t.prototype.interpret_=function(e){return new re({})},t}(it),ht=function(e){function t(t,n){var r=e.call(this,t)||this;return r.items=n,r}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r;try{for(var o=nt(this.items),i=o.next();!i.done;i=o.next()){var a=i.value.interpret(e);if(a.error||void 0!==a.funcReturn||a.shouldBreak||a.shouldContinue)return a;r=a.val}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}return r||new ee},t}(it),vt=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.arguments=r,o.to=n,o}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r=this.to.interpret(e),o=r.val,i=r.error;if(i)return i;if(!o)return new Lt(this.pos,"any","undefined",void 0,"On function call");var a=[];try{for(var s=nt(this.arguments),c=s.next();!c.done;c=s.next()){var u=c.value.interpret(e);if(u.error)return u.error;u.val&&a.push(u.val)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}var l=o.__call__.apply(o,function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([{context:e}],rt(a),!1));return l instanceof Mt&&l.traceback.push({position:this.pos,line:"".concat(o.info.name||"<AnonFunction>","(").concat(a.map(At).join(", "),")")}),l},t}(it),mt=function(e){function t(t,n,r,o,i,a,s){void 0===i&&(i="(anon)"),void 0===a&&(a=new re),void 0===s&&(s="");var c=e.call(this,t)||this;return c.arguments=r,c.body=n,c.name=i,c.this_=a,c.returnType=o,c.description=s,c}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r,o,i,a=[];try{for(var s=nt(this.arguments),c=s.next();!c.done;c=s.next()){var u=et(c.value,e);if(u instanceof Mt)return u;a.push(u)}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}var l=this.returnType.interpret(e);return l.error?l.error:l.val instanceof K?new ie(this.body,a,this.name,this.this_,l.val,e):new Lt(this.returnType.pos,"Type",null!==(o=null===(r=l.val)||void 0===r?void 0:r.typeName().valueOf())&&void 0!==o?o:"<Undefined>",null===(i=l.val)||void 0===i?void 0:i.str().valueOf(),"On func '".concat(this.name,"' return type"))},t}(it),bt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return tt(t,e),t.prototype.interpret_=function(e){var t=new ot;if(void 0===this.value)return t.funcReturn=new ee,t;var n=this.value.interpret(e);return n.error?n.error:(t.funcReturn=n.val,t)},t}(it),gt=function(e){function t(t,n){var r=e.call(this,t)||this;return r.value=n,r}return tt(t,e),t.prototype.interpret_=function(e){var t,n=new ot;if(void 0===this.value)return n.funcReturn=new ee,n;var r=this.value.interpret(e);return r.error?r.error:((null===(t=r.val)||void 0===t?void 0:t.bool().valueOf())&&(n.funcReturn=r.val),n)},t}(it),wt=function(e){function t(t,n,r){var o=e.call(this,t)||this;return o.base=n,o.index=r,o}return tt(t,e),t.prototype.interpret_=function(e){var t,n=this.base.interpret(e);if(n.error)return n;var r=this.index.interpret(e);if(r.error)return r;var o=r.val,i=n.val;if(!i||!o)return new ee;if(void 0!==this.value){var a=this.value.interpret(e);if(a.error)return a;var s=Oe(i.__getProperty__({context:e},o)),c=void 0,u=a.val;if(null!==(t=this.assignType)&&void 0!==t||(this.assignType="="),!u)return new Lt(this.pos,"~undefined","undefined","undefined","N_indexed.interpret_");switch(this.assignType[0]){case"*":c=s.__multiply__({context:e},u);break;case"/":c=s.__divide__({context:e},u);break;case"+":c=s.__add__({context:e},u);break;case"-":c=s.__subtract__({context:e},u);break;case"=":c=u;break;default:return new Mt(this.pos,"AssignError","Cannot find assignType of ".concat(this.assignType[0]))}if(c instanceof Mt)return c;if(!i.__setProperty__)return new Lt(this.pos,"mutable","immutable",i.valueOf());var l=i.__setProperty__({context:e},o,null!=c?c:new ee);if(l instanceof Mt)return l}return i.__getProperty__({context:e},o)},t}(it),xt=function(e){function t(t,n,r,o,i){void 0===i&&(i="<anon class>");var a=e.call(this,t)||this;return a.init=o,a.methods=n,a.name=i,a.extends_=r,a.instances=[],a}return tt(t,e),t.prototype.interpret_=function(e){var t,n,r,o,i,a,s,c=[];try{for(var u=nt(this.methods),l=u.next();!l.done;l=u.next()){var f=l.value.interpret(e);if(f.error)return f.error;if(!(f.val instanceof ie))return new Lt(this.pos,"Function",(null===(r=f.val)||void 0===r?void 0:r.typeName().valueOf())||"undefined","method on "+this.name);c.push(f.val)}}catch(e){t={error:e}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(t)throw t.error}}if(this.extends_){var p=this.extends_.interpret(e);if(p.error)return p.error;if(!(p.val instanceof K))return new Lt(this.pos,"Function",(null===(o=p.val)||void 0===o?void 0:o.typeName().valueOf())||"undefined","method on "+this.name);a=p.val}if(this.init){var d=this.init.interpret(e);if(d.error)return d.error;if(!(d.val instanceof ie))return new Lt(this.pos,"Function",(null===(i=d.val)||void 0===i?void 0:i.typeName().valueOf())||"undefined","method on "+this.name);s=d.val}return new K(!1,this.name,c,a,s)},t}(it),_t=function(e){function t(t,n,r,o){void 0===r&&(r="(anon)"),void 0===o&&(o=!1);var i=e.call(this,t)||this;return i.name=r,i.statements=n,i.mutable=o,i}return tt(t,e),t.prototype.interpret_=function(e){var t=new Ze;t.parent=e;var n=this.statements.interpret(t);return n.error?n:new Yt(new ve(this.name),t.getSymbolTableAsDict(),this.mutable)},t}(it),St=function(e){function t(t,n){var r=e.call(this,t,!0)||this;return r.a=n,r}return tt(t,e),t.prototype.interpret_=function(e){var t=this.a.value;if("number"!=typeof t)return new Lt(this.pos,"number",typeof t);var n=new ot;return n.val=new se(t),n},t}(it),Ot=function(e){function t(t,n){var r=e.call(this,t,!0)||this;return r.a=n,r}return tt(t,e),t.prototype.interpret_=function(e){var t=this.a.value;if("string"!=typeof t)return new Lt(this.pos,"string",typeof t);var n=new ot;return n.val=new ve(t),n},t}(it),Tt=function(e){function t(t){var n=e.call(this,t.pos,!0)||this;return n.a=t,n}return tt(t,e),t.prototype.interpret_=function(e){if(!e.has(this.a.value))return new Gt(this.a.pos,this.a.value);var t=new ot,n=e.getSymbol(this.a.value);return n?n instanceof Mt?n:(t.val=n.value,t):new ee},t}(it),kt=function(e){function t(t){return void 0===t&&(t=F.unknown),e.call(this,t,!0)||this}return tt(t,e),t.prototype.interpret_=function(e){var t=new ot;return t.val=new ee,t},t}(it),Pt=function(e){function t(t){return e.call(this,t,!0)||this}return tt(t,e),t.prototype.interpret_=function(e){var t=new ot;return t.shouldBreak=!0,t},t}(it),Ct=function(e){function t(t){return e.call(this,t,!0)||this}return tt(t,e),t.prototype.interpret_=function(e){var t=new ot;return t.shouldContinue=!0,t},t}(it),Et=function(e){function t(t,n){void 0===n&&(n=F.unknown);var r=e.call(this,n,!0)||this;return r.value=t,r}return tt(t,e),t.prototype.interpret_=function(e){return this.value},t}(it);function At(e,t){var n,r;if(void 0===t&&(t=0),"string"==typeof e)return t>0?"'".concat(e,"'"):e;if(t>20)return"...";var o="";if(void 0===e)return"undefined";if(e instanceof qt)return e.str().valueOf();if(e instanceof it)return"<RunTimeNode: ".concat(e.constructor.name,">");switch(typeof e){case"object":if(Array.isArray(e)){o+="[";try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e),a=i.next();!a.done;a=i.next()){var s=a.value;try{o+=At(s,t+1)+", "}catch(e){o+="<large property>, "}}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.length&&(o=o.substring(0,o.length-2)),o+="]"}else{try{o+=e.constructor.name}catch(e){o+="UNKNOWN_CONSTRUCTOR"}o+=": {\n";var c=0;for(var s in e)c++,e.hasOwnProperty&&e.hasOwnProperty(s)&&(o+="  ".concat(s,": ").concat(At(e[s],t+1)||"",", \n"));c>0&&(o=o.substring(0,o.length-3)),o+="\n}\n"}break;case"string":o="'".concat(e,"'");break;case"bigint":case"number":case"boolean":o="".concat(e);break;case"undefined":o="<NativeUndefined>";break;case"function":o="<NativeFunction ".concat(e.name,">")}for(c=0;c<t;c++)o=jt(o);return o}var It=function(e){return new Promise((function(t){return setTimeout((function(){return t()}),e)}))};function jt(e){return e.replace(/\n/g,"\n    ")}var Rt,Bt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Mt=function(){function e(e,t,n){this.traceback=[],this.pos=e,this.name=t,this.details=n}return Object.defineProperty(e.prototype,"colouredStr",{get:function(){var e,t,n="";if(this.traceback.length){n=Re.yellow("Error Traceback (most recent call last):\n");try{for(var r=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new Lt(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))}([],function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a}(this.traceback),!1).reverse()),o=r.next();!o.done;o=r.next()){var i=o.value;n+="    ".concat(Re.cyan(i.position.str),":\n        ").concat(i.line,"\n")}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}return n+"".concat(Re.red(this.name),": ").concat(this.details," \n at ").concat(Re.cyan(this.pos.str))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"str",{get:function(){return"".concat(this.name,": ").concat(this.details," \n at ").concat(this.pos.str)},enumerable:!1,configurable:!0}),e}(),Nt=function(e){function t(t,n){return e.call(this,t,"IllegalCharError","'".concat(n,"'"))||this}return Bt(t,e),t}(Mt),Dt=function(e){function t(t,n){return e.call(this,t,"InvalidSyntaxError",n)||this}return Bt(t,e),t}(Mt),Lt=(Bt((function(e,t){return Rt.call(this,e,"ExpectedCharError","'".concat(t,"'"))||this}),Rt=Mt),function(e){function t(t,n,r,o,i){return void 0===o&&(o=""),void 0===i&&(i=""),e.call(this,t,"TypeError","Expected type '".concat(n,"', got type '").concat(r,"' ").concat(void 0===o?"":" on value '".concat(At(o),"'")," ").concat(i||""))||this}return Bt(t,e),t}(Mt)),Ut=function(e){function t(t,n,r){return void 0===r&&(r=""),e.call(this,t,"ImportError","Could not import ".concat(n,": ").concat(r))||this}return Bt(t,e),t}(Mt),Gt=function(e){function t(t,n){return e.call(this,t,"ReferenceError","".concat(n," is not defined"))||this}return Bt(t,e),t}(Mt),zt=function(e){function t(t,n,r){var o;return e.call(this,t,"IndexError","'".concat(n,"' is not a property of '").concat((null===(o=null==r?void 0:r.info)||void 0===o?void 0:o.name)||At(r),"'"))||this}return Bt(t,e),t}(Mt),Ft=function(e){function t(t,n,r,o){var i;return void 0===r&&(r=""),void 0===o&&(o=F.unknown),e.call(this,o,"TypeError","Cannot perform '".concat(t,"' on value ").concat((null===(i=null==n?void 0:n.info)||void 0===i?void 0:i.name)||At(n),": ").concat(r))||this}return Bt(t,e),t}(Mt),Wt=function(e){function t(){return e.call(this,F.unknown,"InvalidRuntimeError","Required runtime of ".concat(C?"browser":"node"))||this}return Bt(t,e),t}(Mt),Vt=(function(e){Bt((function(t){return e.call(this,F.unknown,"TestFailed",t)||this}),e)}(Mt),function(){return Vt=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},Vt.apply(this,arguments)}),qt=function(){function e(e,t){var n=this;void 0===t&&(t=z.any),this.self=this,this.isa=function(e,t){return new ue(t===n.__type__)},this.is=function(e,t){return new ue(t===n)},this.valueOf=function(){return n.__value__},this.typeName=function(){return n.__type__.__name__},this.hasProperty=function(e,t){return new ue(n.hasOwnProperty(At(t)))},this.describe=function(e,t){n.info.isBuiltIn||(n.info.description=At(t))},this.detail=function(e,t){if(!n.info.isBuiltIn){var r=Te(t,e);if("object"!=typeof r)return new Lt(F.unknown,"object",n.typeName(),At(n));n.info=Vt(Vt({},n.info),r),n.info.isBuiltIn=!1}},this.__type__=t||this,this.__value__=e,this.info={}}return e.prototype.__add__=function(e,t){return new Ft("",this)},e.prototype.__subtract__=function(e,t){return new Ft("",this)},e.prototype.__multiply__=function(e,t){return new Ft("",this)},e.prototype.__divide__=function(e,t){return new Ft("",this)},e.prototype.__pow__=function(e,t){return new Ft("__pow__",this)},e.prototype.__eq__=function(e,t){return new Ft("__eq__",this)},e.prototype.__gt__=function(e,t){return new Ft("__gt__",this)},e.prototype.__lt__=function(e,t){return new Ft("__lt__",this)},e.prototype.__and__=function(e,t){return new Ft("__and__",this)},e.prototype.__or__=function(e,t){return new Ft("__or__",this)},e.prototype.__bool__=function(e){return new Ft("__bool__",this)},e.prototype.__setProperty__=function(e,t,n){return new Ft("__setProperty__",this,"[".concat(At(t),"] = ").concat(At(n)))},e.prototype.__call__=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return new Ft("__call__",this)},e}(),Ht=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new Lt("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Yt=function(e){function t(n,r,o){void 0===o&&(o=!1);var i=e.call(this,r,z.object)||this;return i.cast=function(e){return new Mt(F.unknown,"TypeError","Cannot cast type 'namespace'")},i.clone=function(){var e,n,r={},o=i.valueOf();try{for(var a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new Lt(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(Object.keys(o)),s=a.next();!s.done;s=a.next()){var c=s.value;r[c]=o[c]}}catch(t){e={error:t}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(e)throw e.error}}return new t(i.name,r)},i.str=function(){var e=Object.keys(i.valueOf());return new ve("<Namespace ".concat(At(i.name)).concat(e.length>0?": ":"").concat(e.slice(0,5)).concat(e.length>=5?"...":"",">"))},i.__eq__=function(e,t){return new ue(i===t)},i.__bool__=function(){return new ue(!0)},i.bool=i.__bool__,i.__getProperty__=function(e,t){if(t instanceof ve&&i.valueOf().hasOwnProperty(t.valueOf())){var n=i.valueOf()[t.valueOf()];if(n.isAccessible)return n.value}if(!(t instanceof ve))return new Lt(F.unknown,"string",t.typeName());if(i.self.hasOwnProperty(At(t))){var r=i.self[At(t)];return"function"==typeof r?new ie(r):Oe(r)}return new zt(F.unknown,t.valueOf(),i.self)},i.info.name=At(n),i.mutable=o,i}return Ht(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return new ve(this.info.name)},set:function(e){this.info.name=e.valueOf()},enumerable:!1,configurable:!0}),t.prototype.__setProperty__=function(e,t,n){if(!(t instanceof ve))return new Lt(F.unknown,"string",t.typeName().valueOf(),At(t));var r=At(t);if(!this.mutable)return new Lt(F.unknown,"mutable","immutable","".concat(At(this.name)));n instanceof qt||(n=Oe(n));var o=this.__value__[r];return o?o.isConstant?new Lt(F.unknown,"mutable","immutable","".concat(At(this.name),".").concat(r)):o.isAccessible?void(o.value=n):new Lt(F.unknown,"accessible","inaccessible","".concat(At(this.name),".").concat(r)):new Mt(F.unknown,"SymbolError","Symbol ".concat(r," is not declared in namespace ").concat(At(this.name),"."))},t}(qt);z.type=new K(!0,"Type"),z.undefined=new K(!0,"Undefined"),z.string=new K(!0,"String"),z.array=new K(!0,"Array"),z.number=new K(!0,"Number"),z.any=new K(!0,"Any"),z.function=new K(!0,"Function"),z.bool=new K(!0,"Boolean"),z.object=new K(!0,"Object"),z.error=new K(!0,"Error"),z.any.info={name:"any",description:"Matches any other type",file:"built-in",isBuiltIn:!0},z.number.info={name:"any",description:"The ES Number type. Is a a double-precision 64-bit binary format IEEE 754 value, like double in Java and C#",file:"built-in",isBuiltIn:!0},z.string.info={name:"string",description:"The ES String type. Holds an array of characters, and can be defined with any of ', \" and `. Can be indexed like an array.",file:"built-in",isBuiltIn:!0},z.bool.info={name:"bool",description:"The ES Bool type. Exactly two instances exist, true and false.",file:"built-in",isBuiltIn:!0},z.function.info={name:"function",description:"The ES Function type. Is a block of code which executes when called and takes in 0+ parameters.",file:"built-in",isBuiltIn:!0},z.array.info={name:"array",description:"The ES Array type. Defines a set of items of any type which can be accessed by an index with [].",file:"built-in",isBuiltIn:!0},z.object.info={name:"object",description:"The ES Object type. Similar to JS objects or python dictionaries.",file:"built-in",isBuiltIn:!0},z.error.info={name:"error",description:"The ES Error type. Call to throw an error.",file:"built-in",isBuiltIn:!0},z.type.info={name:"type",description:"The ES Type type. Call to get the type of a value at a string.",file:"built-in",isBuiltIn:!0};var Qt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kt=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},$t=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},Xt=function(e){function n(t){var r=t.path,o=t.entity,i=t.script,a=e.call(this,"Script",r.split("/").pop()||"noscript")||this;return a.name="",a.runMethod=function(e,t,n){var r;void 0===n&&(n=[]),n=$t([new xe(t)],Kt(n),!1);var o=null===(r=a.script)||void 0===r?void 0:r.__getProperty__({context:x},new ve(e));o instanceof ie?o.__call__.apply(o,$t([{context:x}],Kt(n),!1)):console.error("Cannot run method '".concat(e,"'"))},a.path=r,a.script=i,n.runStartMethodOnInit&&a.runMethod("Start",o,[]),a}return Qt(n,e),n.prototype.jsonPublic=function(){var e,n,o=[];try{for(var i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(this.public),a=i.next();!a.done;a=i.next()){var s=a.value,c={},u=s;for(var l in s)"value"===l&&(u[l]instanceof t||u[l]instanceof r)?c[l]=u[l].array:c[l]=u[l];o.push(c)}}catch(t){e={error:t}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}return o},n.prototype.json=function(){return{type:"Script",path:"scripts.js",name:this.name,public:this.jsonPublic()}},n.prototype.Update=function(){},n.runStartMethodOnInit=!1,n}(O),Jt=n(842),Zt=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),en=function(e){function n(n,r,o,i){var a=e.call(this,"Collider",n)||this;return a.addPublic({name:"solid",value:r,description:"If the collider should interact with other colliders or not",default:!0,type:"boolean"}),a.addPublic({name:"offset",value:o,type:"v2",description:"Offsets the renderer from the transform of the entity",default:t.zero}),a.MatterBody=i,a}return Zt(n,e),n}(O),tn=function(e){function n(n){var r=n.radius,o=void 0===r?1:r,i=n.solid,a=void 0===i||i,s=n.offset,c=void 0===s?new t(0,0):s,u=e.call(this,"CircleCollider",a,c,Jt.Bodies.circle(0,0,o,{}))||this;return u.addPublic({name:"radius",value:o,default:1}),u}return Zt(n,e),n.prototype.overlapsPoint=function(e,t){var n=Jt.Bodies.circle(e.position.x,e.position.y,this.radius*e.scale.x,{angle:e.rotation.z});return Jt.Query.point([n],Jt.Vector.create(t.x,t.y)).length>0},n.prototype.json=function(){return{type:"CircleCollider",radius:this.radius,solid:this.solid,offset:this.offset.array}},n}(en),nn=function(e){function n(n){var r=n.width,o=void 0===r?1:r,i=n.height,a=void 0===i?1:i,s=n.solid,c=void 0===s||s,u=n.offset,l=void 0===u?new t(0,0):u,f=e.call(this,"RectCollider",c,l,Jt.Bodies.rectangle(0,0,o,a,{}))||this;return f.addPublic({name:"height",value:a}),f.addPublic({name:"width",value:o}),f}return Zt(n,e),n.prototype.overlapsPoint=function(e,t){var n=Jt.Bodies.rectangle(e.position.x,e.position.y,this.width*e.scale.x,this.height*e.scale.y,{angle:e.rotation.z});return Jt.Query.point([n],Jt.Vector.create(t.x,t.y)).length>0},n.prototype.json=function(){return{type:"RectCollider",height:this.height,width:this.width,solid:this.solid,offset:this.offset.array}},n}(en);function rn(e){return new Promise((function(t){return setTimeout(t,e)}))}function on(e){return new t(e.width,e.height)}function an(e,t,n){return e.sub(n).scale(t).add(n)}function sn(e){var t=document.getElementById(e);if(!(t instanceof HTMLCanvasElement))throw"Canvas element is not instance of HTMLCanvasElement";var n=t.getContext("2d");if(!n)throw"Canvas doesn't have 2d context";return{canvas:t,ctx:n}}function cn(e){e.style.width="100%",e.style.height="100%",e.width=e.offsetWidth,e.height=e.offsetHeight}function un(e,n){var o={};for(var i in e)if(-1===["type","subtype","hasSubType","public"].indexOf(i)){var a=e[i];a instanceof t||a instanceof r?a=a.array:a.isColour&&(a=a.json),o[i]=a}return o.type=n||e.subtype,o}var ln=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),fn=function(e){function t(t){var n=t.velocity,o=void 0===n?r.zero:n,i=t.mass,a=void 0===i?1:i,s=t.friction,c=void 0===s?.1:s,u=t.airResistance,l=void 0===u?.1:u,f=t.bounciness,p=void 0===f?.2:f,d=e.call(this,"Body")||this;return d.addPublic({name:"velocity",value:o,description:"The speed and direction of the object at the first frame",type:"v3"}),d.addPublic({name:"mass",value:a,description:"The mass of the object affects collisions, forces and more."}),d.addPublic({name:"friction",value:c,description:"When colliding, this is applied to the velocity. Higher values slow it down more."}),d.addPublic({name:"airResistance",value:l,description:"Velocity is scaled by this every Update. Larger values give higher resistance and more slowing"}),d.addPublic({name:"bounciness",value:p,description:"When dynamically colliding, the velocity is reversed and multiplied by this. Higher values give a higher bounce."}),d}return ln(t,e),t.prototype.json=function(){return un(this,"Body")},t.prototype.applyForce=function(e){return this.velocity.add(e.clone.scale(1/this.mass)),this.velocity},t}(O);function pn(e,t,n,r){e.translate(t.x,t.y),e.rotate(n*Math.PI/180),e.translate(-t.x,-t.y),r(),e.translate(t.x,t.y),e.rotate(-n*Math.PI/180),e.translate(-t.x,-t.y)}function dn(e,t,n,r,o,i){e.beginPath(),e.moveTo(r.x+i,r.y),e.lineTo(r.x+t-i,r.y),e.quadraticCurveTo(r.x+t,r.y,r.x+t,r.y+i),e.lineTo(r.x+t,r.y+n-i),e.quadraticCurveTo(r.x+t,r.y+n,r.x+t-i,r.y+n),e.lineTo(r.x+i,r.y+n),e.quadraticCurveTo(r.x,r.y+n,r.x,r.y+n-i),e.lineTo(r.x,r.y+i),e.quadraticCurveTo(r.x,r.y,r.x+i,r.y),e.closePath(),e.fillStyle=o,e.fill(),e.closePath()}function yn(e,t,n,r){e.beginPath(),e.arc(t.x,t.y,n,0,2*Math.PI),e.fillStyle=r,e.fill(),e.closePath()}function hn(e,n,r,o,i,a){pn(e,n.clone.add(new t(r/2,o/2)),a,(function(){e.beginPath(),e.rect(n.x,n.y,r,o),e.fillStyle=i,e.fill(),e.closePath()}))}function vn(e,n,r,o,i,a,s,c){void 0===s&&(s="center"),void 0===c&&(c=0);var u=new t(e.measureText(n).width,r),l=a.clone.add(u.clone.scale(.5));pn(e,l,c,(function(){e.beginPath(),e.font="".concat(r,"px ").concat(o),e.fillStyle=i,e.textBaseline="middle",e.textAlign=s,e.translate(l.x,l.y),e.rotate(Math.PI),e.scale(-1,1),e.translate(-l.x,-l.y),e.fillText(n,a.x,a.y),e.translate(l.x,l.y),e.rotate(-Math.PI),e.scale(-1,1),e.translate(-l.x,-l.y),e.closePath()}))}function mn(e,t,n,r,o){pn(e,t.clone.add(n.clone.scale(.5)),o,(function(){t=t.clone,e.beginPath();var o=new Image;o.src=r;var i=t.clone.add(n.clone.scale(.5));e.translate(i.x,i.y),e.rotate(Math.PI),e.scale(-1,1),e.translate(-i.x,-i.y),e.drawImage(o,t.x,t.y,n.x,n.y),e.translate(i.x,i.y),e.rotate(-Math.PI),e.scale(-1,1),e.translate(-i.x,-i.y),e.closePath()}))}var bn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),gn=function(e){function t(t,n){return e.call(this,"Renderer",t)||this}return bn(t,e),t.prototype.Update=function(){},t.prototype.json=function(){return un(this)},t}(O),wn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),xn=function(e){function t(t,n){var r=e.call(this,t,!0)||this;return r.addPublic({name:"offset",value:n,type:"v2",description:"offset from entities transform"}),r}return wn(t,e),t.prototype.Update=function(){},t.prototype.json=function(){return un(this)},t}(gn),_n=function(e){function n(n){var r=n.radius,o=void 0===r?1:r,i=n.offset,a=void 0===i?new t(0,0):i,s=n.colour,c=void 0===s?v(0,0,0):s,u=e.call(this,"CircleRenderer",a)||this;return u.addPublic({name:"radius",value:o,type:"number",array:!1}),u.addPublic({name:"colour",value:c,type:"rgb",overrideSet:function(e){"string"!=typeof e?u.setPublic("colour",e):u.setPublic("colour",v.parse(e))}}),u}return wn(n,e),n.prototype.draw=function(e){var t=this.radius*e.zoom*e.transform.scale.x;t<=0||yn(e.ctx,an(e.position.clone.add(this.offset),e.zoom,e.center),t,this.colour.rgb)},n}(xn),Sn=function(e){function n(n){var r=n.height,o=void 0===r?1:r,i=n.offset,a=void 0===i?new t(0,0):i,s=n.width,c=void 0===s?1:s,u=n.colour,l=void 0===u?v(0,0,0):u,f=e.call(this,"RectRenderer",a)||this;return f.addPublic({name:"height",value:o}),f.addPublic({name:"width",value:c}),f.addPublic({name:"colour",value:l,type:"rgb",overrideSet:function(e){"string"!=typeof e?"number"!=typeof e.r?f.setPublic("colour",e):f.setPublic("colour",b(e.r,e.g,e.b,e.a)):f.setPublic("colour",v.parse(e))}}),f}return wn(n,e),n.prototype.Start=function(){},n.prototype.draw=function(e){var n=this.width*e.transform.scale.x*e.zoom,r=this.height*e.transform.scale.y*e.zoom;if(!(r<=0||n<=0)){var o=this.offset.clone.add(e.position);o.sub(new t(n/(2*e.zoom),r/(2*e.zoom))),hn(e.ctx,an(o,e.zoom,e.center),n,r,this.colour.rgb,e.transform.rotation.z)}},n}(xn),On=function(e){function n(n){var r=n.height,o=void 0===r?1:r,i=n.offset,a=void 0===i?new t(0,0):i,s=n.width,c=void 0===s?1:s,u=n.url,l=void 0===u?"":u,f=e.call(this,"ImageRenderer2D",a)||this;return f.addPublic({name:"height",value:o}),f.addPublic({name:"width",value:c}),f.addPublic({name:"url",value:l,type:"string",description:"The path to the image to be rendered - always start with ../projects/{yourProjectID}/assets/"}),f}return wn(n,e),n.prototype.Start=function(){},n.prototype.draw=function(e){var n=this.width*e.transform.scale.x*e.zoom,r=this.height*e.transform.scale.y*e.zoom;if(!(r<=0||n<=0)){var o=this.offset.clone.add(e.position);o.sub(new t(n/(2*e.zoom),r/(2*e.zoom))),mn(e.ctx,an(o,e.zoom,e.center),new t(n,r),this.url,e.transform.rotation.z)}},n}(xn),Tn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),kn=function(e){function t(t){var n=t.mesh,r=void 0===n?new y([]):n,o=e.call(this,"MeshRenderer")||this;return o._mesh=r,o}return Tn(t,e),Object.defineProperty(t.prototype,"mesh",{get:function(){return this._mesh},set:function(e){this._mesh=e instanceof y?e:y.fromArray(e)},enumerable:!1,configurable:!0}),t.prototype.draw=function(e){},t.prototype.json=function(){return{type:"MeshRenderer",mesh:this.mesh.json}},t}(function(e){function t(t){return e.call(this,t,!1)||this}return Tn(t,e),t.prototype.Update=function(){},t}(gn)),Pn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Cn=function(e){function t(t,n){var r=e.call(this,"GUIElement",t)||this;return r.hovered=!1,r.addPublic({name:"zLayer",value:n,description:"Determines what appears on top of what in the GUI"}),r}return Pn(t,e),t.prototype.json=function(){return un(this)},t}(O),En=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),An=function(e){function n(t){var n=t.height,r=void 0===n?30:n,o=t.width,i=void 0===o?60:o,a=t.radius,s=void 0===a?0:a,c=t.innerColour,u=void 0===c?v(230,230,230):c,l=t.outerColour,f=void 0===l?v(90,90,90):l,p=t.borderThickness,d=void 0===p?1:p,y=t.zLayer,h=void 0===y?1:y,m=e.call(this,"GUIBox",h)||this;return m.addPublic({name:"height",value:r,default:30}),m.addPublic({name:"width",value:i,default:60}),m.addPublic({name:"radius",value:Math.min(s,i/2,r/2),description:"Radius of the bod - maxed at (size of smaller dimension)/2",default:0,overrideSet:function(e){var t=Math.min(e,m.width/2,m.height/2);m.setPublic("radius",t)}}),m.addPublic({name:"innerColour",value:u,description:"Colour of background of box",type:"rgb"}),m.addPublic({name:"outerColour",value:f,description:"Colour of border of box",type:"rgb"}),m.addPublic({name:"borderThickness",value:d,default:1}),m}return En(n,e),n.prototype.Start=function(e){},n.prototype.draw=function(e,n){if(0!==this.width&&0!==this.height){this.borderThickness>0&&dn(e,this.width*n.scale.x,this.height*n.scale.y,n.position.v2,this.outerColour.rgba,this.radius);var r=this.borderThickness;dn(e,this.width*n.scale.x-2*r,this.height*n.scale.y-2*r,n.position.v2.add(new t(r,r)),this.innerColour.rgba,this.radius-r)}},n.prototype.touchingPoint=function(e,n,r){return e.isInRect(r.position.v2,new t(this.width*r.scale.x,this.height*r.scale.y))},n}(Cn),In=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),jn=function(e){function t(t){var n=t.zLayer,r=void 0===n?1:n,o=t.colour,i=void 0===o?v(150,150,150):o,a=t.radius,s=void 0===a?1:a,c=e.call(this,"GUIRect",r)||this;return c.addPublic({name:"colour",value:i,type:"rgb"}),c.addPublic({name:"radius",value:s}),c}return In(t,e),t.prototype.draw=function(e,t){var n=this.radius*t.scale.x;n<=0||yn(e,t.position.v2,n,this.colour.rgba)},t.prototype.touchingPoint=function(e,t,n){return e.clone.distTo(n.position.v2)<=this.radius*n.scale.x},t}(Cn),Rn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Bn=function(e){function n(t){var n=t.zLayer,r=void 0===n?1:n,o=t.width,i=void 0===o?100:o,a=t.height,s=void 0===a?100:a,c=t.url,u=void 0===c?"":c,l=e.call(this,"GUIImage",r)||this;return l.addPublic({name:"height",value:s}),l.addPublic({name:"width",value:i}),l.addPublic({name:"url",value:u}),l}return Rn(n,e),n.prototype.Start=function(e){},n.prototype.Update=function(){},n.prototype.draw=function(e,n){var r=this.width*n.scale.x,o=this.height*n.scale.y;o<=0||r<=0||mn(e,n.position.v2,new t(r,o),this.url,n.rotation.z)},n.prototype.touchingPoint=function(e,n,r){var o=this.width*r.scale.x,i=this.height*r.scale.y;return e.isInRect(r.position.v2,new t(o,i))},n}(Cn),Mn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Nn=function(e){function n(n){var r=n.zLayer,o=void 0===r?1:r,i=n.colour,a=void 0===i?v(150,150,150):i,s=n.points,c=void 0===s?[t.zero]:s,u=e.call(this,"GUIPolygon",o)||this;return u.addPublic({name:"colour",value:a,type:"rgb"}),u.addPublic({name:"points",value:c,type:"v2",array:!0}),u}return Mn(n,e),n.prototype.draw=function(e,n){this.points.length<=1||function(e,n,r,o,i){void 0===o&&(o=!0),pn(e,t.avPoint(n),i,(function(){var t,i;e.beginPath(),e.moveTo(n[0].x,n[0].y),e.strokeStyle=r;try{for(var a=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n.slice(1,n.length)),s=a.next();!s.done;s=a.next()){var c=s.value;e.lineTo(c.x,c.y)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(i=a.return)&&i.call(a)}finally{if(t)throw t.error}}o?(e.fillStyle=r,e.fill(),e.closePath()):e.stroke()}))}(e,function(e,n){var r,o,i=e.map((function(e){return e.clone})),a=t.avPoint(i);try{for(var s=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(i),c=s.next();!c.done;c=s.next()){var u=c.value,l=u.clone.sub(a);l.mul(n);var f=a.clone.add(l);u.set(f)}}catch(e){r={error:e}}finally{try{c&&!c.done&&(o=s.return)&&o.call(s)}finally{if(r)throw r.error}}return i}(this.points,n.scale.v2),this.colour.hex,!0,n.rotation.z)},n.prototype.touchingPoint=function(e,t,n){return function(e,t){var n,r;if(e.length<=1)return!1;for(var o=[[e[0],e[e.length-1]],[e[0],e[1]]],i=1;i<e.length-1;i++)o.push([e[i],e[i+1]]);var a=0;try{for(var s=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(o),c=s.next();!c.done;c=s.next()){var u=c.value;if(!(u[0].y>t.y&&u[1].y>t.y||u[0].y<t.y&&u[1].y<t.y)){var l=u[0].y<t.y?u[0]:u[1],f=u[0].y>t.y?u[0]:u[1];Object.is(l,f)||l.x+(t.y-l.y)*(f.x-l.x)/(f.y-l.y)<t.x||a++}}}catch(e){n={error:e}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return a%2==1}(this.points,e)},n}(Cn),Dn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Ln=function(e){function n(t){var n=t.zLayer,r=void 0===n?1:n,o=t.width,i=void 0===o?10:o,a=t.height,s=void 0===a?10:a,c=t.colour,u=void 0===c?v(150,150,150):c,l=t.radius,f=void 0===l?1:l,p=e.call(this,"GUIRect",r)||this;return p.addPublic({name:"height",value:s}),p.addPublic({name:"width",value:i}),p.addPublic({name:"radius",value:Math.min(f,i/2,s/2),description:"Radius of the bod - maxed at (size of smaller dimension)/2",default:0,overrideSet:function(e){var t=Math.min(e,p.width/2,p.height/2);p.setPublic("radius",t)}}),p.addPublic({name:"colour",value:u,type:"rgb"}),p}return Dn(n,e),n.prototype.draw=function(e,t){var n=this.width*t.scale.x,r=this.height*t.scale.y;r<=0||n<=0||dn(e,n,r,t.position.v2,this.colour.hex,this.radius)},n.prototype.touchingPoint=function(e,n,r){var o=this.width*r.scale.x,i=this.height*r.scale.y;return e.isInRect(r.position.v2,new t(o,i))},n}(Cn),Un=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Gn=function(e){function n(t){var n=t.text,r=void 0===n?"text":n,o=t.fontSize,i=void 0===o?12:o,a=t.font,s=void 0===a?"Arial":a,c=t.colour,u=void 0===c?v(0,0,0):c,l=t.alignment,f=void 0===l?"center":l,p=t.fill,d=void 0===p||p,y=t.zLayer,h=void 0===y?1:y,m=e.call(this,"GUIText",h)||this;return m.addPublic({name:"text",value:r,default:"text"}),m.addPublic({name:"fontSize",value:i,description:"In px",default:12}),m.addPublic({name:"font",value:s,default:"Arial"}),m.addPublic({name:"colour",value:u,type:"rgb"}),m.addPublic({name:"alignment",value:f,description:"Center, left or right. Default center",type:"string",default:"center"}),m.addPublic({name:"fill",value:d,description:"Should the text be filled or hollow",type:"boolean",default:!0}),m}return Un(n,e),n.prototype.draw=function(e,t){vn(e,this.text,this.fontSize*t.scale.x,this.font,this.colour.rgba,t.position.v2)},n.prototype.touchingPoint=function(e,n,r){n.font="".concat(this.fontSize,"px ").concat(this.font);var o=n.measureText(this.text);return e.isInRect(r.position.v2,new t(o.width,this.fontSize*r.scale.x))},n}(Cn),zn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Fn=function(e){function t(t){var n=t.zLayer,r=void 0===n?1:n,o=t.initialText,i=void 0===o?"text":o,a=t.fontSize,s=void 0===a?12:a,c=t.font,u=void 0===c?"Arial":c,l=t.textColour,f=void 0===l?v(0,0,0):l,p=t.textAlignment,d=void 0===p?"center":p,y=t.fillText,h=void 0===y||y,m=t.limiter,b=void 0===m?function(e){return e}:m,g=t.maxLength,w=void 0===g?100:g,x=e.call(this,"GUITextBox",r)||this;return x.text=new Gn({text:i,fontSize:s,colour:f,font:u,alignment:d,fill:h}),x.selected=!1,x.limiter=b,x.addPublic({name:"maxLength",value:w,default:100}),x}return zn(t,e),t.prototype.draw=function(e,t){this.text.draw(e,t)},t.prototype.touchingPoint=function(e,t,n){return this.text.touchingPoint(e,t,n)},t.prototype.limit=function(){this.text.text=this.limiter(this.text.text)},t.prototype.keyPress=function(e){var t=this.text.text;13!==e.keyCode?t.length>=this.maxLength||(this.text.text="".concat(t).concat(String.fromCharCode(e.keyCode)),this.limit()):this.selected=!1},t.prototype.backspace=function(){this.text.text=this.text.text.slice(0,-1),this.limit()},Object.defineProperty(t.prototype,"innerText",{get:function(){return this.text.text},set:function(e){this.text.text=e},enumerable:!1,configurable:!0}),t}(Cn),Wn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Vn=function(e){function t(t){var n=t.zoom,r=void 0===n?1:n,o=t.far,i=void 0===o?1e3:o,a=t.near,s=void 0===a?.1:a,c=t.fov,u=void 0===c?90:c,l=e.call(this,"Camera")||this;return l.addPublic({name:"zoom",value:r,description:"2D only camera zoom - does not affect 3D rendering"}),l.addPublic({name:"far",value:i,description:"The far clipping plane. Does not affect 2D rendering."}),l.addPublic({name:"near",value:s,description:"The near clipping plane. Does not affect 2D rendering."}),l.addPublic({name:"fov",value:u,description:"Field of view - like zoom for 3D"}),l}return Wn(t,e),t.prototype.json=function(){return un(this,"Camera")},t.prototype.screenSpaceToWorldSpace=function(e,t,n){e=e.clone;var r=on(t).scale(.5);return e.set(an(e,1/this.zoom,r)),e.add(n.v2),e.sub(r),e},t.prototype.worldSpaceToScreenSpace=function(e,t,n){var r=on(t).clone.scale(.5);return n=n.clone.sub(r.v3),an(e.clone.sub(n.v2),this.zoom,r)},t}(O),qn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},Hn=function(){return{license:"0000",version:"0.0.0",gameName:"Entropy Engine Game",canvasID:"myCanvas",maxFrameRate:60,timeScale:1,backgroundTint:v.parse("white"),globalGravity:new r(0,0,0),collisionIterations:5,globalVolume:1}},Yn=function(){function e(t,n){if(this.id=e.scenes.length,this.name=t,this.settings=n,!n.ctx){var r=sn(n.canvasID).ctx;n.ctx=r}}return e.prototype.json=function(){var e;return{name:this.name,settings:{license:this.settings.license,version:this.settings.version,gameName:this.settings.gameName,canvasID:this.settings.canvasID,maxFrameRate:this.settings.maxFrameRate,timeScale:this.settings.timeScale,backgroundTint:(null===(e=this.settings.backgroundTint)||void 0===e?void 0:e.json)||v.parse("white").json,backgroundImage:this.settings.backgroundImage,globalGravity:this.settings.globalGravity.array,collisionIterations:this.settings.collisionIterations,globalVolume:this.settings.globalVolume}}},Object.defineProperty(e.prototype,"entities",{get:function(){var e,t,n,r,o=[],i=[];try{for(var a=qn(ur.entities),s=a.next();!s.done;s=a.next()){var c=s.value;c.transform.isChild()||c.transform.parent===this.id&&o.push(c)}}catch(t){e={error:t}}finally{try{s&&!s.done&&(t=a.return)&&t.call(a)}finally{if(e)throw e.error}}for(;o.length>0;){try{for(var u=(n=void 0,qn(o[0].transform.children)),l=u.next();!l.done;l=u.next()){var f=l.value;o.push(f)}}catch(e){n={error:e}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}i.push(o.shift())}return i},enumerable:!1,configurable:!0}),e.prototype.findMainCamera=function(){var t,n;try{for(var r=qn(this.entities),o=r.next();!o.done;o=r.next()){var i=o.value;if(i.hasComponent("Camera"))return void(Vn.main=i)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}console.error("\n            No sprites with component of type 'camera' can be found.\n            Make sure that there is at least one sprite in the scene '".concat(e.activeScene.name,"' with a 'Camera' component attached\n        "))},e.prototype.loopThroughScripts=function(e){var t,n,r,o;try{for(var i=qn(this.entities),a=i.next();!a.done;a=i.next()){var s=a.value;try{for(var c=(r=void 0,qn(s.getComponents("Script"))),u=c.next();!u.done;u=c.next())e(u.value,s)}catch(e){r={error:e}}finally{try{u&&!u.done&&(o=c.return)&&o.call(c)}finally{if(r)throw r.error}}}}catch(e){t={error:e}}finally{try{a&&!a.done&&(n=i.return)&&n.call(i)}finally{if(t)throw t.error}}},e.prototype.broadcast=function(e,t){this.loopThroughScripts((function(n,r){n.runMethod(e,r,t)}))},e.loopThroughAllScripts=function(e){ur.loop((function(t){var n,r;try{for(var o=qn(t.getComponents("Script")),i=o.next();!i.done;i=o.next()){var a=i.value;e(a,t)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}))},Object.defineProperty(e,"active",{get:function(){return e.active_},set:function(t){e.active_=t instanceof e?t.id:t},enumerable:!1,configurable:!0}),Object.defineProperty(e,"activeScene",{get:function(){if(this.scenes.length<1)throw new Error("No scenes found");return e.sceneByID(e.active)},set:function(t){e.active=t.id},enumerable:!1,configurable:!0}),e.sceneByName=function(t){var n=e.scenes.filter((function(e){return e.name===t}));if(!(void 0!==n&&n[0]&&n[0]instanceof e))throw console.error("Cannot find scene name: ".concat(t)),Error();return n[0]},e.sceneExistsWithID=function(t){return void 0!==e.scenes.filter((function(e){return e.id===t}))[0]},e.sceneByID=function(t){var n=e.scenes.filter((function(e){return e.id===t}))[0];if(void 0===n){console.error("Cannot find scene ID: ".concat(t," of type ").concat(typeof t,". Creating empty scene to compensate. Scenes: ").concat(e.scenes));var r=new e("Example Scene",Hn());return e.scenes.push(r),r}return n},e.create=function(t){var n=new e(t.name||"Scene",t.settings||Hn());if(e.scenes.push(n),e.scenes.length>0&&!t.settings){var o=e.scenes[e.scenes.length-1].json().settings;o.backgroundTint=new h(255,255,255),o.globalGravity=r.fromArray(o.globalGravity),n.settings=o}return n},e.next=function(t){var n,r;e.active++,e.active>e.scenes.length-1&&(e.active=0);try{for(var o=qn(t),i=o.next();!i.done;i=o.next()){var a=i.value;"number"==typeof a.transform.parent&&(a.transform.parent=e.active)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}e.activeScene.findMainCamera()},e.previous=function(t){var n,r;e.active--,e.active<0&&(e.active=e.scenes.length-1);try{for(var o=qn(t),i=o.next();!i.done;i=o.next()){var a=i.value;"number"==typeof a.transform.parent&&(a.transform.parent=e.active)}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}e.activeScene.findMainCamera()},Object.defineProperty(e,"sceneCount",{get:function(){return e.scenes.length},enumerable:!1,configurable:!0}),e.scenes=[],e.active_=0,e}(),Qn=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}}(),Kn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},$n=function(e){function n(t){var n=t.position,o=void 0===n?r.zero:n,i=t.scale,a=void 0===i?new r(1,1,1):i,s=t.rotation,c=void 0===s?r.zero:s,u=t.parent,l=void 0===u?Yn.active:u,f=e.call(this,"Transform")||this;return f.addPublic({name:"position",value:o,type:"v3",overrideGet:function(){return"number"==typeof f.parent?f.getPublic("position"):f.getPublic("position").clone.add(f.parent.position)},overrideSet:function(e){var t,n,o=e||r.zero;null!==(t=o.x)&&void 0!==t||(o.x=0),null!==(n=o.y)&&void 0!==n||(o.y=0),f.setPublic("position",o)}}),f.addPublic({name:"rotation",value:c,type:"v3",overrideGet:function(){return"number"==typeof f.parent?f.getPublic("rotation"):f.getPublic("rotation").clone.add(f.parent.rotation)},overrideSet:function(e){var t,n,o=e||r.zero;null!==(t=o.x)&&void 0!==t||(o.x=0),null!==(n=o.y)&&void 0!==n||(o.y=0),f.setPublic("rotation",o)}}),f.addPublic({name:"scale",value:a,type:"v3",overrideGet:function(){return"number"==typeof f.parent?f.getPublic("scale"):f.getPublic("scale").clone.mul(f.parent.scale)},overrideSet:function(e){var t,n,o=e||r.zero;null!==(t=o.x)&&void 0!==t||(o.x=0),null!==(n=o.y)&&void 0!==n||(o.y=0),f.setPublic("scale",o)}}),f.addPublic({name:"parent",value:l,type:"Transform"}),f}return Qn(n,e),n.prototype.setParentDirty=function(e){var t,r;if(e instanceof n||"number"==typeof e)if("number"!=typeof e){if(this.recursiveChildren.includes(e.sprite))try{for(var o=Kn(this.children),i=o.next();!i.done;i=o.next())i.value.transform.parent=this.parent}catch(e){t={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(t)throw t.error}}this.parent=e}else this.parent=e;else this.parent=Yn.active},n.prototype.json=function(){var e={type:"",name:""};return this.parent instanceof n?(e.type="Transform",e.name=this.parent.sprite.name):(e.type="Scene",e.name=this.parent.toString()),{type:"Transform",position:this.position.array,scale:this.scale.array,rotation:this.rotation.array,parent:e}},n.prototype.Update=function(){},Object.defineProperty(n.prototype,"localRotation",{get:function(){return this.getPublic("rotation")},set:function(e){this.setPublic("rotation",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localPosition",{get:function(){return this.getPublic("position")},set:function(e){this.setPublic("position",e)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"localScale",{get:function(){return this.getPublic("scale")},set:function(e){this.setPublic("position",e)},enumerable:!1,configurable:!0}),n.prototype.detachFromParent=function(){this.parent=Yn.active},Object.defineProperty(n.prototype,"children",{get:function(){var e,t,n=[];try{for(var r=Kn(ur.entities),o=r.next();!o.done;o=r.next()){var i=o.value;Object.is(i.transform.parent,this)&&n.push(i)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"recursiveChildren",{get:function(){for(var e,t,n=this.children,r=[];n.length>0;){try{for(var o=(e=void 0,Kn(n[0].transform.children)),i=o.next();!i.done;i=o.next()){var a=i.value;n.push(a)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=o.return)&&t.call(o)}finally{if(e)throw e.error}}r.push(n.shift())}return r},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"childCount",{get:function(){var e,t,n=0;try{for(var r=Kn(ur.entities),o=r.next();!o.done;o=r.next()){var i=o.value;Object.is(i.transform.parent,this)&&n++}}catch(t){e={error:t}}finally{try{o&&!o.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return n},enumerable:!1,configurable:!0}),n.prototype.makeChildOf=function(e){this.parent=e},n.prototype.makeParentOf=function(e){var t,n;try{for(var r=Kn(e),o=r.next();!o.done;o=r.next())o.value.parent=this}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},n.prototype.isRoot=function(){return"number"==typeof this.parent},n.prototype.isChild=function(){return this.parent instanceof n},Object.defineProperty(n.prototype,"sprite",{get:function(){var e=this;return ur.entities.find((function(t){return Object.is(t.transform,e)}))},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"root",{get:function(){return function e(t){return"number"==typeof t.parent?t:e(t.parent)}(this)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"scene",{get:function(){return Yn.sceneByID(this.root.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"forwards",{get:function(){return this.rotation},enumerable:!1,configurable:!0}),Object.defineProperty(n.prototype,"right",{get:function(){var e=this.forwards;return new t(e.y,-e.x)},enumerable:!1,configurable:!0}),n.prototype.getChild=function(e){return this.children.find((function(t){return t.name===e}))},n}(O),Xn=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Jn=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},Zn=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},er={CircleCollider:tn,RectCollider:nn,Body:fn,CircleRenderer:_n,RectRenderer:Sn,ImageRenderer2D:On,MeshRenderer:kn,GUIBox:An,GUIText:Gn,GUITextBox:Fn,GUIRect:Ln,GUICircle:jn,GUIPolygon:Nn,GUIImage:Bn,Camera:Vn},tr=Math.floor(200001*Math.random());function nr(e,n,o){if("type"!==e&&"subType"!==e)if((a=n[e])&&"number"==typeof a.r&&"number"==typeof a.g&&"number"==typeof a.b){var i=n[e];o[e]=b(i.r,i.g,i.b,i.a)}else{var a;Array.isArray(n[e])?function(e){return!!e&&!!Array.isArray(e)&&2===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]}(n[e])?o[e]=t.fromArray(n[e]):function(e){return!!e&&!!Array.isArray(e)&&3===e.length&&"number"==typeof e[0]&&"number"==typeof e[1]&&"number"==typeof e[2]}(n[e])?o[e]=r.fromArray(n[e]):o[e]=n[e]:o[e]=n[e]}}function rr(e){return Xn(this,void 0,void 0,(function(){var n,o,i,a,s,c,u,l,f,p,d,y,h,v;return Jn(this,(function(m){switch(m.label){case 0:return n=e.path,i=n.split("/").pop(),[4,fetch("".concat(n,"?").concat(tr))];case 1:return[4,m.sent().text()];case 2:if(a=m.sent(),(s=new Ze).parent=x,s.path=n,c=new Yt(new ve(i),{}),u=Ke(a,{env:s,measurePerformance:!1,fileName:i,currentDir:n}),c.__value__=s.getSymbolTableAsDict(),u.error)return console.log(u.error.str),[2];o=c;try{if(l=new Xt({script:o,path:n}),Array.isArray(e.public))try{for(f=Zn(e.public),p=f.next();!p.done;p=f.next())d=p.value,l.hasPublic(d.name)&&(y=d.value,"v2"===d.type?y=t.fromArray(d.value):"v3"===d.type&&(y=r.fromArray(d.value)),l.setPublic(d.name,y))}catch(e){h={error:e}}finally{try{p&&!p.done&&(v=f.return)&&v.call(f)}finally{if(h)throw h.error}}return[2,l]}catch(e){throw"Error initialising script '".concat(i,"': ").concat(e)}return[2]}}))}))}function or(e){return Xn(this,void 0,void 0,(function(){var t,n,r;return Jn(this,(function(o){if("Script"===e.type)return[2,rr(e)];if(!(n=er[e.type]))throw"No component of type '".concat(e.type,"' found");for(r in t=new n({}),e)e.hasOwnProperty(r)&&nr(r,e,t);return[2,t]}))}))}function ir(e){var t,n,o,i;return Xn(this,void 0,void 0,(function(){var a,s,c,u,l,f,p,d,y,h,v,m,b,g,w;return Jn(this,(function(x){switch(x.label){case 0:a=null!==(t=e.name)&&void 0!==t?t:"entity ".concat(ur.entities.length),s=null!==(n=e.tag)&&void 0!==n?n:"entity",c=null!==(o=e.Static)&&void 0!==o&&o,u=null!==(i=e.components)&&void 0!==i?i:[],l=[],f=e.transform,p=function(e){var t=e.parent,n=new $n({});return e.position&&(n.position=r.fromArray(e.position)),e.scale&&(n.scale=r.fromArray(e.scale)),e.rotation&&(n.rotation=r.fromArray(e.rotation)),{parentInfo:t,transform:n}}(f||{}),d=p.parentInfo,y=p.transform,x.label=1;case 1:x.trys.push([1,6,7,8]),h=Zn(u),v=h.next(),x.label=2;case 2:return v.done?[3,5]:[4,or(v.value)];case 3:(m=x.sent())&&l.push(m),x.label=4;case 4:return v=h.next(),[3,2];case 5:return[3,8];case 6:return b=x.sent(),g={error:b},[3,8];case 7:try{v&&!v.done&&(w=h.return)&&w.call(h)}finally{if(g)throw g.error}return[7];case 8:return[2,{entity:new ur({name:a,components:l,transform:y,tag:s,Static:c}),parentInfo:d}]}}))}))}function ar(e,t){var n,r;"Transform"===e.type?r=null===(n=ur.find(e.name))||void 0===n?void 0:n.transform:"Scene"===e.type&&(r=Yn.sceneByID(parseInt(e.name)).id),null==r&&(r=Yn.active),null==t||t.makeChildOf(r)}function sr(e){var t;return Xn(this,void 0,void 0,(function(){var n,r,o,i,a,s,c,u;return Jn(this,(function(l){switch(l.label){case 0:if(n={},!Array.isArray(e))return console.error("Cannot initialise entities from JSON ",e),[2];l.label=1;case 1:l.trys.push([1,6,7,8]),r=Zn(e),o=r.next(),l.label=2;case 2:return o.done?[3,5]:[4,ir(o.value)];case 3:i=l.sent(),n[i.entity.name]=i.parentInfo,ur.entities.push(i.entity),l.label=4;case 4:return o=r.next(),[3,2];case 5:return[3,8];case 6:return a=l.sent(),c={error:a},[3,8];case 7:try{o&&!o.done&&(u=r.return)&&u.call(r)}finally{if(c)throw c.error}return[7];case 8:for(s in n)n[s]&&ar(n[s],null===(t=ur.find(s))||void 0===t?void 0:t.transform);return[2]}}))}))}var cr=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},ur=function(){function e(t){var n,r,o,i,a,s=this;this.getComponent=function(t,n){if(void 0===n&&(n=""),!(s instanceof e))throw new Error("Running getComponent method in invalid context. this: ".concat(s));if("transform"===t.toLowerCase())return s.transform;var r=s.components.find((function(e){return e.type===t&&(e.subtype===n||""===n)||e.subtype===t}));if(void 0===r&&(r=s.getComponents("Script").find((function(e){return e.subtype===n||e.subtype===t}))),void 0===r)throw new Error("Cannot find component of type ".concat(t," on entity ").concat(s.name));return r},this.getSceneID=function(){return s.sceneID},this.getClone=function(){return e=s,t=void 0,r=function(){var e,t;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(n){switch(n.label){case 0:return[4,ir(this.json())];case 1:return e=n.sent(),t=e.entity,ar(e.parentInfo,t.transform),[2,t]}}))},new((n=void 0)||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}));var e,t,n,r},this.addComponent=function(e){var t,n;if("transform"===e.type)return!1;try{for(var r=cr(s.components),o=r.next();!o.done;o=r.next()){var i=o.value;if("GUIElement"===i.type){if("Renderer"!==e.type)continue;if(!["Renderer","Body","Camera"].includes(e.type))continue}if("GUIElement"===e.type&&["Renderer","Body","Camera","Collider"].includes(i.type))return!1;i.type===e.type&&i.subtype===e.subtype&&s.components.splice(s.components.indexOf(i),1)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}return s.components.push(e),!0},this.add=this.addComponent,this.hasComponent=function(e,t){var n,r;if(void 0===t&&(t=""),"transform"===e.toLowerCase())return!0;try{for(var o=cr(s.components),i=o.next();!i.done;i=o.next()){var a=i.value;if(a.type===e&&(a.subtype===t||""===t))return!0;if(a.subtype===e)return!0}}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}return!1},this.getComponents=function(e,t){var n,r;void 0===t&&(t="");var o=[];try{for(var i=cr(s.components),a=i.next();!a.done;a=i.next()){var c=a.value;c.type!==e||c.subtype!==t&&""!==t||o.push(c)}}catch(e){n={error:e}}finally{try{a&&!a.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}return o},this.generateID=function(){for(var t=0,n=e.entities.map((function(e){return e.id}));n.indexOf(t)>-1;)t=Math.floor(Math.random()*Math.pow(10,5));return t},this.delete=function(){for(var t=0;t<e.entities.length;t++){var n=e.entities[t];Object.is(n,s)&&delete e.entities.splice(t,1)[0]}},this.json=function(){return{name:s.name,tag:s.tag,Static:s.Static,transform:s.transform.json(),components:s.components.map((function(e){return e.json()}))}},this.tag=null!==(n=t.tag)&&void 0!==n?n:"entity",this.name=null!==(r=t.name)&&void 0!==r?r:"new entity",this.components=null!==(o=t.components)&&void 0!==o?o:[],this.transform=null!==(i=t.transform)&&void 0!==i?i:new $n({}),this.Static=null!==(a=t.Static)&&void 0!==a&&a,this.id=this.generateID()}return Object.defineProperty(e.prototype,"sceneID",{get:function(){for(var e=this.transform;"number"!=typeof e;)e=e.parent;return e},enumerable:!1,configurable:!0}),e.newEntity=function(t){var n=new e(t);return e.entities.push(n),n},e.add=function(t){e.entities.push(t)},e.find=function(t){void 0===t&&(t="");var n=e.entities.find((function(e){return e.name===t}));if(n)return n},e.findWithTag=function(t){var n=[];return e.loop((function(e){e.tag===t&&n.push(e)})),n},e.loop=function(t){var n,r;try{for(var o=cr(e.entities),i=o.next();!i.done;i=o.next())t(i.value)}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},e.entities=[],e.new=e.newEntity,e}();function lr(e){return n=this,r=void 0,i=function(){function n(){hn(i,t.zero,s.x,s.y,"#EEEEEE",0),vn(i,"made with",a/2.5,"Nunito","rgb(60, 60, 60)",new t(o.width/2-a/1.6,o.height/2+a/1.5)),vn(i,"Entropy Engine",a,"Nunito","rgb(0, 0, 0)",new t(o.width/2,o.height/2-a/2.5))}var r,o,i,a,s,c;return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(u){switch(u.label){case 0:return r=sn(e),o=r.canvas,i=r.ctx,a=.1*o.width,s=on(o),hn(i,t.zero,s.x,s.y,"#EEEEEE",0),n(),[4,rn(500)];case 1:u.sent(),c=performance.now(),u.label=2;case 2:return performance.now()-c<1e3&&i.globalAlpha>0?(i.globalAlpha-=.005,n(),[4,rn(1)]):[3,4];case 3:return u.sent(),[3,2];case 4:return i.globalAlpha=1,[2]}}))},new((o=void 0)||(o=Promise))((function(e,t){function a(e){try{c(i.next(e))}catch(e){t(e)}}function s(e){try{c(i.throw(e))}catch(e){t(e)}}function c(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(a,s)}c((i=i.apply(n,r||[])).next())}));var n,r,o,i}function fr(e,n){var r=e.getBoundingClientRect(),o=new t(n.pageX-r.left-scrollX,r.height-(n.pageY-r.top-scrollY)),i=new t(e.width/r.width,e.height/r.height);return o.mul(i),o}for(var pr={listen:function(e,t){document.addEventListener(e,t)},mouseDown:!1,cursorPosition:t.zero,cursorPosWorldSpace:t.zero},dr=8;dr<123;dr++)pr[dr]=!1,pr[String.fromCharCode(dr)]=dr;function yr(e,t){pr.cursorPosition=fr(t,e),pr.cursorPosWorldSpace=function(e,t){var n=fr(e,t);return Vn.main.getComponent("Camera").screenSpaceToWorldSpace(n,e,Vn.main.transform.position)}(t,e)}pr.Space=32,pr.Enter=13,pr.Shift=16,pr.Backspace=8,pr.Ctrl=17,pr.Alt=18,pr.CmdR=93,pr.CmdL=91,pr.WindowsKey=91,pr.Left=37,pr.Right=39,pr.Up=38,pr.Down=40,document.addEventListener("keydown",(function(e){pr[e.keyCode]=!0})),document.addEventListener("keyup",(function(e){pr[e.keyCode]=!1})),document.addEventListener("keypress",(function(e){ur.loop((function(t){if(t.hasComponent("GUIElement","GUITextBox")){var n=t.getComponent("GUIElement","GUITextBox");n.selected&&n.keyPress(e)}}))})),document.addEventListener("keydown",(function(e){8===e.keyCode&&ur.loop((function(e){if(e.hasComponent("GUIElement","GUITextBox")){var t=e.getComponent("GUIElement","GUITextBox");t.selected&&t.backspace()}}))}));var hr=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},vr=new(function(){function e(){this.systems=[]}return e.prototype.sortByOrder=function(){vr.systems=vr.systems.sort((function(e,t){return e.order-t.order}))},e.prototype.getByName=function(e){var t,n;try{for(var r=hr(vr.systems),o=r.next();!o.done;o=r.next()){var i=o.value;if(i.name===e)return i}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.Start=function(e){var t,n;vr.sortByOrder();try{for(var r=hr(vr.systems),o=r.next();!o.done;o=r.next())o.value.Start(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e.prototype.Update=function(e){var t,n;try{for(var r=hr(vr.systems),o=r.next();!o.done;o=r.next())o.value.Update(e)}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},e}());function mr(){return e=this,t=void 0,r=function(){return function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}}(this,(function(e){switch(e.label){case 0:return[4,Qe(console.log,(function(){}),!1,{print:console.log,ee:{CircleCollider:tn,RectCollider:nn,Script:Xt,TriangleV2:c,TriangleV3:l,MeshV2:s,MeshV3:y,Body:fn,CircleRenderer:_n,ImageRenderer2D:On,RectRenderer:Sn,MeshRenderer:kn,GUIBox:An,GUIText:Gn,GUITextBox:Fn,GUIRect:Ln,GUICircle:jn,GUIPolygon:Nn,GUIImage:Bn,Camera:Vn,Transform:$n}})];case 1:return e.sent(),[2]}}))},new((n=void 0)||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}));var e,t,n,r}var br=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},gr=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},wr=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};vr.systems.push({name:"Physics",order:0,engine:Jt.Engine.create(),runner:Jt.Runner.create(),Start:function(e){var t,n;try{for(var r=br(e.entities),o=r.next();!o.done;o=r.next()){var i=o.value;if(i.hasComponent("Body")&&i.hasComponent("Collider")){var a=i.getComponent("Collider"),s=i.getComponent("Body");this.updateMBodyOptions(a,i,s,!0),Jt.World.addBody(this.engine.world,a.MatterBody)}}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}},updateMBodyOptions:function(e,t,n,r){var o,i;void 0===r&&(r=!1);var a=e.MatterBody,s=t.transform;a.position=Jt.Vector.create(s.position.x,s.position.y),a.angle=s.rotation.z,a.isStatic=t.Static,a.isSensor=!e.solid,a.friction=n.friction,a.velocity=Jt.Vector.create(n.velocity.x,n.velocity.y),a.frictionAir=n.airResistance,a.mass=n.mass,a.restitution=Math.max(Math.min(n.bounciness,1),0);var c=[];if(e instanceof nn){var u=e.width*s.scale.x,l=e.height*s.scale.y;c=Jt.Bodies.rectangle(s.position.x,s.position.y,u,l).vertices}else{if(!(e instanceof tn))throw Error("Unkown Collider type");var f=e.radius*s.scale.x;c=Jt.Bodies.circle(s.position.x,s.position.y,f).vertices}try{for(var p=br(c),d=p.next();!d.done;d=p.next())d.value}catch(e){o={error:e}}finally{try{d&&!d.done&&(i=p.return)&&i.call(p)}finally{if(o)throw o.error}}a.vertices=c,a.bounds=Jt.Bounds.create(a.vertices),t.Static&&(a.velocity=Jt.Vector.create(0,0),a.force=Jt.Vector.create(0,0))},callCollides:function(e,t){var n,r;try{for(var o=br(e.components),i=o.next();!i.done;i=o.next())i.value.type}catch(e){n={error:e}}finally{try{i&&!i.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}},updateScripts:function(e){var t,n,r,o,i,a,s=[];try{for(var c=br(e),u=c.next();!u.done;u=c.next()){var l=gr(u.value,1)[0];s.push(l)}}catch(e){t={error:e}}finally{try{u&&!u.done&&(n=c.return)&&n.call(c)}finally{if(t)throw t.error}}try{for(var f=br(e),p=f.next();!p.done;p=f.next()){var d=gr(p.value,2),y=(l=d[0],d[1]),h=wr([],gr(s),!1),v=h.indexOf(l);if(-1===v)throw Error();h.splice(v,1);var m=Jt.Query.collides(l,h);if(m.length>0){var b=function(t){var n=t.bodyB;Object.is(n,l)&&(n=t.bodyA);var r=e.find((function(e){var t=gr(e,1)[0];return Object.is(t,n)}));if(void 0===r)throw Error();g.callCollides(y,r[1])},g=this;try{for(var w=(i=void 0,br(m)),x=w.next();!x.done;x=w.next())b(x.value)}catch(e){i={error:e}}finally{try{x&&!x.done&&(a=w.return)&&a.call(w)}finally{if(i)throw i.error}}}}}catch(e){r={error:e}}finally{try{p&&!p.done&&(o=f.return)&&o.call(f)}finally{if(r)throw r.error}}},Update:function(e){var t,n,o,i,a=[];this.time||(this.time=performance.now());try{for(var s=br(e.entities),c=s.next();!c.done;c=s.next())if((d=c.value).hasComponent("Collider")){var u=d.getComponent("Collider");if(d.hasComponent("Body")){var l=d.getComponent("Body");this.updateMBodyOptions(u,d,l)}a.push([u.MatterBody,d])}}catch(e){t={error:e}}finally{try{c&&!c.done&&(n=s.return)&&n.call(s)}finally{if(t)throw t.error}}this.engine.gravity.x=e.settings.globalGravity.x,this.engine.gravity.y=e.settings.globalGravity.y,Jt.Runner.tick(this.runner,this.engine,performance.now());try{for(var f=br(e.entities),p=f.next();!p.done;p=f.next()){var d;if((d=p.value).hasComponent("Body")&&d.hasComponent("Collider")){var y=(u=d.getComponent("Collider")).MatterBody;l=d.getComponent("Body"),d?(d.transform.rotation.z=y.angle,d.transform.position.set(new r(y.position.x,y.position.y,0)),l.velocity.set(new r(y.velocity.x,y.velocity.y,0))):console.error("EEInstance not attached to Matter.Body instance")}}}catch(e){o={error:e}}finally{try{p&&!p.done&&(i=f.return)&&i.call(f)}finally{if(o)throw o.error}}this.updateScripts(a)}});var xr=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},_r=function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var r,o,i=n.call(e),a=[];try{for(;(void 0===t||t-- >0)&&!(r=i.next()).done;)a.push(r.value)}catch(e){o={error:e}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(o)throw o.error}}return a},Sr=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,i=t.length;o<i;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))};vr.systems.push({name:"Renderer",Start:function(){},Update:function(e){var n=e.settings.ctx;n&&function(e,n,r,o,i,a){var s,c;void 0===a&&(a=Vn.main);var u=on(n),l=u.clone.scale(.5);if(function(e,n,r,o){function i(t){var o=r||v.parse("white");(o=o.clone).alpha=t,e.beginPath(),e.rect(0,0,n.x,n.y),e.fillStyle=o.rgba,e.fill(),e.closePath()}if(o)try{mn(e,t.zero,n,o,0)}catch(e){i(.1)}else i(1)}(r,u,o,i),e)if(a){var f=a.getComponent("Camera");if(f){var p=a.transform.position.clone.sub(u.clone.scale(.5).v3);if(p){e=e.filter((function(e){return e.hasComponent("Renderer")||e.hasComponent("GUIElement")}));try{for(var d=xr(function(e){var t,n,r=e.sort((function(e,t){return e.transform.position.z-t.transform.position.z})),o=[],i=[];try{for(var a=xr(r),s=a.next();!s.done;s=a.next()){var c=s.value;c.hasComponent("GUIElement")?i.push(c):o.push(c)}}catch(e){t={error:e}}finally{try{s&&!s.done&&(n=a.return)&&n.call(a)}finally{if(t)throw t.error}}return Sr(Sr([],_r(o),!1),_r(i),!1)}(e)),y=d.next();!y.done;y=d.next()){var h=y.value;if(h.hasComponent("GUIElement"))h.getComponent("GUIElement").draw(r,h.transform);else{var m=h.transform.position.clone.sub(p);h.getComponent("Renderer").draw({position:m,transform:h.transform,ctx:r,zoom:f.zoom,center:l,camera:f,cameraSprite:a})}}}catch(e){s={error:e}}finally{try{y&&!y.done&&(c=d.return)&&c.call(d)}finally{if(s)throw s.error}}}}}else console.error("Camera was not passed to renderAll function! Main camera: "+Vn.main.name)}(e.entities,n.canvas,n,e.settings.backgroundTint,e.settings.backgroundImage)},order:10}),vr.systems.push({name:"Scripts",Start:function(e){Xt.runStartMethodOnInit=!0,Yn.loopThroughAllScripts((function(e,t){if(void 0!==e.script){var n=null;if(Yn.loopThroughAllScripts((function(t){Object.is(e.script,t.script)&&(n=t)})),!(n instanceof Xt))throw new Error("Cannot find self on script with name ".concat(e.name,"!"));e.runMethod("Start",t,[])}}))},Update:function(e){e.broadcast("Update",[])},order:0});var Or=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Tr=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}},kr=new Headers;kr.append("pragma","no-cache"),kr.append("cache-control","no-cache");var Pr={method:"GET",headers:kr};function Cr(e,t){return void 0===t&&(t={}),Or(this,void 0,void 0,(function(){var n,r,o;return Tr(this,(function(i){switch(i.label){case 0:return[4,mr()];case 1:return i.sent(),[4,fetch(e,Pr)];case 2:return[4,i.sent().json()];case 3:for(r in n=i.sent())["entities","scenes"].includes(r)||(t[r]=n[r]);return t.shouldInitEES=!1,function(e){var t,n,r;try{for(var o=Zn(e),i=o.next();!i.done;i=o.next()){var a=i.value,s=Hn(),c=null!==(r=a.settings)&&void 0!==r?r:{};for(var u in c)nr(u,a.settings||{},s);Yn.create({name:a.name,settings:s})}}catch(e){t={error:e}}finally{try{i&&!i.done&&(n=o.return)&&n.call(o)}finally{if(t)throw t.error}}}(n.scenes),o=function(e){var t,n,r=e.canvasID,o=void 0===r?"canvas":r,i=(e.performanceDebug,e.shouldInitEES),a=void 0===i||i,s=!1,c="EE-"!==(n="").substr(0,3)||12!==n.length?0:1,u=sn(o),l=u.canvas,f=u.ctx;function p(){return Or(this,void 0,void 0,(function(){return Tr(this,(function(e){switch(e.label){case 0:return c<2?[4,lr(o)]:[3,2];case 1:e.sent(),e.label=2;case 2:return a&&mr(),Yn.activeScene.findMainCamera(),vr.Start(Yn.activeScene),s=!0,[2]}}))}))}function d(){return Or(this,void 0,void 0,(function(){return Tr(this,(function(e){return vr.Update(Yn.activeScene),window.requestAnimationFrame(d),[2]}))}))}return cn(l),null===(t=null==l?void 0:l.parentNode)||void 0===t||t.addEventListener("resize",(function(){cn(l)})),f.transform(1,0,0,-1,0,l.height),f.save(),l.addEventListener("mousemove",(function(e){s&&(yr(e,l),ur.loop((function(e){var t,n;if(e.sceneID===Yn.active)try{for(var r=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(e.components),o=r.next();!o.done;o=r.next()){var i=o.value;if("GUIElement"!==i.type)return;var a=i;a.hovered=a.touchingPoint(pr.cursorPosition,f,e.transform)}}catch(e){t={error:e}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(t)throw t.error}}})))}),!1),l.addEventListener("mousedown",(function(e){s&&(pr.mouseDown=!0,yr(e,l),Yn.activeScene.loopThroughScripts((function(t,n){if(n.sceneID===Yn.active&&n.hasComponent("Collider")){var r=n.getComponent("Collider"),o=fr(l,e);r.overlapsPoint(n.transform,o)}})))}),!1),l.addEventListener("keydown",(function(e){yr(e,l)})),l.addEventListener("keyup",(function(e){yr(e,l)})),l.addEventListener("mouseup",(function(e){s&&(pr.mouseDown=!1,yr(e,l),Yn.activeScene.loopThroughScripts((function(t,n){if(n.sceneID===Yn.active)if(n.hasComponent("Collider")){var r=n.getComponent("Collider"),o=fr(l,e);if(!r.overlapsPoint(n.transform,o))return}else if(n.hasComponent("GUIElement")){var i=n.getComponent("GUIElement");if(i.hovered,"GUITextBox"!==i.subtype)return;var a=i;a.selected=a.hovered}})))}),!1),{run:function(){return Or(this,void 0,void 0,(function(){return Tr(this,(function(e){switch(e.label){case 0:return[4,p()];case 1:return e.sent(),window.requestAnimationFrame(d),[2]}}))}))}}}(t),[4,sr(n.entities)];case 4:return i.sent(),[4,o.run()];case 5:return i.sent(),[2,o]}}))}))}var Er=function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{c(r.next(e))}catch(e){i(e)}}function s(e){try{c(r.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}c((r=r.apply(e,t||[])).next())}))},Ar=function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function s(i){return function(s){return function(i){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(o=2&i[0]?r.return:i[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,i[1])).done)return o;switch(r=0,o&&(i=[2&i[0],o.value]),i[0]){case 0:case 1:o=i;break;case 4:return a.label++,{value:i[1],done:!1};case 5:a.label++,r=i[1],i=[0];continue;case 7:i=a.ops.pop(),a.trys.pop();continue;default:if(!((o=(o=a.trys).length>0&&o[o.length-1])||6!==i[0]&&2!==i[0])){a=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){a.label=i[1];break}if(6===i[0]&&a.label<o[1]){a.label=o[1],o=i;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(i);break}o[2]&&a.ops.pop(),a.trys.pop();continue}i=t.call(e,a)}catch(e){i=[6,e],r=0}finally{n=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,s])}}};apiToken.project=parseInt(urlParam("p")||"0");var Ir=Math.floor(Math.random()*Math.pow(10,5));function jr(e){window.location.href="https://entropyengine.dev/accounts/error?type=buildPlayFail&extra=".concat(JSON.stringify(e))}document.addEventListener("keypress",(function(e){return e.preventDefault()})),document.addEventListener("keydown",(function(e){return e.preventDefault()})),document.addEventListener("keyup",(function(e){return e.preventDefault()})),request("has-build",apiToken).then((function(e){return Er(void 0,void 0,void 0,(function(){function t(e){return Er(this,void 0,void 0,(function(){var n,r,o,i,a,s,c,u,l=this;return Ar(this,(function(f){switch(f.label){case 0:return[4,request("get-comments",apiToken,{public:!0})];case 1:if(n=f.sent(),$("#num-comments").html(n.length),!n)return[2];(r=$("#comments")).html(""),o=function(n){var o,i,a;if(r.append((o=n,void 0===(i=n.username===e)&&(i=!1),void 0===a&&(a=!0),'\n\t\n\t<div id="comment-'.concat(o._id,'-menu" style="\n\t\twidth: 160px;\n\t\tbackground-color: rgba(180, 180, 180, 0.8);\n\t\ttext-align: center;\n\t\tborder-radius: 6px;\n\t\tpadding: 8px 0;\n\t\tposition: absolute;\n\t\tz-index: 1;\n\t\tdisplay: none;\n\t">\n\t\t').concat(i?'\n\t\t<button id="delete-comment-'.concat(o._id,'" style="padding: 0; width: 100%; background-color: transparent">\n\t\t\tDelete ðŸ—‘ï¸\n\t\t</button><br>\n\t\t'):"",'\n\t\t<a href="https://entropyengine.dev/report?type=comment&id=').concat(o._id,'" style="padding: 0; width: 100%; background-color: transparent">\n\t\t\tReport âš ï¸\n\t\t</a>\n\t</div>\n\t\n\t<div id="comment-').concat(o._id,'" style="\n\t\tdisplay: flex;\n\t\tjustify-content: space-between;\n\t\talign-items: center;\n\t\tborder-bottom: 1px solid vaR(--input-bg);\n\t">\n\t\t<p style="margin: 8px">\n\t\t\t').concat(o.content,'\n\t\t</p>\n\t\t<aside style="min-width: 200px; margin-left: 20px">\n\t\t\t<span style="margin-right: 10px">').concat(o.username,"</span>\n\t\t\t<span>\n\t\t\t\t").concat(secondsToReadable(Math.round((new Date).getTime()/1e3)-o.date)," ago\n\t\t\t</span>\n\t\t\t\n\t\t\t").concat(a?'\n\t\t\t<button id="comment-'.concat(o._id,'-menu-toggle" style="\n\t\t\t\tposition: relative;\n\t\t\t\tdisplay: inline-block;\n\t\t\t\tcursor: pointer;\n\t\t\t\tbackground: url(https://entropyengine.dev/svg/menu-dots.svg) no-repeat center center;\n\t\t\t\tbackground-size: contain;\n\t\t\t\twidth: 20px; height: 15px;\n\t\t\t">\n\t\t\t'):"","\n\t\t\t</button>\n\t\t</aside>\n\t</div>\n\n\t").concat(a?"\n\t<script>\n\t(function () {\n\t\tconst menu = $('#comment-".concat(o._id,"-menu');\n\t\tconst menuButton = $('#comment-").concat(o._id,"-menu-toggle');\n\t\tconst both = $('#comment-").concat(o._id,"-menu, #comment-").concat(o._id,"-menu-toggle');\n\t\n\t\t$(document).on('click', clickPosition => {\n\t\t\tif (!both.is(clickPosition.target) && menu.has(clickPosition.target).length === 0){\n\t\t\t\tmenu.hide();\n\t\t\t} else {\n\t\t\t\tif (menuButton.is(clickPosition.target) && menu.css('display') !== 'none') {\n\t\t\t\t\tmenu.hide();\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tif (!menu.is(clickPosition.target)){\n\t\t\t\t\tmenu.css({\n\t\t\t\t\t\t'top': clickPosition.pageY,\n\t\t\t\t\t\t'left': clickPosition.pageX - 150\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\n\t\t\t\tmenu.show();\n\t\t\t}\n\t\t});\n\t\n\t})();\n\t<\/script>\n\t"):"","\n\n"))),n.username!==e)return"continue";$("#delete-comment-".concat(n._id)).click((function(){return Er(l,void 0,void 0,(function(){return Ar(this,(function(r){switch(r.label){case 0:return $("#comment-".concat(n._id,"-menu")).hide(),$("#comment-".concat(n._id)).hide(),[4,request("delete-comment",apiToken,{commentID:n._id})];case 1:return r.sent(),t(e),[2]}}))}))}))};try{for(i=function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}(n),a=i.next();!a.done;a=i.next())s=a.value,o(s)}catch(e){c={error:e}}finally{try{a&&!a.done&&(u=i.return)&&u.call(i)}finally{if(c)throw c.error}}return[2]}}))}))}var n,r,o,i,a;return Ar(this,(function(s){switch(s.label){case 0:return e.built?[4,request("/get-project-access",apiToken)]:(jr(e),[2]);case 1:return(n=s.sent()).accessLevel<1?(jr(n),[2]):($("#contributors-link").attr("href",(function(e,t){return t+apiToken.project})),[4,Cr("../projects/".concat(apiToken.project,"/build/index.json?cache-bust=").concat(Ir))]);case 2:return s.sent(),[4,request("project-owner",apiToken)];case 3:return(r=s.sent()).totalContributors-1<1?$("#project-owner").html(r.owner):$("#project-owner").html("\n                ".concat(r.owner," and ").concat(r.totalContributors-1," others\n            ")),request("viewed-project",apiToken),[4,request("/project-views",apiToken)];case 4:return o=s.sent(),$("#views").html('\n            <span style="margin-right: 10px">\n                '.concat(o.unique," viewers\n            </span>\n\n            <span>\n                ").concat(o.total," views\n            </span>\n        ")),i=$("#add-comment"),[4,request("get-username",apiToken)];case 5:return a=s.sent(),i.keyup((function(e){return Er(void 0,void 0,void 0,(function(){var n;return Ar(this,(function(r){switch(r.label){case 0:return 13!==e.keyCode?[2]:(n=i.val(),i.val(""),[4,request("comment",apiToken,{content:n,public:!0})]);case 1:return r.sent(),t(a.username),[2]}}))}))})),t(a.username),[2]}}))}))}))})()})();</script><footer></footer></body></html>